GHES: Carve out error queueing in a separate function

Make the handler more readable.

No functionality change.

Signed-off-by: Borislav Petkov <bp@suse.de>

