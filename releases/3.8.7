commit 531ec28f9f26f78797124b9efcf2138b89794a1e
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Fri Apr 12 09:52:28 2013 -0700

    Linux 3.8.7

commit 292f82fc424238e32754ca67b2b9f280d53efea0
Author: Sean Young <sean@mess.org>
Date:   Sun Apr 7 20:47:18 2013 +0100

    Revert "tty/8250_pnp: serial port detection regression since v3.7"
    
    commit c12f9ea28e9fbe7b1f4cefc953bee33298370683 upstream.
    
    This reverts commit 77e372a3d82e5e4878ce1962207edd766773cc76.
    
    Checking for disabled resources board breaks detection pnp on another
    board "AMI UEFI implementation (Version: 0406 Release Date: 06/06/2012)".
    I'm working with the reporter of the original bug to write and test
    a better fix.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=928246
    
    Signed-off-by: Sean Young <sean@mess.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 19a993879bb86c801995f55702ab6beaa5485f5e
Author: Tim Gardner <tim.gardner@canonical.com>
Date:   Mon Feb 18 12:56:28 2013 -0700

    rt2x00: rt2x00pci_regbusy_read() - only print register access failure once
    
    commit 83589b30f1e1dc9898986293c9336b8ce1705dec upstream.
    
    BugLink: http://bugs.launchpad.net/bugs/1128840
    
    It appears that when this register read fails it never recovers, so
    I think there is no need to repeat the same error message ad infinitum.
    
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Cc: Ivo van Doorn <IvDoorn@gmail.com>
    Cc: Gertjan van Wingerde <gwingerde@gmail.com>
    Cc: Helmut Schaa <helmut.schaa@googlemail.com>
    Cc: "John W. Linville" <linville@tuxdriver.com>
    Cc: linux-wireless@vger.kernel.org
    Cc: users@rt2x00.serialmonkey.com
    Cc: netdev@vger.kernel.org
    Cc: stable@vger.kernel.org
    Signed-off-by: John W. Linville <linville@tuxdriver.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 303bf43a2390c09ff38f0efc37f5917b928d453e
Author: Bing Zhao <bzhao@marvell.com>
Date:   Mon Apr 1 12:44:45 2013 -0700

    mwifiex: complete last internal scan
    
    commit 21de979ecfc7b7f9442f8aea9a54b3ab670d0151 upstream.
    
    We are waiting on first scan command of internal scan request
    before association, so we should complete on last internal scan
    command response.
    
    Tested-by: Daniel Drake <dsd@laptop.org>
    Tested-by: Marco Cesarano <marco@marvell.com>
    Signed-off-by: Bing Zhao <bzhao@marvell.com>
    Signed-off-by: Amitkumar Karwar <akarwar@marvell.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit afe4e1436f37d43bc90442f6829685e6e8322ca8
Author: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Date:   Tue Apr 9 14:16:04 2013 +0800

    can: gw: use kmem_cache_free() instead of kfree()
    
    commit 3480a2125923e4b7a56d79efc76743089bf273fc upstream.
    
    Memory allocated by kmem_cache_alloc() should be freed using
    kmem_cache_free(), not kfree().
    
    Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
    Acked-by: Oliver Hartkopp <socketcan@hartkopp.net>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2a85fc20da763b9bb3ec2b959a3c282026b9888d
Author: Trond Myklebust <Trond.Myklebust@netapp.com>
Date:   Wed Apr 10 12:44:18 2013 -0400

    NFSv4: Doh! Typo in the fix to nfs41_walk_client_list
    
    commit eb04e0ac198cec3bab407ad220438dfa65c19c67 upstream.
    
    Make sure that we set the status to 0 on success. Missed in testing
    because it never appears when doing multiple mounts to _different_
    servers.
    
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7c852afafa3bf8daeaee5c60399d55c13618ac8a
Author: Alex Williamson <alex.williamson@redhat.com>
Date:   Tue Mar 26 11:33:16 2013 -0600

    vfio-pci: Fix possible integer overflow
    
    commit 904c680c7bf016a8619a045850937427f8d7368c upstream.
    
    The VFIO_DEVICE_SET_IRQS ioctl takes a start and count parameter, both
    of which are unsigned.  We attempt to bounds check these, but fail to
    account for the case where start is a very large number, allowing
    start + count to wrap back into the valid range.  Bounds check both
    start and start + count.
    
    Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 77e2cc382c06a8be48f80e769991e9a4b36a03ce
Author: hayeswang <hayeswang@realtek.com>
Date:   Sun Mar 31 17:02:04 2013 +0000

    r8169: fix auto speed down issue
    
    commit e2409d83434d77874b461b78af6a19cd6e6a1280 upstream.
    
    It would cause no link after suspending or shutdowning when the
    nic changes the speed to 10M and connects to a link partner which
    forces the speed to 100M.
    
    Check the link partner ability to determine which speed to set.
    
    Signed-off-by: Hayes Wang <hayeswang@realtek.com>
    Acked-by: Francois Romieu <romieu@fr.zoreil.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 060c519a9fd1467f6958f98520a9a9aea1aee373
Author: Jani Nikula <jani.nikula@intel.com>
Date:   Tue Jan 22 12:50:36 2013 +0200

    drm/i915: add quirk to invert brightness on Packard Bell NCL20
    
    commit 5559ecadad5a73b27f863e92f4b4f369501dce6f upstream.
    
    Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=44156
    Reported-by: Alan Zimmerman <alan.zimm@gmail.com>
    Signed-off-by: Jani Nikula <jani.nikula@intel.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 979913cd288da7c284f4a3f08e5d7092511788da
Author: Jani Nikula <jani.nikula@intel.com>
Date:   Tue Jan 22 12:50:35 2013 +0200

    drm/i915: add quirk to invert brightness on eMachines e725
    
    commit 01e3a8feb40e54b962a20fa7eb595c5efef5e109 upstream.
    
    Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=31522#c35
    [Note: There are more than one broken setups in the bug. This fixes one.]
    Reported-by: Martins <andrissr@inbox.lv>
    Signed-off-by: Jani Nikula <jani.nikula@intel.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Cc: Josh Boyer <jwboyer@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 52024312c30b6c58be6bb6ea638972fc95b23db4
Author: Jani Nikula <jani.nikula@intel.com>
Date:   Tue Jan 22 12:50:34 2013 +0200

    drm/i915: add quirk to invert brightness on eMachines G725
    
    commit 1ffff60320879830e469e26062c18f75236822ba upstream.
    
    Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=59628
    Reported-by: Roland Gruber <post@rolandgruber.de>
    Signed-off-by: Jani Nikula <jani.nikula@intel.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Cc: Josh Boyer <jwboyer@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3d574eb51f512fd6c7883f6b30677ea405851a5a
Author: Thomas Abraham <thomas.ab@samsung.com>
Date:   Thu Jan 24 10:09:13 2013 -0800

    ARM: EXYNOS: Fix crash on soft reset on EXYNOS5440
    
    commit 60db7e5f9c9a25a7a9b01007e6e3f5a93bc16a3a upstream.
    
    The soft-reset control register is located in the XMU controller space.
    Map this controller space before writing to the soft-reset controller
    register.
    
    Signed-off-by: Thomas Abraham <thomas.ab@samsung.com>
    Signed-off-by: Girish K S <ks.giri@samsung.com>
    Signed-off-by: Kukjin <kgene.kim@samsung.com>
    Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d84536a6ce05becd84241f9fc38245c4008f7297
Author: Jonghwan Choi <jhbird.choi@samsung.com>
Date:   Fri Jan 18 11:09:01 2013 -0800

    cpufreq: exynos: Get booting freq value in exynos_cpufreq_init
    
    commit 6e45eb12fd1c741d556bf264ee98853b5f3104e5 upstream.
    
    Boot_freq is for saving booting freq. But exynos_cpufreq_cpu_init
    is called in hotplug. If boot_freq is existed in exynos_cpufreq_cpu_init,
    boot_freq could be changed.
    
    Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com>
    Signed-off-by: Kukjin Kim <kgene.kim@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 26bc22fb31042b628b5022c264c215d98a2d2da8
Author: Maxim Mikityanskiy <maxtram95@gmail.com>
Date:   Sat Dec 15 19:31:31 2012 +0200

    msi-wmi: Fix memory leak
    
    commit 51c94491c82c3d9029f6e87a1a153db321d88e35 upstream.
    
    Fix memory leak - don't forget to kfree ACPI object when returning from
    msi_wmi_notify() after suppressing key event.
    
    Signed-off-by: Maxim Mikityanskiy <maxtram95@gmail.com>
    Acked-by: Anisse Astier <anisse@astier.eu>
    Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
    Signed-off-by: Matthew Garrett <matthew.garrett@nebula.com>
    Signed-off-by: Jonghwan Choi <jhbird.choi@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c26c600fe6cf7fcdebe56b8efd4ed43c91821701
Author: Richard Guy Briggs <rbriggs@redhat.com>
Date:   Tue Feb 12 19:39:44 2013 +0000

    thermal: return an error on failure to register thermal class
    
    commit da28d966f6aa942ae836d09729f76a1647932309 upstream.
    
    The return code from the registration of the thermal class is used to
    unallocate resources, but this failure isn't passed back to the caller of
    thermal_init.  Return this failure back to the caller.
    
    This bug was introduced in changeset 4cb18728 which overwrote the return code
    when the variable was re-used to catch the return code of the registration of
    the genetlink thermal socket family.
    
    Signed-off-by: Richard Guy Briggs <rbriggs@redhat.com>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>
    Cc: Jonghwan Choi <jhbird.choi@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ea0f6a0bc122fc5478691ddcbe330bacf70acf24
Author: Bjorn Helgaas <bhelgaas@google.com>
Date:   Mon Apr 1 15:47:39 2013 -0600

    Revert "PCI/ACPI: Request _OSC control before scanning PCI root bus"
    
    commit b8178f130e25c1bdac1c33e0996f1ff6e20ec08e upstream.
    
    This reverts commit 8c33f51df406e1a1f7fa4e9b244845b7ebd61fa6.
    
    Conflicts:
            drivers/acpi/pci_root.c
    
    This commit broke some pre-1.1 PCIe devices by leaving them with
    ASPM enabled.  Previously, we had disabled ASPM on these devices
    because many of them don't implement it correctly (per 149e1637).
    
    Requesting _OSC control early means that aspm_disabled may be set
    before we scan the PCI bus and configure link ASPM state.  But the
    ASPM configuration currently skips the check for pre-PCIe 1.1 devices
    when aspm_disabled is set, like this:
    
        acpi_pci_root_add
          acpi_pci_osc_support
            if (flags != base_flags)
              pcie_no_aspm
                aspm_disabled = 1
          pci_acpi_scan_root
            ...
              pcie_aspm_init_link_state
                pcie_aspm_sanity_check
                  if (!aspm_disabled)
                    /* check for pre-PCIe 1.1 device */
    
    Therefore, setting aspm_disabled early means that we leave ASPM enabled
    on these pre-PCIe 1.1 devices, which is a regression for some devices.
    
    The best fix would be to clean up the ASPM init so we can evaluate
    _OSC before scanning the bug (that way boot-time and hot-add discovery
    will work the same), but that requires significant rework.
    
    For now, we'll just revert the _OSC change as the lowest-risk fix.
    
    Reference: https://bugzilla.kernel.org/show_bug.cgi?id=55211
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Acked-by: Yinghai Lu <yinghai@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6fc628a252fd8cb8585e54fdbcdce68ca374abf7
Author: Jan Beulich <JBeulich@suse.com>
Date:   Wed Apr 3 15:47:33 2013 +0100

    x86: Fix rebuild with EFI_STUB enabled
    
    commit 918708245e92941df16a634dc201b407d12bcd91 upstream.
    
    eboot.o and efi_stub_$(BITS).o didn't get added to "targets", and hence
    their .cmd files don't get included by the build machinery, leading to
    the files always getting rebuilt.
    
    Rather than adding the two files individually, take the opportunity and
    add $(VMLINUX_OBJS) to "targets" instead, thus allowing the assignment
    at the top of the file to be shrunk quite a bit.
    
    At the same time, remove a pointless flags override line - the variable
    assigned to was misspelled anyway, and the options added are
    meaningless for assembly sources.
    
    [ hpa: the patch is not minimal, but I am taking it for -urgent anyway
      since the excess impact of the patch seems to be small enough. ]
    
    Signed-off-by: Jan Beulich <jbeulich@suse.com>
    Link: http://lkml.kernel.org/r/515C5D2502000078000CA6AD@nat28.tlf.novell.com
    Cc: Matthew Garrett <mjg@redhat.com>
    Cc: Matt Fleming <matt.fleming@intel.com>
    Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 70b4d222c77c9945de7759691cca168b6e592d15
Author: Lauri Kasanen <cand@gmx.com>
Date:   Wed Mar 27 15:04:55 2013 +0200

    drm/i915: Fix build failure
    
    commit 27b7c63a7c509d797c151e95a641e1d94d94bbd9 upstream.
    
    ERROR: "__build_bug_on_failed" [drivers/gpu/drm/i915/i915.ko] undefined!
    
    Originally reported at http://www.gossamer-threads.com/lists/linux/kernel/1631803
    FDO bug #62775
    
    This needs to be backported to both 3.7 and 3.8 stable trees. Doesn't apply straight,
    but it's a quick change.
    
    Signed-off-by: Lauri Kasanen <cand@gmx.com>
    Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=62775
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3144c24db26e1ae4d64d26f5724b5500b1363fec
Author: Trond Myklebust <Trond.Myklebust@netapp.com>
Date:   Fri Apr 5 16:11:11 2013 -0400

    NFSv4/4.1: Fix bugs in nfs4[01]_walk_client_list
    
    commit 7b1f1fd1842e6ede25183c267ae733a7f67f00bc upstream.
    
    It is unsafe to use list_for_each_entry_safe() here, because
    when we drop the nn->nfs_client_lock, we pin the _current_ list
    entry and ensure that it stays in the list, but we don't do the
    same for the _next_ list entry. Use of list_for_each_entry() is
    therefore the correct thing to do.
    
    Also fix the refcounting in nfs41_walk_client_list().
    
    Finally, ensure that the nfs_client has finished being initialised
    and, in the case of NFSv4.1, that the session is set up.
    
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
    Cc: Chuck Lever <chuck.lever@oracle.com>
    Cc: Bryan Schumaker <bjschuma@netapp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c80a1c58deeac0c21cbf8d952c1bd08f1afbe8ed
Author: Trond Myklebust <Trond.Myklebust@netapp.com>
Date:   Thu Apr 4 15:55:00 2013 -0400

    NFSv4: Fix a memory leak in nfs4_discover_server_trunking
    
    commit b193d59a4863ea670872d76dc99231ddeb598625 upstream.
    
    When we assign a new rpc_client to clp->cl_rpcclient, we need to destroy
    the old one.
    
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
    Cc: Chuck Lever <chuck.lever@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 020dff84998201602ae4d00bd38acafc62f5c693
Author: Chuck Lever <chuck.lever@oracle.com>
Date:   Fri Mar 22 12:52:59 2013 -0400

    SUNRPC: Remove extra xprt_put()
    
    commit a58e0be6f6b3eb2079b0b8fedc9df6fa86869f1e upstream.
    
    While testing error cases where rpc_new_client() fails, I saw
    some oopses.
    
    If rpc_new_client() fails, it already invokes xprt_put().  Thus
    __rpc_clone_client() does not need to invoke it again.
    
    Introduced by commit 1b63a751 "SUNRPC: Refactor rpc_clone_client()"
    Fri Sep 14, 2012.
    
    Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c50130d1682d37baac4cec833a964b2c3eb83e9c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Apr 3 21:53:57 2013 +0200

    block: avoid using uninitialized value in from queue_var_store
    
    commit c678ef5286ddb5cf70384ad5af286b0afc9b73e1 upstream.
    
    As found by gcc-4.8, the QUEUE_SYSFS_BIT_FNS macro creates functions
    that use a value generated by queue_var_store independent of whether
    that value was set or not.
    
    block/blk-sysfs.c: In function 'queue_store_nonrot':
    block/blk-sysfs.c:244:385: warning: 'val' may be used uninitialized in this function [-Wmaybe-uninitialized]
    
    Unlike most other such warnings, this one is not a false positive,
    writing any non-number string into the sysfs files indeed has
    an undefined result, rather than returning an error.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3f9d96ad56f0c8934d19684da10e1f179ef24dca
Author: Christopher Harvey <charvey@matrox.com>
Date:   Fri Apr 5 10:51:15 2013 -0400

    drm/mgag200: Index 24 in extended CRTC registers is 24 in hex, not decimal.
    
    commit 1812a3db0874be1d1524086da9e84397b800f546 upstream.
    
    This change properly enables the "requester" in G200ER cards that is
    responsible for getting pixels out of memory and clocking them out to
    the screen.
    
    Signed-off-by: Christopher Harvey <charvey@matrox.com>
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3222024c5c7837995c88d0dbb4c2f7b49b62ec05
Author: Jussi Kivilinna <jussi.kivilinna@iki.fi>
Date:   Thu Mar 28 21:54:03 2013 +0200

    crypto: gcm - fix assumption that assoc has one segment
    
    commit d3dde52209ab571e4e2ec26c66f85ad1355f7475 upstream.
    
    rfc4543(gcm(*)) code for GMAC assumes that assoc scatterlist always contains
    only one segment and only makes use of this first segment. However ipsec passes
    assoc with three segments when using 'extended sequence number' thus in this
    case rfc4543(gcm(*)) fails to function correctly. Patch fixes this issue.
    
    Reported-by: Chaoxing Lin <Chaoxing.Lin@ultra-3eti.com>
    Tested-by: Chaoxing Lin <Chaoxing.Lin@ultra-3eti.com>
    Signed-off-by: Jussi Kivilinna <jussi.kivilinna@iki.fi>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2dc505a8ed6538f9b8568621f147a440d0cd0d3a
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Fri Apr 5 14:06:35 2013 +0200

    crypto: ux500 - add missing comma
    
    commit d47cbd5bcee7c7a08fc0283dda465375fa1b1fda upstream.
    
    Commit 4f31f5b19eb0418a847b989abc9ac22af1991fe2
    "PM / crypto / ux500: Use struct dev_pm_ops for power management"
    add a new line to the driver struct but missed to add a
    trailing comma, causing build errors when crypto is
    selected. This adds the missing comma.
    
    This was not noticed until now because the crypto block
    is not in the ux500 defconfig. A separate patch will
    be submitted to fix this.
    
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Cc: Rafael J. Wysocki <rjw@sisk.pl>
    Cc: Magnus Myrstedt <magnus.p.persson@stericsson.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bfd3dc9b7abeaa29c6bc10bfcaef5a7e998e0de1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 9 10:48:33 2013 -0700

    spinlocks and preemption points need to be at least compiler barriers
    
    commit 386afc91144b36b42117b0092893f15bc8798a80 upstream.
    
    In UP and non-preempt respectively, the spinlocks and preemption
    disable/enable points are stubbed out entirely, because there is no
    regular code that can ever hit the kind of concurrency they are meant to
    protect against.
    
    However, while there is no regular code that can cause scheduling, we
    _do_ end up having some exceptional (literally!) code that can do so,
    and that we need to make sure does not ever get moved into the critical
    region by the compiler.
    
    In particular, get_user() and put_user() is generally implemented as
    inline asm statements (even if the inline asm may then make a call
    instruction to call out-of-line), and can obviously cause a page fault
    and IO as a result.  If that inline asm has been scheduled into the
    middle of a preemption-safe (or spinlock-protected) code region, we
    obviously lose.
    
    Now, admittedly this is *very* unlikely to actually ever happen, and
    we've not seen examples of actual bugs related to this.  But partly
    exactly because it's so hard to trigger and the resulting bug is so
    subtle, we should be extra careful to get this right.
    
    So make sure that even when preemption is disabled, and we don't have to
    generate any actual *code* to explicitly tell the system that we are in
    a preemption-disabled region, we need to at least tell the compiler not
    to move things around the critical region.
    
    This patch grew out of the same discussion that caused commits
    79e5f05edcbf ("ARC: Add implicit compiler barrier to raw_local_irq*
    functions") and 3e2e0d2c222b ("tile: comment assumption about
    __insn_mtspr for <asm/irqflags.h>") to come about.
    
    Note for stable: use discretion when/if applying this.  As mentioned,
    this bug may never have actually bitten anybody, and gcc may never have
    done the required code motion for it to possibly ever trigger in
    practice.
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Steven Rostedt <srostedt@redhat.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a135e4ac1c7d1998b1d6570924cae4e77f463c50
Author: Robert Tivy <rtivy@ti.com>
Date:   Thu Mar 28 18:41:43 2013 -0700

    remoteproc: fix FW_CONFIG typo
    
    commit c7426bce5933d16b492a34e42ae77e26fceddff6 upstream.
    
    Fix obvious typo introduced in commit e121aefa7d9f10eee5cf26ed47129237a05d940b
    ("remoteproc: fix missing CONFIG_FW_LOADER configurations").
    
    Signed-off-by: Robert Tivy <rtivy@ti.com>
    [cc stable, slight subject change]
    Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ccc4026c520728c39ad36cfa8ca960be9aa560fa
Author: Sjur Brændeland <sjur.brandeland@stericsson.com>
Date:   Thu Feb 21 18:15:32 2013 +0100

    remoteproc: fix error path of handle_vdev
    
    commit cde42e076c1cdd69a1f955d66ff6596bad3d2105 upstream.
    
    Remove the vdev entry from the list before freeing it,
    otherwise rproc->vdevs will explode.
    
    Signed-off-by: Sjur Brændeland <sjur.brandeland@stericsson.com>
    Acked-by: Ido Yariv <ido@wizery.com>
    [edit subject, minor commit log edit, cc stable]
    Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cb70adc51e456ea0bafd519e99d46cfc7f1b5c24
Author: Dmitry Tarnyagin <dmitry.tarnyagin@stericsson.com>
Date:   Sun Feb 10 12:39:04 2013 +0100

    remoteproc/ste: fix memory leak on shutdown
    
    commit 1cd425b660bd5b4f41b9175b0b7bf3828ce88144 upstream.
    
    Fixes coherent memory leakage, caused by non-deallocated
    firmware image chunk.
    
    Signed-off-by: Dmitry Tarnyagin <dmitry.tarnyagin@stericsson.com>
    Signed-off-by: Sjur Brændeland <sjur.brandeland@stericsson.com>
    Acked-by: Ido Yariv <ido@wizery.com>
    [slightly edit subject and commit log]
    Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5fd59356f367d5176d0858ce9c25c2255da2487a
Author: Li Fei <fei.li@intel.com>
Date:   Fri Apr 5 21:20:36 2013 +0800

    hwspinlock: fix __hwspin_lock_request error path
    
    commit c10b90d85a5126d25c89cbaa50dc9fdd1c4d001a upstream.
    
    Even in failed case of pm_runtime_get_sync, the usage_count
    is incremented. In order to keep the usage_count with correct
    value and runtime power management to behave correctly, call
    pm_runtime_put_noidle in such case.
    
    In __hwspin_lock_request, module_put is also called before
    return in pm_runtime_get_sync failed case.
    
    Signed-off-by Liu Chuansheng <chuansheng.liu@intel.com>
    Signed-off-by: Li Fei <fei.li@intel.com>
    [edit commit log]
    Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 85b2a222e5d31bcc26fa4f42a3faefa20b68cc92
Author: Paul Moore <pmoore@redhat.com>
Date:   Fri Feb 15 12:21:43 2013 -0500

    x86: remove the x32 syscall bitmask from syscall_get_nr()
    
    commit 8b4b9f27e57584f3d90e0bb84cf800ad81cfe3a1 upstream.
    
    Commit fca460f95e928bae373daa8295877b6905bc62b8 simplified the x32
    implementation by creating a syscall bitmask, equal to 0x40000000, that
    could be applied to x32 syscalls such that the masked syscall number
    would be the same as a x86_64 syscall.  While that patch was a nice
    way to simplify the code, it went a bit too far by adding the mask to
    syscall_get_nr(); returning the masked syscall numbers can cause
    confusion with callers that expect syscall numbers matching the x32
    ABI, e.g. unmasked syscall numbers.
    
    This patch fixes this by simply removing the mask from syscall_get_nr()
    while preserving the other changes from the original commit.  While
    there are several syscall_get_nr() callers in the kernel, most simply
    check that the syscall number is greater than zero, in this case this
    patch will have no effect.  Of those remaining callers, they appear
    to be few, seccomp and ftrace, and from my testing of seccomp without
    this patch the original commit definitely breaks things; the seccomp
    filter does not correctly filter the syscalls due to the difference in
    syscall numbers in the BPF filter and the value from syscall_get_nr().
    Applying this patch restores the seccomp BPF filter functionality on
    x32.
    
    I've tested this patch with the seccomp BPF filters as well as ftrace
    and everything looks reasonable to me; needless to say general usage
    seemed fine as well.
    
    Signed-off-by: Paul Moore <pmoore@redhat.com>
    Link: http://lkml.kernel.org/r/20130215172143.12549.10292.stgit@localhost
    Cc: Will Drewry <wad@chromium.org>
    Cc: H. Peter Anvin <hpa@zytor.com>
    Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5c4a5a843043493ee5ddd9978517c4357a7245ee
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Mon Mar 25 11:51:14 2013 +0100

    mac80211: fix remain-on-channel cancel crash
    
    commit 3fbd45ca8d1c98f3c2582ef8bc70ade42f70947b upstream.
    
    If a ROC item is canceled just as it expires, the work
    struct may be scheduled while it is running (and waiting
    for the mutex). This results in it being run after being
    freed, which obviously crashes.
    
    To fix this don't free it when aborting is requested but
    instead mark it as "to be freed", which makes the work a
    no-op and allows freeing it outside.
    
    Reported-by: Jouni Malinen <j@w1.fi>
    Tested-by: Jouni Malinen <j@w1.fi>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 86489ad1d0346c94a575c2e370a57d3ffb9bd2ad
Author: Stone Piao <piaoyun@marvell.com>
Date:   Fri Mar 29 19:21:21 2013 -0700

    mwifiex: limit channel number not to overflow memory
    
    commit 901ceba4e81e9dd6b4a3c4c37ee22000a6c5c65f upstream.
    
    Limit the channel number in scan request, or the driver scan
    config structure memory will be overflowed.
    
    Signed-off-by: Stone Piao <piaoyun@marvell.com>
    Signed-off-by: Bing Zhao <bzhao@marvell.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit eea464d4f60f3482680ca831327b8f6e0f75b52f
Author: Michael Wolf <mjw@linux.vnet.ibm.com>
Date:   Fri Apr 5 10:41:40 2013 +0000

    powerpc: pSeries_lpar_hpte_remove fails from Adjunct partition being performed before the ANDCOND test
    
    commit 9fb2640159f9d4f5a2a9d60e490482d4cbecafdb upstream.
    
    Some versions of pHyp will perform the adjunct partition test before the
    ANDCOND test.  The result of this is that H_RESOURCE can be returned and
    cause the BUG_ON condition to occur. The HPTE is not removed.  So add a
    check for H_RESOURCE, it is ok if this HPTE is not removed as
    pSeries_lpar_hpte_remove is looking for an HPTE to remove and not a
    specific HPTE to remove.  So it is ok to just move on to the next slot
    and try again.
    
    Signed-off-by: Michael Wolf <mjw@linux.vnet.ibm.com>
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 55c823de4a6973acb4f849e8010f8b99b9205a71
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Tue Mar 26 17:53:03 2013 +0100

    ftrace: Consistently restore trace function on sysctl enabling
    
    commit 5000c418840b309251c5887f0b56503aae30f84c upstream.
    
    If we reenable ftrace via syctl, we currently set ftrace_trace_function
    based on the previous simplistic algorithm. This is inconsistent with
    what update_ftrace_function does. So better call that helper instead.
    
    Link: http://lkml.kernel.org/r/5151D26F.1070702@siemens.com
    
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 49ea36e6238b3953cc45167104cd55a1d4f794a9
Author: Youquan Song <youquan.song@intel.com>
Date:   Wed Mar 6 10:49:05 2013 -0500

    ata_piix: Fix DVD not dectected at some Haswell platforms
    
    commit b55f84e2d527182e7c611d466cd0bb6ddce201de upstream.
    
    There is a quirk patch 5e5a4f5d5a08c9c504fe956391ac3dae2c66556d
    "ata_piix: make DVD Drive recognisable on systems with Intel Sandybridge
     chipsets(v2)" fixing the 4 ports IDE controller 32bit PIO mode.
    
    We've hit a problem with DVD not recognized on Haswell Desktop platform which
    includes Lynx Point 2-port SATA controller.
    
    This quirk patch disables 32bit PIO on this controller in IDE mode.
    
    v2: Change spelling error in statememnt pointed by Sergei Shtylyov.
    v3: Change comment statememnt and spliting line over 80 characters pointed by
        Libor Pechacek and also rebase the patch against 3.8-rc7 kernel.
    
    Tested-by: Lee, Chun-Yi <jlee@suse.com>
    Signed-off-by: Youquan Song <youquan.song@intel.com>
    Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 88ce31a5f4f65242315cea3e48b8eea1ef114429
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Sat Mar 30 23:38:02 2013 +0100

    PCI/PM: Disable runtime PM of PCIe ports
    
    commit de7d5f729c72638f41d7c17487bccb1c570ff144 upstream.
    
    The runtime PM of PCIe ports turns out to be quite fragile, as in
    some cases things work while in some other cases they don't and we
    don't seem to have a good way to determine whether or not they are
    going to work in advance.
    
    For this reason, avoid enabling runtime PM for PCIe ports by
    keeping their runtime PM reference counters always above 0 for the
    time being.
    
    When a PCIe port is suspended, it can no longer report events like
    hotplug, so hotplug below the port may not work, as in the bug
    report below.
    
    [bhelgaas: changelog, stable]
    Reference: https://bugzilla.kernel.org/show_bug.cgi?id=53811
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 429e8ae2f2c8d67b1c7ada215aae2c849b5e48bf
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Thu Mar 28 11:07:29 2013 +0000

    PCI/ACPI: Always resume devices on ACPI wakeup notifications
    
    commit 24ad0ef9c8b946ed2abe681e4e44f4a1e643d882 upstream.
    
    It turns out that the _Lxx control methods provided by some BIOSes
    clear the PME Status bit of PCI devices they handle, which means that
    pci_acpi_wake_dev() cannot really use that bit to check whether or
    not the device has signalled wakeup.
    
    One symptom of the problem is, for example, that when an affected PCI
    USB controller is runtime-suspended, then plugging in a new USB device
    into one of the controller's ports will not wake up the controller,
    which should happen.
    
    For this reason, make pci_acpi_wake_dev() always attempt to resume
    the device it is called for regardless of the device's PME Status bit
    value (that bit still has to be cleared if set at this point,
    though).
    
    Reported-by: Sarah Sharp <sarah.a.sharp@linux.intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Acked-by: Matthew Garrett <mjg59@srcf.ucam.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b583e5e39115b913abe7a843c55eb2b47176aa07
Author: Jay Estabrook <jay.estabrook@gmail.com>
Date:   Sun Apr 7 21:36:09 2013 +1200

    alpha: Add irongate_io to PCI bus resources
    
    commit aa8b4be3ac049c8b1df2a87e4d1d902ccfc1f7a9 upstream.
    
    Fixes a NULL pointer dereference at boot on UP1500.
    
    Reviewed-and-Tested-by: Matt Turner <mattst88@gmail.com>
    Signed-off-by: Jay Estabrook <jay.estabrook@gmail.com>
    Signed-off-by: Matt Turner <mattst88@gmail.com>
    Signed-off-by: Michael Cree <mcree@orcon.net.nz>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 66f61406de35d8e074a10372e26e9d71eab261bd
Author: David Daney <david.daney@cavium.com>
Date:   Tue Apr 2 22:59:29 2013 +0000

    MIPS: Unbreak function tracer for 64-bit kernel.
    
    commit ad8c396936e328f5344e1881afde9e28d5f2045f upstream.
    
    Commit 58b69401c797 [MIPS: Function tracer: Fix broken function tracing]
    completely broke the function tracer for 64-bit kernels.  The symptom is
    a system hang very early in the boot process.
    
    The fix: Remove/fix $sp adjustments for 64-bit case.
    
    Signed-off-by: David Daney <david.daney@cavium.com>
    Cc: linux-mips@linux-mips.org
    Cc: Al Cooper <alcooperx@gmail.com>
    Cc: viric@viric.name
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fa86f95a5aa0976bf4e326b390b5608c9b111943
Author: David Woodhouse <dwmw2@infradead.org>
Date:   Fri Mar 29 11:54:55 2013 +0000

    libata: fix DMA to stack in reading devslp_timing parameters
    
    commit 8e725c7f8a60feaa88edacd4dee2c754d5ae7706 upstream.
    
    Commit 803739d25c2343da6d2f95eebdcbc08bf67097d4 ("[libata] replace
    sata_settings with devslp_timing"), which was also Cc: stable, used a
    stack buffer to receive data from ata_read_log_page(), which triggers
    the following warning:
     ahci 0000:00:1f.2: DMA-API: device driver maps memory fromstack [addr=ffff880140469948]
    
    Fix this by using ap->sector_buf instead of a stack buffer.
    
    Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
    Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e584d9d2a25b79fcf07d66dbdccef6646623b9e7
Author: Shan Hai <shan.hai@windriver.com>
Date:   Mon Mar 18 10:30:44 2013 +0800

    libata: Set max sector to 65535 for Slimtype DVD A DS8A8SH drive
    
    commit a32450e127fc6e5ca6d958ceb3cfea4d30a00846 upstream.
    
    The Slimtype DVD A  DS8A8SH drive locks up when max sector is smaller than
    65535, and the blow backtrace is observed on locking up:
    
    INFO: task flush-8:32:1130 blocked for more than 120 seconds.
    "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
    flush-8:32      D ffffffff8180cf60     0  1130      2 0x00000000
     ffff880273aef618 0000000000000046 0000000000000005 ffff880273aee000
     ffff880273aee000 ffff880273aeffd8 ffff880273aee010 ffff880273aee000
     ffff880273aeffd8 ffff880273aee000 ffff88026e842ea0 ffff880274a10000
    Call Trace:
     [<ffffffff8168fc2d>] schedule+0x5d/0x70
     [<ffffffff8168fccc>] io_schedule+0x8c/0xd0
     [<ffffffff81324461>] get_request+0x731/0x7d0
     [<ffffffff8133dc60>] ? cfq_allow_merge+0x50/0x90
     [<ffffffff81083aa0>] ? wake_up_bit+0x40/0x40
     [<ffffffff81320443>] ? bio_attempt_back_merge+0x33/0x110
     [<ffffffff813248ea>] blk_queue_bio+0x23a/0x3f0
     [<ffffffff81322176>] generic_make_request+0xc6/0x120
     [<ffffffff81322308>] submit_bio+0x138/0x160
     [<ffffffff811d7596>] ? bio_alloc_bioset+0x96/0x120
     [<ffffffff811d1f61>] submit_bh+0x1f1/0x220
     [<ffffffff811d48b8>] __block_write_full_page+0x228/0x340
     [<ffffffff811d3650>] ? attach_nobh_buffers+0xc0/0xc0
     [<ffffffff811d8960>] ? I_BDEV+0x10/0x10
     [<ffffffff811d8960>] ? I_BDEV+0x10/0x10
     [<ffffffff811d4ab6>] block_write_full_page_endio+0xe6/0x100
     [<ffffffff811d4ae5>] block_write_full_page+0x15/0x20
     [<ffffffff811d9268>] blkdev_writepage+0x18/0x20
     [<ffffffff81142527>] __writepage+0x17/0x40
     [<ffffffff811438ba>] write_cache_pages+0x34a/0x4a0
     [<ffffffff81142510>] ? set_page_dirty+0x70/0x70
     [<ffffffff81143a61>] generic_writepages+0x51/0x80
     [<ffffffff81143ab0>] do_writepages+0x20/0x50
     [<ffffffff811c9ed6>] __writeback_single_inode+0xa6/0x2b0
     [<ffffffff811ca861>] writeback_sb_inodes+0x311/0x4d0
     [<ffffffff811caaa6>] __writeback_inodes_wb+0x86/0xd0
     [<ffffffff811cad43>] wb_writeback+0x1a3/0x330
     [<ffffffff816916cf>] ? _raw_spin_lock_irqsave+0x3f/0x50
     [<ffffffff811b8362>] ? get_nr_inodes+0x52/0x70
     [<ffffffff811cb0ac>] wb_do_writeback+0x1dc/0x260
     [<ffffffff8168dd34>] ? schedule_timeout+0x204/0x240
     [<ffffffff811cb232>] bdi_writeback_thread+0x102/0x2b0
     [<ffffffff811cb130>] ? wb_do_writeback+0x260/0x260
     [<ffffffff81083550>] kthread+0xc0/0xd0
     [<ffffffff81083490>] ? kthread_worker_fn+0x1b0/0x1b0
     [<ffffffff8169a3ec>] ret_from_fork+0x7c/0xb0
     [<ffffffff81083490>] ? kthread_worker_fn+0x1b0/0x1b0
    
     The above trace was triggered by
       "dd if=/dev/zero of=/dev/sr0 bs=2048 count=32768"
    
     It was previously working by accident, since another bug introduced
     by 4dce8ba94c7 (libata: Use 'bool' return value for ata_id_XXX) caused
     all drives to use maxsect=65535.
    
    Signed-off-by: Shan Hai <shan.hai@windriver.com>
    Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c2d2cd83e221156d11cd5f8945630e8509a852a6
Author: Shan Hai <shan.hai@windriver.com>
Date:   Mon Mar 18 10:30:43 2013 +0800

    libata: Use integer return value for atapi_command_packet_set
    
    commit d8668fcb0b257d9fdcfbe5c172a99b8d85e1cd82 upstream.
    
    The function returns type of ATAPI drives so it should return integer value.
    The commit 4dce8ba94c7 (libata: Use 'bool' return value for ata_id_XXX) since
    v2.6.39 changed the type of return value from int to bool, the change would
    cause all of the ATAPI class drives to be treated as TYPE_TAPE and the
    max_sectors of the drives to be set to 65535 because of the commit
    f8d8e5799b7(libata: increase 128 KB / cmd limit for ATAPI tape drives), for the
    function would return true for all ATAPI class drives and the TYPE_TAPE is
    defined as 0x01.
    
    Signed-off-by: Shan Hai <shan.hai@windriver.com>
    Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 570d75c0babf5ded1aa40cc751f0a1f8d400e109
Author: Jakub Kicinski <jakub.kicinski@intel.com>
Date:   Wed Apr 3 16:50:54 2013 +0000

    ixgbe: fix registration order of driver and DCA nofitication
    
    commit f01fc1a82c2ee68726b400fadb156bd623b5f2f1 upstream.
    
    ixgbe_notify_dca cannot be called before driver registration
    because it expects driver's klist_devices to be allocated and
    initialized. While on it make sure debugfs files are removed
    when registration fails.
    
    Signed-off-by: Jakub Kicinski <jakub.kicinski@intel.com>
    Tested-by: Phil Schmitt <phillip.j.schmitt@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit da7a8ddf5d298e05cc49b97ecbf17a591df80290
Author: Yinghai Lu <yinghai@kernel.org>
Date:   Mon Apr 1 11:48:59 2013 -0600

    EISA/PCI: Fix bus res reference
    
    commit 2cfda637e29ce9e3df31b59f64516b2e571cc985 upstream.
    
    Matthew found that 3.8.3 is having problems with an old (ancient)
    PCI-to-EISA bridge, the Intel 82375. It worked with the 3.2 kernel.
    He identified the 82375, but doesn't assign the struct resource *res
    pointer inside the struct eisa_root_device, and panics.
    
    pci_eisa_init() was using bus->resource[] directly instead of
    pci_bus_resource_n().  The bus->resource[] array is a PCI-internal
    implementation detail, and after commit 45ca9e97 (PCI: add helpers for
    building PCI bus resource lists) and commit 0efd5aab (PCI: add struct
    pci_host_bridge_window with CPU/bus address offset), bus->resource[] is not
    used for PCI root buses any more.
    
    The 82375 is a subtractive-decode PCI device, so handle it the same
    way we handle PCI-PCI bridges in subtractive-decode mode in
    pci_read_bridge_bases().
    
    [bhelgaas: changelog]
    Reported-by: Matthew Whitehead <mwhitehe@redhat.com>
    Tested-by: Matthew Whitehead <mwhitehe@redhat.com>
    Signed-off-by: Yinghai Lu <yinghai@kernel.org>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 97d7fe0a75a912a9df4bfec075b123992a6ec144
Author: Yinghai Lu <yinghai@kernel.org>
Date:   Wed Mar 27 21:28:05 2013 -0700

    EISA/PCI: Init EISA early, before PNP
    
    commit c5fb301ae83bec6892e54984e6ec765c47df8e10 upstream.
    
    Matthew reported kernels fail the pci_eisa probe and are later successful
    with the virtual_eisa_root_init force probe without slot0.
    
    The reason for that is: PNP probing is before pci_eisa_init gets called
    as pci_eisa_init is called via pci_driver.
    
    pnp 00:0f has 0xc80 - 0xc84 reserved.
    [    9.700409] pnp 00:0f: [io  0x0c80-0x0c84]
    
    so eisa_probe will fail from pci_eisa_init
                                    ==>eisa_root_register
                                            ==>eisa_probe path.
    as force_probe is not set in pci_eisa_root, it will bail early when
    slot0 is not probed and initialized.
    
    Try to use subsys_initcall_sync instead, and will keep following sequence:
            pci_subsys_init
            pci_eisa_init_early
            pnpacpi_init/isapnp_init
    
    After this patch EISA can be initialized properly, and PNP overlapping
    resource will not be reserved.
    [   10.104434] system 00:0f: [io  0x0c80-0x0c84] could not be reserved
    
    Reported-by: Matthew Whitehead <mwhitehe@redhat.com>
    Tested-by: Matthew Whitehead <mwhitehe@redhat.com>
    Signed-off-by: Yinghai Lu <yinghai@kernel.org>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1c3d46086113bd3f49f65520aaa249708a40d20f
Author: Jan Stancek <jstancek@redhat.com>
Date:   Thu Apr 4 11:35:10 2013 -0700

    mm: prevent mmap_cache race in find_vma()
    
    commit b6a9b7f6b1f21735a7456d534dc0e68e61359d2c upstream.
    
    find_vma() can be called by multiple threads with read lock
    held on mm->mmap_sem and any of them can update mm->mmap_cache.
    Prevent compiler from re-fetching mm->mmap_cache, because other
    readers could update it in the meantime:
    
                   thread 1                             thread 2
                                            |
      find_vma()                            |  find_vma()
        struct vm_area_struct *vma = NULL;  |
        vma = mm->mmap_cache;               |
        if (!(vma && vma->vm_end > addr     |
            && vma->vm_start <= addr)) {    |
                                            |    mm->mmap_cache = vma;
        return vma;                         |
         ^^ compiler may optimize this      |
            local variable out and re-read  |
            mm->mmap_cache                  |
    
    This issue can be reproduced with gcc-4.8.0-1 on s390x by running
    mallocstress testcase from LTP, which triggers:
    
      kernel BUG at mm/rmap.c:1088!
        Call Trace:
         ([<000003d100c57000>] 0x3d100c57000)
          [<000000000023a1c0>] do_wp_page+0x2fc/0xa88
          [<000000000023baae>] handle_pte_fault+0x41a/0xac8
          [<000000000023d832>] handle_mm_fault+0x17a/0x268
          [<000000000060507a>] do_protection_exception+0x1e2/0x394
          [<0000000000603a04>] pgm_check_handler+0x138/0x13c
          [<000003fffcf1f07a>] 0x3fffcf1f07a
        Last Breaking-Event-Address:
          [<000000000024755e>] page_add_new_anon_rmap+0xc2/0x168
    
    Thanks to Jakub Jelinek for his insight on gcc and helping to
    track this down.
    
    Signed-off-by: Jan Stancek <jstancek@redhat.com>
    Acked-by: David Rientjes <rientjes@google.com>
    Signed-off-by: Hugh Dickins <hughd@google.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 113dce72ecf60b4616afc4910abd24201eea82e2
Author: Johan Hovold <johan@kernel.org>
Date:   Fri Apr 5 18:16:34 2013 +0200

    Revert "drivers/rtc/rtc-at91rm9200.c: use a variable for storing IMR"
    
    commit e24b0bfa2f0446ffaad2661040be23668133aef8 upstream.
    
    This reverts commit 0ef1594c017521ea89278e80fe3f80dafb17abde.
    
    This patch introduced a few races which cannot be easily fixed with a
    small follow-up patch. Furthermore, the SoC with the broken hardware
    register, which this patch intended to add support for, can only be used
    with device trees, which this driver currently does not support.
    
    [ Here is the discussion that led to this "revert" patch:
      https://lkml.org/lkml/2013/4/3/176 ]
    
    Signed-off-by: Johan Hovold <jhovold@gmail.com>
    Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4f0405710480beec4cef54697c693df217e969a1
Author: Ilija Hadzic <ihadzic@research.bell-labs.com>
Date:   Tue Apr 2 09:56:10 2013 -0400

    drm: correctly restore mappings if drm_open fails
    
    commit a8ec3a662921220fc058ed6f7f3674697876d218 upstream.
    
    If first drm_open fails, the error-handling path will
    incorrectly restore inode's mapping to NULL. This can
    cause the crash later on. Fix by separately storing
    away mapping pointers that drm_open can touch and
    restore each from its own respective variable if the
    call fails.
    
    Fixes: https://bugzilla.novell.com/show_bug.cgi?id=807850
    (thanks to Michal Hocko for investigating investigating and
    finding the root cause of the bug)
    
    Reference:
    http://lists.freedesktop.org/archives/dri-devel/2013-March/036564.html
    
    v2: Use one variable to store file and inode mapping
        since they are the same at the function entry.
        Fix spelling mistakes in commit message.
    
    v3: Add reference to the original bug report.
    
    Reported-by: Marco Munderloh <munderl@tnt.uni-hannover.de>
    Tested-by: Marco Munderloh <munderl@tnt.uni-hannover.de>
    Signed-off-by: Ilija Hadzic <ihadzic@research.bell-labs.com>
    Cc: Michal Hocko <mhocko@suse.cz>
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d7ca2c16dd8896ba4daa7a674b36ee6025b15e94
Author: Adam Jackson <ajax@redhat.com>
Date:   Mon Mar 25 15:40:05 2013 -0400

    drm/i915: Be sure to turn hsync/vsync back on at crt enable (v2)
    
    commit 637f44d24f8868ee5a597a99e7874fdd150d4cba upstream.
    
    commit f40ebd6bcbbd0d30591f42dc16be52b5086a366b
    Author: Patrik Jakobsson <patrik.r.jakobsson@gmail.com>
    Date:   Tue Mar 5 14:24:48 2013 +0100
    
        drm/i915: Turn off hsync and vsync on ADPA when disabling crt
    
    properly disabled the hsync/vsync logic at disable time, but neglected
    to re-enable them at enable time.
    
    v2: In the enable hook, restore the connector's expected DPMS level
    instead of forcing ON.  Do this by stashing a back pointer to the
    connector in the crt (suggested by danvet) since otherwise it's awkward
    to look up.
    
    Signed-off-by: Adam Jackson <ajax@redhat.com>
    [danvet: Added more verbose commit citation and cc: stable tag. Also,
    make it compile. Then self-lart and try to assign the right pointer.]
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2705de01e2dcd27e86aafc8837998c885f9cfcef
Author: Maarten Lankhorst <maarten.lankhorst@canonical.com>
Date:   Sun Mar 24 15:36:38 2013 +0100

    drm/nouveau: fix handling empty channel list in ioctl's
    
    commit b43decd2c513ae44a5462a1a4c2622f0fa77c9e0 upstream.
    
    If there are no channels, chan would never end up being NULL,
    and so the null pointer check would fail.
    
    Solve this by initializing chan to NULL, and iterating over temp instead.
    
    Fixes oops when running intel-gpu-tools/tests/kms_flip, which attempts to
    do some intel ioctl's on a nouveau device.
    
    Signed-off-by: Maarten Lankhorst <maarten.lankhorst@canonical.com>
    Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 05c05ef21a1cf71d16189cd4d8060b47f504db2b
Author: David Henningsson <david.henningsson@canonical.com>
Date:   Thu Apr 4 11:47:13 2013 +0200

    ALSA: hda - fix typo in proc output
    
    commit aeb3a97222832e5457c4b72d72235098ce4bfe8d upstream.
    
    Rename "Digitial In" to "Digital In". This function is only used for
    proc output, so should not cause any problems to change.
    
    Signed-off-by: David Henningsson <david.henningsson@canonical.com>
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0187ab6184b36cc1f01424ef534648c198578dbe
Author: Rainer Koenig <Rainer.Koenig@ts.fujitsu.com>
Date:   Thu Apr 4 08:40:38 2013 +0200

    ALSA: hda - Enabling Realtek ALC 671 codec
    
    commit 1d87caa69c04008e09f5ff47b5e6acb6116febc7 upstream.
    
    * Added the device ID to the modalias list and assinged ALC662 patches
    for it
    * Added 4 port support for the device ID 0671 in alc662_parse_auto_config
    
    Signed-off-by: Rainer Koenig <Rainer.Koenig@ts.fujitsu.com>
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 083e2330c09b7a5f905020c10e9f52b5c1e17979
Author: Mengdong Lin <mengdong.lin@intel.com>
Date:   Thu Mar 28 05:20:22 2013 -0400

    ALSA: hda - bug fix on return value when getting HDMI ELD info
    
    commit 2ef5692efad330b67a234e2c49edad38538751e7 upstream.
    
    In function snd_hdmi_get_eld(), the variable 'ret' should be initialized to 0.
    Otherwise it will be returned uninitialized as non-zero after ELD info is got
    successfully. Thus hdmi_present_sense() will always assume ELD info is invalid
    by mistake, and /proc file system cannot show the proper ELD info.
    
    Signed-off-by: Mengdong Lin <mengdong.lin@intel.com>
    Acked-by: David Henningsson <david.henningsson@canonical.com>
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8a348c928a2bfe8640c29a52ac81263aa46c4347
Author: Jan Kara <jack@suse.cz>
Date:   Fri Mar 29 15:39:16 2013 +0100

    reiserfs: Fix warning and inode leak when deleting inode with xattrs
    
    commit 35e5cbc0af240778e61113286c019837e06aeec6 upstream.
    
    After commit 21d8a15a (lookup_one_len: don't accept . and ..) reiserfs
    started failing to delete xattrs from inode. This was due to a buggy
    test for '.' and '..' in fill_with_dentries() which resulted in passing
    '.' and '..' entries to lookup_one_len() in some cases. That returned
    error and so we failed to iterate over all xattrs of and inode.
    
    Fix the test in fill_with_dentries() along the lines of the one in
    lookup_one_len().
    
    Reported-by: Pawel Zawora <pzawora@gmail.com>
    Signed-off-by: Jan Kara <jack@suse.cz>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1afae6963468982b21072e13999dcc94553a7e44
Author: Artem Bityutskiy <artem.bityutskiy@linux.intel.com>
Date:   Thu Mar 14 10:49:23 2013 +0200

    UBIFS: make space fixup work in the remount case
    
    commit 67e753ca41782913d805ff4a8a2b0f60b26b7915 upstream.
    
    The UBIFS space fixup is a useful feature which allows to fixup the "broken"
    flash space at the time of the first mount. The "broken" space is usually the
    result of using a "dumb" industrial flasher which is not able to skip empty
    NAND pages and just writes all 0xFFs to the empty space, which has grave
    side-effects for UBIFS when UBIFS trise to write useful data to those empty
    pages.
    
    The fix-up feature works roughly like this:
    1. mkfs.ubifs sets the fixup flag in UBIFS superblock when creating the image
       (see -F option)
    2. when the file-system is mounted for the first time, UBIFS notices the fixup
       flag and re-writes the entire media atomically, which may take really a lot
       of time.
    3. UBIFS clears the fixup flag in the superblock.
    
    This works fine when the file system is mounted R/W for the very first time.
    But it did not really work in the case when we first mount the file-system R/O,
    and then re-mount R/W. The reason was that we started the fixup procedure too
    late, which we cannot really do because we have to fixup the space before it
    starts being used.
    
    Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com>
    Reported-by: Mark Jackson <mpfj-list@mimc.co.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 25df8ddf7924c52c76fbb84ab72dab38524bb1c6
Author: Gabriel Fernandez <gabriel.fernandez@stericsson.com>
Date:   Mon Mar 18 11:45:05 2013 +0100

    gpio: stmpe: pass DT node to irqdomain
    
    commit 9afd9b7090225d78ef56423a2ff65354dc38f1b1 upstream.
    
    The irq domain was implemented but the device tree
    node was not transmitted to irq_domain_add_simple().
    
    Signed-off-by: Gabriel Fernandez <gabriel.fernandez@stericsson.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3b9f7811595e796ec810b4459ea2711d9c6d2562
Author: Anatolij Gustschin <agust@denx.de>
Date:   Wed Mar 13 14:57:43 2013 +0100

    spi/mpc512x-psc: optionally keep PSC SS asserted across xfer segmensts
    
    commit 1ad849aee5f53353ed88d9cd3d68a51b03a7d44f upstream.
    
    Some SPI slave devices require asserted chip select signal across
    multiple transfer segments of an SPI message. Currently the driver
    always de-asserts the internal SS signal for every single transfer
    segment of the message and ignores the 'cs_change' flag of the
    transfer description. Disable the internal chip select (SS) only
    if this is needed and indicated by the 'cs_change' flag.
    
    Without this change, each partial transfer of a surrounding
    multi-part SPI transaction might erroneously change the SS
    signal, which might prevent slaves from answering the request
    that was sent in a previous transfer segment because the
    transaction could be considered aborted (SS was de-asserted
    before reading the response).
    
    Reported-by: Gerhard Sittig <gerhard.sittig@ifm.com>
    Signed-off-by: Anatolij Gustschin <agust@denx.de>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0f9da4da0299fbfb23c6439a348914688ac9c9da
Author: Girish K S <girishks2000@gmail.com>
Date:   Wed Mar 13 12:13:30 2013 +0530

    spi/s3c64xx: modified error interrupt handling and init
    
    commit 375981f2e14868be16cafbffd34a4f16a6ee01c6 upstream.
    
    The status of the interrupt is available in the status register,
    so reading the clear pending register and writing back the same
    value will not actually clear the pending interrupts. This patch
    modifies the interrupt handler to read the status register and
    clear the corresponding pending bit in the clear pending register.
    
    Modified the hwInit function to clear all the pending interrupts.
    
    Signed-off-by: Girish K S <ks.giri@samsung.com>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0e55072e7c63a6569cab1447e9025d160abd9dd9
Author: Benjamin Tissoires <benjamin.tissoires@redhat.com>
Date:   Tue Apr 2 11:11:52 2013 +0200

    HID: magicmouse: fix race between input_register() and probe()
    
    commit f1a9a149abc86903e81dd1b2e720f3f89874384b upstream.
    
    Since kernel 3.7, it appears that the input registration occured before
    the end of magicmouse_setup_input(). This is shown by receiving a lot of
    "EV_SYN SYN_REPORT 1" instead of normal "EV_SYN SYN_REPORT 0".
    This value means that the output buffer is full, and the user space
    is loosing events.
    
    Using .input_configured guarantees that the race is not occuring, and that
    the call of "input_set_events_per_packet(input, 60)" is taken into account
    by input_register().
    
    Fixes:
    https://bugzilla.redhat.com/show_bug.cgi?id=908604
    
    Reported-and-Tested-By: Clarke Wixon <cwixon@usa.net>
    Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 79d7517b899ef695bf0674afb4e5ce1b1a4ecfeb
Author: David Daney <david.daney@cavium.com>
Date:   Tue Feb 26 14:35:23 2013 -0800

    MIPS: Fix logic errors in bitops.c
    
    commit 0c81157b46c533139d6be721d41617020c59a2c3 upstream.
    
    commit 92d11594f6 (MIPS: Remove irqflags.h dependency from bitops.h)
    factored some of the bitops code out into a separate file
    (arch/mips/lib/bitops.c).  Unfortunately the logic converting a bit
    mask into a boolean result was lost in some of the functions.  We had:
    
       int res;
       unsigned long shifted_result_bit;
       .
       .
       .
       res = shifted_result_bit;
       return res;
    
    Which truncates off the high 32 bits (thus yielding an incorrect
    value) on 64-bit systems.
    
    The manifestation of this is that a non-SMP 64-bit kernel will not
    boot as the bitmap operations in bootmem.c are all screwed up.
    
    Signed-off-by: David Daney <david.daney@cavium.com>
    Cc:  linux-mips@linux-mips.org
    Cc: Jim Quinlan <jim2101024@gmail.com>
    Patchwork: https://patchwork.linux-mips.org/patch/4965/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bbe2d01529084ebb9cc5361ef971ddfa34fdaf4c
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Wed Mar 13 16:38:33 2013 +0100

    regmap: cache Fix regcache-rbtree sync
    
    commit 8abac3ba51b5525354e9b2ec0eed1c9e95c905d9 upstream.
    
    The last register block, which falls into the specified range, is not handled
    correctly. The formula which calculates the number of register which should be
    synced is inverse (and off by one). E.g. if all registers in that block should
    be synced only one is synced, and if only one should be synced all (but one) are
    synced. To calculate the number of registers that need to be synced we need to
    subtract the number of the first register in the block from the max register
    number and add one. This patch updates the code accordingly.
    
    The issue was introduced in commit ac8d91c ("regmap: Supply ranges to the sync
    operations").
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5d05e0b8506e4ff27a23af6b552ab646192e2260
Author: Dimitris Papastamos <dp@opensource.wolfsonmicro.com>
Date:   Mon Mar 11 17:27:02 2013 +0000

    regmap: Initialize `map->debugfs' before regcache
    
    commit c6432ea9cc043994d5b7dcb3ad86a087777cb40c upstream.
    
    In the rbtree code we are exposing statistics relating to the
    number of nodes/registers of the rbtree cache for each of the
    devices.  Ensure that `map->debugfs' has been initialized before
    we attempt to initialize the debugfs entry for the rbtree cache.
    
    Signed-off-by: Dimitris Papastamos <dp@opensource.wolfsonmicro.com>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2b44022a4cb95795c72bbda12ef1bd66a30fb3b5
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Mon Mar 18 18:57:23 2013 +0100

    ASoC: spear_pcm: Update to new pcm_new() API
    
    commit 59d9cc2a5073ab4b8c8f8bdbacf230a538abc55d upstream.
    
    Commit 552d1ef6 ("ASoC: core - Optimise and refactor pcm_new() to pass only
    rtd") updated the pcm_new() callback to take the rtd as the only parameter. The
    spear PCM driver (which was merged much later) still uses the old API. This
    patch updates the driver to the new API.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Acked-by: Rajeev Kumar <rajeev-dlh.kumar@st.com>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 23127ff0cae231bcd2442c2fb89d3e15814d1e82
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Fri Mar 15 11:26:15 2013 +0100

    ASoC: dma-sh7760: Fix compile error
    
    commit 417a1178f1bf3cdc606376b3ded3a22489fbb3eb upstream.
    
    The dma-sh7760 currently fails with the following compile error:
            sound/soc/sh/dma-sh7760.c:346:2: error: unknown field 'pcm_ops' specified in initializer
            sound/soc/sh/dma-sh7760.c:346:2: warning: initialization from incompatible pointer type
            sound/soc/sh/dma-sh7760.c:347:2: error: unknown field 'pcm_new' specified in initializer
            sound/soc/sh/dma-sh7760.c:347:2: warning: initialization makes integer from pointer without a cast
            sound/soc/sh/dma-sh7760.c:348:2: error: unknown field 'pcm_free' specified in initializer
            sound/soc/sh/dma-sh7760.c:348:2: warning: initialization from incompatible pointer type
            sound/soc/sh/dma-sh7760.c: In function 'sh7760_soc_platform_probe':
            sound/soc/sh/dma-sh7760.c:353:2: warning: passing argument 2 of 'snd_soc_register_platform' from incompatible pointer type
            include/sound/soc.h:368:5: note: expected 'struct snd_soc_platform_driver *' but argument is of type 'struct snd_soc_platform *'
    
    This is due the misnaming of the snd_soc_platform_driver type name and 'ops'
    field. The issue was introduced in commit f0fba2a("ASoC: multi-component - ASoC
    Multi-Component Support").
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 086dcdf923815cbf61911a2eec81d7a9c2606aa9
Author: Sascha Hauer <s.hauer@pengutronix.de>
Date:   Sun Mar 10 19:33:03 2013 +0100

    ASoC: imx-ssi: Fix occasional AC97 reset failure
    
    commit b6e51600f4e983e757b1b6942becaa1ae7d82e67 upstream.
    
    Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
    Signed-off-by: Markus Pargmann <mpa@pengutronix.de>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
