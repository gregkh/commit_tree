commit 25423f4bd9a9ac3e6b0ce7ecfe56c36f4e514893
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sun Jul 25 14:37:37 2021 +0200

    Linux 5.13.5
    
    Link: https://lore.kernel.org/r/20210722155628.371356843@linuxfoundation.org
    Tested-by: Jon Hunter <jonathanh@nvidia.com>
    Tested-by: Shuah Khan <skhan@linuxfoundation.org>
    Tested-by: Florian Fainelli <f.fainelli@gmail.com>
    Tested-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c50bcc85a057b98b117f58daf0b1960532d2cba2
Author: Aaron Ma <aaron.ma@canonical.com>
Date:   Thu Jul 8 21:17:10 2021 +0800

    mt76: mt7921: continue to probe driver when fw already downloaded
    
    commit c34269041185dad1bab7a34f42ef9fab967a1684 upstream.
    
    When reboot system, no power cycles, firmware is already downloaded,
    return -EIO will break driver as error:
    mt7921e: probe of 0000:03:00.0 failed with error -5
    
    Skip firmware download and continue to probe.
    
    Signed-off-by: Aaron Ma <aaron.ma@canonical.com>
    Fixes: 1c099ab44727c ("mt76: mt7921: add MCU support")
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c1b582a7e364b80d89a5b704c4ba98b46409c0f8
Author: Paolo Abeni <pabeni@redhat.com>
Date:   Sat Jul 3 00:38:43 2021 +0200

    udp: properly flush normal packet at GRO time
    
    commit b43c8909be52f2baca8884f967b418a88424494a upstream.
    
    If an UDP packet enters the GRO engine but is not eligible
    for aggregation and is not targeting an UDP tunnel,
    udp_gro_receive() will not set the flush bit, and packet
    could delayed till the next napi flush.
    
    Fix the issue ensuring non GROed packets traverse
    skb_gro_flush_final().
    
    Reported-and-tested-by: Matthias Treydte <mt@waldheinz.de>
    Fixes: 18f25dc39990 ("udp: skip L4 aggregation for UDP tunnel packets")
    Signed-off-by: Paolo Abeni <pabeni@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e3104dccdd79ef9671814ea8fc62987146b83c1b
Author: Eric Dumazet <edumazet@google.com>
Date:   Wed Jun 30 09:42:44 2021 -0700

    udp: annotate data races around unix_sk(sk)->gso_size
    
    commit 18a419bad63b7f68a1979e28459782518e7b6bbe upstream.
    
    Accesses to unix_sk(sk)->gso_size are lockless.
    Add READ_ONCE()/WRITE_ONCE() around them.
    
    BUG: KCSAN: data-race in udp_lib_setsockopt / udpv6_sendmsg
    
    write to 0xffff88812d78f47c of 2 bytes by task 10849 on cpu 1:
     udp_lib_setsockopt+0x3b3/0x710 net/ipv4/udp.c:2696
     udpv6_setsockopt+0x63/0x90 net/ipv6/udp.c:1630
     sock_common_setsockopt+0x5d/0x70 net/core/sock.c:3265
     __sys_setsockopt+0x18f/0x200 net/socket.c:2104
     __do_sys_setsockopt net/socket.c:2115 [inline]
     __se_sys_setsockopt net/socket.c:2112 [inline]
     __x64_sys_setsockopt+0x62/0x70 net/socket.c:2112
     do_syscall_64+0x4a/0x90 arch/x86/entry/common.c:47
     entry_SYSCALL_64_after_hwframe+0x44/0xae
    
    read to 0xffff88812d78f47c of 2 bytes by task 10852 on cpu 0:
     udpv6_sendmsg+0x161/0x16b0 net/ipv6/udp.c:1299
     inet6_sendmsg+0x5f/0x80 net/ipv6/af_inet6.c:642
     sock_sendmsg_nosec net/socket.c:654 [inline]
     sock_sendmsg net/socket.c:674 [inline]
     ____sys_sendmsg+0x360/0x4d0 net/socket.c:2337
     ___sys_sendmsg net/socket.c:2391 [inline]
     __sys_sendmmsg+0x315/0x4b0 net/socket.c:2477
     __do_sys_sendmmsg net/socket.c:2506 [inline]
     __se_sys_sendmmsg net/socket.c:2503 [inline]
     __x64_sys_sendmmsg+0x53/0x60 net/socket.c:2503
     do_syscall_64+0x4a/0x90 arch/x86/entry/common.c:47
     entry_SYSCALL_64_after_hwframe+0x44/0xae
    
    value changed: 0x0000 -> 0x0005
    
    Reported by Kernel Concurrency Sanitizer on:
    CPU: 0 PID: 10852 Comm: syz-executor.0 Not tainted 5.13.0-syzkaller #0
    Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
    
    Fixes: bec1f6f69736 ("udp: generate gso with UDP_SEGMENT")
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Cc: Willem de Bruijn <willemb@google.com>
    Reported-by: syzbot <syzkaller@googlegroups.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 010f5d09fa32b2c99b63afc501ab8096d65925a4
Author: Cristian Marussi <cristian.marussi@arm.com>
Date:   Mon Jun 28 18:00:42 2021 +0100

    firmware: arm_scmi: Avoid padding in sensor message structure
    
    commit 187a002b07e8089f0b5657eafec50b5d05625569 upstream.
    
    scmi_resp_sensor_reading_complete structure is meant to represent an
    SCMI asynchronous reading complete message. The readings field with
    a 64bit type forces padding and breaks reads in scmi_sensor_reading_get.
    
    Split it in two adjacent 32bit readings_low/high subfields to avoid the
    padding within the structure. Alternatively we could to mark the structure
    packed.
    
    Link: https://lore.kernel.org/r/20210628170042.34105-1-cristian.marussi@arm.com
    Fixes: e2083d3673916 ("firmware: arm_scmi: Add SCMI v3.0 sensors timestamped reads")
    Signed-off-by: Cristian Marussi <cristian.marussi@arm.com>
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 90ed7e5771ea21fa6d28e4d9f4adc6eb7432489a
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Fri Jun 4 01:18:30 2021 +0200

    drm/panel: nt35510: Do not fail if DSI read fails
    
    commit 1988e0d84161dabd99d1c27033fbd6ee439bf432 upstream.
    
    Failing to read the MTP over DSI should not bring down the
    system and make us bail out from using the display, it turns
    out that this happens when toggling the display off and on,
    and that write is often still working so the display output
    is just fine. Printing an error is enough.
    
    Tested by killing the Gnome session repeatedly on the
    Samsung Skomer.
    
    Fixes: 899f24ed8d3a ("drm/panel: Add driver for Novatek NT35510-based panels")
    Cc: Stephan Gerhold <stephan@gerhold.net>
    Reported-by: newbyte@disroot.org
    Acked-by: Stefan Hansson <newbyte@disroot.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210603231830.3200040-1-linus.walleij@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fcd280d92bad432b3d7b8674eb7385d02478d59d
Author: Riccardo Mancini <rickyman7@gmail.com>
Date:   Thu Jul 15 18:07:24 2021 +0200

    perf test bpf: Free obj_buf
    
    commit 937654ce497fb6e977a8c52baee5f7d9616302d9 upstream.
    
    ASan reports some memory leaks when running:
    
      # perf test "42: BPF filter"
    
    The first of these leaks is caused by obj_buf never being deallocated in
    __test__bpf.
    
    This patch adds the missing free.
    
    Signed-off-by: Riccardo Mancini <rickyman7@gmail.com>
    Fixes: ba1fae431e74bb42 ("perf test: Add 'perf test BPF'")
    Cc: Ian Rogers <irogers@google.com>
    Cc: Jiri Olsa <jolsa@redhat.com>
    Cc: Mark Rutland <mark.rutland@arm.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Wang Nan <wangnan0@huawei.com>
    Link: http://lore.kernel.org/lkml/60f3ca935fe6672e7e866276ce6264c9e26e4c87.1626343282.git.rickyman7@gmail.com
    [ Added missing stdlib.h include ]
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 599148d40366bd5d1d504a3a8fcd65e21107e500
Author: John Fastabend <john.fastabend@gmail.com>
Date:   Wed Jul 7 15:38:47 2021 -0700

    bpf: Track subprog poke descriptors correctly and fix use-after-free
    
    commit f263a81451c12da5a342d90572e317e611846f2c upstream.
    
    Subprograms are calling map_poke_track(), but on program release there is no
    hook to call map_poke_untrack(). However, on program release, the aux memory
    (and poke descriptor table) is freed even though we still have a reference to
    it in the element list of the map aux data. When we run map_poke_run(), we then
    end up accessing free'd memory, triggering KASAN in prog_array_map_poke_run():
    
      [...]
      [  402.824689] BUG: KASAN: use-after-free in prog_array_map_poke_run+0xc2/0x34e
      [  402.824698] Read of size 4 at addr ffff8881905a7940 by task hubble-fgs/4337
      [  402.824705] CPU: 1 PID: 4337 Comm: hubble-fgs Tainted: G          I       5.12.0+ #399
      [  402.824715] Call Trace:
      [  402.824719]  dump_stack+0x93/0xc2
      [  402.824727]  print_address_description.constprop.0+0x1a/0x140
      [  402.824736]  ? prog_array_map_poke_run+0xc2/0x34e
      [  402.824740]  ? prog_array_map_poke_run+0xc2/0x34e
      [  402.824744]  kasan_report.cold+0x7c/0xd8
      [  402.824752]  ? prog_array_map_poke_run+0xc2/0x34e
      [  402.824757]  prog_array_map_poke_run+0xc2/0x34e
      [  402.824765]  bpf_fd_array_map_update_elem+0x124/0x1a0
      [...]
    
    The elements concerned are walked as follows:
    
        for (i = 0; i < elem->aux->size_poke_tab; i++) {
               poke = &elem->aux->poke_tab[i];
        [...]
    
    The access to size_poke_tab is a 4 byte read, verified by checking offsets
    in the KASAN dump:
    
      [  402.825004] The buggy address belongs to the object at ffff8881905a7800
                     which belongs to the cache kmalloc-1k of size 1024
      [  402.825008] The buggy address is located 320 bytes inside of
                     1024-byte region [ffff8881905a7800, ffff8881905a7c00)
    
    The pahole output of bpf_prog_aux:
    
      struct bpf_prog_aux {
        [...]
        /* --- cacheline 5 boundary (320 bytes) --- */
        u32                        size_poke_tab;        /*   320     4 */
        [...]
    
    In general, subprograms do not necessarily manage their own data structures.
    For example, BTF func_info and linfo are just pointers to the main program
    structure. This allows reference counting and cleanup to be done on the latter
    which simplifies their management a bit. The aux->poke_tab struct, however,
    did not follow this logic. The initial proposed fix for this use-after-free
    bug further embedded poke data tracking into the subprogram with proper
    reference counting. However, Daniel and Alexei questioned why we were treating
    these objects special; I agree, its unnecessary. The fix here removes the per
    subprogram poke table allocation and map tracking and instead simply points
    the aux->poke_tab pointer at the main programs poke table. This way, map
    tracking is simplified to the main program and we do not need to manage them
    per subprogram.
    
    This also means, bpf_prog_free_deferred(), which unwinds the program reference
    counting and kfrees objects, needs to ensure that we don't try to double free
    the poke_tab when free'ing the subprog structures. This is easily solved by
    NULL'ing the poke_tab pointer. The second detail is to ensure that per
    subprogram JIT logic only does fixups on poke_tab[] entries it owns. To do
    this, we add a pointer in the poke structure to point at the subprogram value
    so JITs can easily check while walking the poke_tab structure if the current
    entry belongs to the current program. The aux pointer is stable and therefore
    suitable for such comparison. On the jit_subprogs() error path, we omit
    cleaning up the poke->aux field because these are only ever referenced from
    the JIT side, but on error we will never make it to the JIT, so its fine to
    leave them dangling. Removing these pointers would complicate the error path
    for no reason. However, we do need to untrack all poke descriptors from the
    main program as otherwise they could race with the freeing of JIT memory from
    the subprograms. Lastly, a748c6975dea3 ("bpf: propagate poke descriptors to
    subprograms") had an off-by-one on the subprogram instruction index range
    check as it was testing 'insn_idx >= subprog_start && insn_idx <= subprog_end'.
    However, subprog_end is the next subprogram's start instruction.
    
    Fixes: a748c6975dea3 ("bpf: propagate poke descriptors to subprograms")
    Signed-off-by: John Fastabend <john.fastabend@gmail.com>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>
    Co-developed-by: Daniel Borkmann <daniel@iogearbox.net>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Link: https://lore.kernel.org/bpf/20210707223848.14580-2-john.fastabend@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4edc469e4a6311824be2747d8a52f314ce2e9453
Author: Gu Shengxian <gushengxian@yulong.com>
Date:   Mon Jul 5 18:35:43 2021 -0700

    bpftool: Properly close va_list 'ap' by va_end() on error
    
    commit bc832065b60f973771ff3e657214bb21b559833c upstream.
    
    va_list 'ap' was opened but not closed by va_end() in error case. It should
    be closed by va_end() before the return.
    
    Fixes: aa52bcbe0e72 ("tools: bpftool: Fix json dump crash on powerpc")
    Signed-off-by: Gu Shengxian <gushengxian@yulong.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Jiri Olsa <jolsa@redhat.com>
    Link: https://lore.kernel.org/bpf/20210706013543.671114-1-gushengxian507419@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a3b4cb28a2e871be18b91985c81a539c2c5ed53e
Author: Wei Li <liwei391@huawei.com>
Date:   Mon Jun 28 11:04:09 2021 +0800

    tools: bpf: Fix error in 'make -C tools/ bpf_install'
    
    commit 1d719254c139fb62fb8056fb496b6fd007e71550 upstream.
    
    make[2]: *** No rule to make target 'install'.  Stop.
    make[1]: *** [Makefile:122: runqslower_install] Error 2
    make: *** [Makefile:116: bpf_install] Error 2
    
    There is no rule for target 'install' in tools/bpf/runqslower/Makefile,
    and there is no need to install it, so just remove 'runqslower_install'.
    
    Fixes: 9c01546d26d2 ("tools/bpf: Add runqslower tool to tools/bpf")
    Signed-off-by: Wei Li <liwei391@huawei.com>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Link: https://lore.kernel.org/bpf/20210628030409.3459095-1-liwei391@huawei.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e023c648a7646304b929d43f9b3bdc4431dd0093
Author: Talal Ahmad <talalahmad@google.com>
Date:   Fri Jul 9 11:43:06 2021 -0400

    tcp: call sk_wmem_schedule before sk_mem_charge in zerocopy path
    
    commit 358ed624207012f03318235017ac6fb41f8af592 upstream.
    
    sk_wmem_schedule makes sure that sk_forward_alloc has enough
    bytes for charging that is going to be done by sk_mem_charge.
    
    In the transmit zerocopy path, there is sk_mem_charge but there was
    no call to sk_wmem_schedule. This change adds that call.
    
    Without this call to sk_wmem_schedule, sk_forward_alloc can go
    negetive which is a bug because sk_forward_alloc is a per-socket
    space that has been forward charged so this can't be negative.
    
    Fixes: f214f915e7db ("tcp: enable MSG_ZEROCOPY")
    Signed-off-by: Talal Ahmad <talalahmad@google.com>
    Reviewed-by: Willem de Bruijn <willemb@google.com>
    Reviewed-by: Wei Wang <weiwan@google.com>
    Reviewed-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c0fea93d9f778d74b24ab324c8f9c2bffdcd35ee
Author: Eric Dumazet <edumazet@google.com>
Date:   Thu Jul 8 00:21:09 2021 -0700

    ipv6: tcp: drop silly ICMPv6 packet too big messages
    
    commit c7bb4b89033b764eb07db4e060548a6311d801ee upstream.
    
    While TCP stack scales reasonably well, there is still one part that
    can be used to DDOS it.
    
    IPv6 Packet too big messages have to lookup/insert a new route,
    and if abused by attackers, can easily put hosts under high stress,
    with many cpus contending on a spinlock while one is stuck in fib6_run_gc()
    
    ip6_protocol_deliver_rcu()
     icmpv6_rcv()
      icmpv6_notify()
       tcp_v6_err()
        tcp_v6_mtu_reduced()
         inet6_csk_update_pmtu()
          ip6_rt_update_pmtu()
           __ip6_rt_update_pmtu()
            ip6_rt_cache_alloc()
             ip6_dst_alloc()
              dst_alloc()
               ip6_dst_gc()
                fib6_run_gc()
                 spin_lock_bh() ...
    
    Some of our servers have been hit by malicious ICMPv6 packets
    trying to _increase_ the MTU/MSS of TCP flows.
    
    We believe these ICMPv6 packets are a result of a bug in one ISP stack,
    since they were blindly sent back for _every_ (small) packet sent to them.
    
    These packets are for one TCP flow:
    09:24:36.266491 IP6 Addr1 > Victim ICMP6, packet too big, mtu 1460, length 1240
    09:24:36.266509 IP6 Addr1 > Victim ICMP6, packet too big, mtu 1460, length 1240
    09:24:36.316688 IP6 Addr1 > Victim ICMP6, packet too big, mtu 1460, length 1240
    09:24:36.316704 IP6 Addr1 > Victim ICMP6, packet too big, mtu 1460, length 1240
    09:24:36.608151 IP6 Addr1 > Victim ICMP6, packet too big, mtu 1460, length 1240
    
    TCP stack can filter some silly requests :
    
    1) MTU below IPV6_MIN_MTU can be filtered early in tcp_v6_err()
    2) tcp_v6_mtu_reduced() can drop requests trying to increase current MSS.
    
    This tests happen before the IPv6 routing stack is entered, thus
    removing the potential contention and route exhaustion.
    
    Note that IPv6 stack was performing these checks, but too late
    (ie : after the route has been added, and after the potential
    garbage collect war)
    
    v2: fix typo caught by Martin, thanks !
    v3: exports tcp_mtu_to_mss(), caught by David, thanks !
    
    Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Reviewed-by: Maciej Żenczykowski <maze@google.com>
    Cc: Martin KaFai Lau <kafai@fb.com>
    Acked-by: Martin KaFai Lau <kafai@fb.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fe77b85828ca9ddc42977b79de9e40d18545b4fe
Author: Nguyen Dinh Phi <phind.uet@gmail.com>
Date:   Tue Jul 6 07:19:12 2021 +0800

    tcp: fix tcp_init_transfer() to not reset icsk_ca_initialized
    
    commit be5d1b61a2ad28c7e57fe8bfa277373e8ecffcdc upstream.
    
    This commit fixes a bug (found by syzkaller) that could cause spurious
    double-initializations for congestion control modules, which could cause
    memory leaks or other problems for congestion control modules (like CDG)
    that allocate memory in their init functions.
    
    The buggy scenario constructed by syzkaller was something like:
    
    (1) create a TCP socket
    (2) initiate a TFO connect via sendto()
    (3) while socket is in TCP_SYN_SENT, call setsockopt(TCP_CONGESTION),
        which calls:
           tcp_set_congestion_control() ->
             tcp_reinit_congestion_control() ->
               tcp_init_congestion_control()
    (4) receive ACK, connection is established, call tcp_init_transfer(),
        set icsk_ca_initialized=0 (without first calling cc->release()),
        call tcp_init_congestion_control() again.
    
    Note that in this sequence tcp_init_congestion_control() is called
    twice without a cc->release() call in between. Thus, for CC modules
    that allocate memory in their init() function, e.g, CDG, a memory leak
    may occur. The syzkaller tool managed to find a reproducer that
    triggered such a leak in CDG.
    
    The bug was introduced when that commit 8919a9b31eb4 ("tcp: Only init
    congestion control if not initialized already")
    introduced icsk_ca_initialized and set icsk_ca_initialized to 0 in
    tcp_init_transfer(), missing the possibility for a sequence like the
    one above, where a process could call setsockopt(TCP_CONGESTION) in
    state TCP_SYN_SENT (i.e. after the connect() or TFO open sendmsg()),
    which would call tcp_init_congestion_control(). It did not intend to
    reset any initialization that the user had already explicitly made;
    it just missed the possibility of that particular sequence (which
    syzkaller managed to find).
    
    Fixes: 8919a9b31eb4 ("tcp: Only init congestion control if not initialized already")
    Reported-by: syzbot+f1e24a0594d4e3a895d3@syzkaller.appspotmail.com
    Signed-off-by: Nguyen Dinh Phi <phind.uet@gmail.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Tested-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 341dd0904d4fb94ce9d42dcd4cce9b0bf0d4789b
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Jul 2 13:09:03 2021 -0700

    tcp: annotate data races around tp->mtu_info
    
    commit 561022acb1ce62e50f7a8258687a21b84282a4cb upstream.
    
    While tp->mtu_info is read while socket is owned, the write
    sides happen from err handlers (tcp_v[46]_mtu_reduced)
    which only own the socket spinlock.
    
    Fixes: 563d34d05786 ("tcp: dont drop MTU reduction indications")
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 108727841c25e0c8d4f5345850f54b736aae502e
Author: Paolo Abeni <pabeni@redhat.com>
Date:   Wed Jun 30 13:42:13 2021 +0200

    tcp: consistently disable header prediction for mptcp
    
    commit 71158bb1f2d2da61385c58fc1114e1a1c19984ba upstream.
    
    The MPTCP receive path is hooked only into the TCP slow-path.
    The DSS presence allows plain MPTCP traffic to hit that
    consistently.
    
    Since commit e1ff9e82e2ea ("net: mptcp: improve fallback to TCP"),
    when an MPTCP socket falls back to TCP, it can hit the TCP receive
    fast-path, and delay or stop triggering the event notification.
    
    Address the issue explicitly disabling the header prediction
    for MPTCP sockets.
    
    Closes: https://github.com/multipath-tcp/mptcp_net-next/issues/200
    Fixes: e1ff9e82e2ea ("net: mptcp: improve fallback to TCP")
    Signed-off-by: Paolo Abeni <pabeni@redhat.com>
    Reviewed-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ed8c953ef967916932a909cace296250f51f5edc
Author: Andrew Jeffery <andrew@aj.id.au>
Date:   Mon Jun 28 11:06:05 2021 +0930

    ARM: dts: everest: Add phase corrections for eMMC
    
    commit faffd1b2bde3ee428d6891961f6a60f8e08749d6 upstream.
    
    The values were determined experimentally via boot tests, not by
    measuring the bus behaviour with a scope. We plan to do scope
    measurements to confirm or refine the values and will update the
    devicetree if necessary once these have been obtained.
    
    However, with the patch we can write and read data without issue, where
    as booting the system without the patch failed at the point of mounting
    the rootfs.
    
    Signed-off-by: Andrew Jeffery <andrew@aj.id.au>
    Link: https://lore.kernel.org/r/20210628013605.1257346-1-andrew@aj.id.au
    Fixes: 2fc88f92359d ("mmc: sdhci-of-aspeed: Expose clock phase controls")
    Fixes: a5c5168478d7 ("ARM: dts: aspeed: Add Everest BMC machine")
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cc02a1bd5b7bb996f9c0b82bc5a26669ce8addc3
Author: Andrew Jeffery <andrew@aj.id.au>
Date:   Fri Jun 25 15:40:17 2021 +0930

    ARM: dts: tacoma: Add phase corrections for eMMC
    
    commit 2d6608b57c50c54c3e46649110e8ea5a40959c30 upstream.
    
    The degree values were reversed out from the magic tap values of 7 (in)
    and 15 + inversion (out) initially suggested by Aspeed.
    
    With the patch tacoma survives several gigabytes of reads and writes
    using dd while without it locks up randomly during the boot process.
    
    Signed-off-by: Andrew Jeffery <andrew@aj.id.au>
    Link: https://lore.kernel.org/r/20210625061017.1149942-1-andrew@aj.id.au
    Fixes: 2fc88f92359d ("mmc: sdhci-of-aspeed: Expose clock phase controls")
    Fixes: 961216c135a8 ("ARM: dts: aspeed: Add Rainier system")
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5cc4abeab14f0534a3dfcbbb9c43183efad0ac0f
Author: Joel Stanley <joel@jms.id.au>
Date:   Thu Jun 24 18:37:42 2021 +0930

    ARM: dts: aspeed: Fix AST2600 machines line names
    
    commit ca46ad2214473df1a6a9496be17156d65ba89b9f upstream.
    
    Tacoma and Rainier both have a line-names array that is too long:
    
     gpio gpiochip0: gpio-line-names is length 232 but should be at most length 208
    
    This was probably copied from an AST2500 device tree that did have more
    GPIOs on the controller.
    
    Fixes: e9b24b55ca4f ("ARM: dts: aspeed: rainier: Add gpio line names")
    Fixes: 2f68e4e7df67 ("ARM: dts: aspeed: tacoma: Add gpio line names")
    Link: https://lore.kernel.org/r/20210624090742.56640-1-joel@jms.id.au
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6f6f8f894a55a2bc7a618290494030c09dd97c92
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Thu Jan 21 12:54:18 2021 +0100

    vboxsf: Add support for the atomic_open directory-inode op
    
    commit 52dfd86aa568e433b24357bb5fc725560f1e22d8 upstream.
    
    Opening a new file is done in 2 steps on regular filesystems:
    
    1. Call the create inode-op on the parent-dir to create an inode
    to hold the meta-data related to the file.
    2. Call the open file-op to get a handle for the file.
    
    vboxsf however does not really use disk-backed inodes because it
    is based on passing through file-related system-calls through to
    the hypervisor. So both steps translate to an open(2) call being
    passed through to the hypervisor. With the handle returned by
    the first call immediately being closed again.
    
    Making 2 open calls for a single open(..., O_CREATE, ...) calls
    has 2 problems:
    
    a) It is not really efficient.
    b) It actually breaks some apps.
    
    An example of b) is doing a git clone inside a vboxsf mount.
    When git clone tries to create a tempfile to store the pak
    files which is downloading the following happens:
    
    1. vboxsf_dir_mkfile() gets called with a mode of 0444 and succeeds.
    2. vboxsf_file_open() gets called with file->f_flags containing
    O_RDWR. When the host is a Linux machine this fails because doing
    a open(..., O_RDWR) on a file which exists and has mode 0444 results
    in an -EPERM error.
    
    Other network-filesystems and fuse avoid the problem of needing to
    pass 2 open() calls to the other side by using the atomic_open
    directory-inode op.
    
    This commit fixes git clone not working inside a vboxsf mount,
    by adding support for the atomic_open directory-inode op.
    As an added bonus this should also make opening new files faster.
    
    The atomic_open implementation is modelled after the atomic_open
    implementations from the 9p and fuse code.
    
    Fixes: 0fd169576648 ("fs: Add VirtualBox guest shared folder (vboxsf) support")
    Reported-by: Ludovic Pouzenc <bugreports@pouzenc.fr>
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 53c4f60ed9dd5ca270bc00c7986498b52cbdb4d5
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Thu Jan 21 10:55:03 2021 +0100

    vboxsf: Add vboxsf_[create|release]_sf_handle() helpers
    
    commit 02f840f90764f22f5c898901849bdbf0cee752ba upstream.
    
    Factor out the code to create / release a struct vboxsf_handle into
    2 new helper functions.
    
    This is a preparation patch for adding atomic_open support.
    
    Fixes: 0fd169576648 ("fs: Add VirtualBox guest shared folder (vboxsf) support")
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6e64fd2f677f142dfa601119256a028c7d4cf1ff
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Thu Jan 21 10:22:27 2021 +0100

    vboxsf: Make vboxsf_dir_create() return the handle for the created file
    
    commit ab0c29687bc7a890d1a86ac376b0b0fd78b2d9b6 upstream.
    
    Make vboxsf_dir_create() optionally return the vboxsf-handle for
    the created file. This is a preparation patch for adding atomic_open
    support.
    
    Fixes: 0fd169576648 ("fs: Add VirtualBox guest shared folder (vboxsf) support")
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1f7cdb5def524aafcf0ab2e0f4cf0481b2ba9cc3
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Thu Jan 21 10:08:59 2021 +0100

    vboxsf: Honor excl flag to the dir-inode create op
    
    commit cc3ddee97cff034cea4d095de4a484c92a219bf5 upstream.
    
    Honor the excl flag to the dir-inode create op, instead of behaving
    as if it is always set.
    
    Note the old behavior still worked most of the time since a non-exclusive
    open only calls the create op, if there is a race and the file is created
    between the dentry lookup and the calling of the create call.
    
    While at it change the type of the is_dir parameter to the
    vboxsf_dir_create() helper from an int to a bool, to be consistent with
    the use of bool for the excl parameter.
    
    Fixes: 0fd169576648 ("fs: Add VirtualBox guest shared folder (vboxsf) support")
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 753b33d387ec7e3831c5d189a7fd2e8db65c4d50
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Jul 14 13:23:49 2021 +0900

    kbuild: do not suppress Kconfig prompts for silent build
    
    commit d952cfaf0cffdbbb0433c67206b645131f17ca5f upstream.
    
    When a new CONFIG option is available, Kbuild shows a prompt to get
    the user input.
    
      $ make
      [ snip ]
      Core Scheduling for SMT (SCHED_CORE) [N/y/?] (NEW)
    
    This is the only interactive place in the build process.
    
    Commit 174a1dcc9642 ("kbuild: sink stdout from cmd for silent build")
    suppressed Kconfig prompts as well because syncconfig is invoked by
    the 'cmd' macro. You cannot notice the fact that Kconfig is waiting
    for the user input.
    
    Use 'kecho' to show the equivalent short log without suppressing stdout
    from sub-make.
    
    Fixes: 174a1dcc9642 ("kbuild: sink stdout from cmd for silent build")
    Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Tested-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 19edcd97727aae9362444a859a24d99a8730cb27
Author: Jason Ekstrand <jason@jlekstrand.net>
Date:   Thu Jun 24 12:47:32 2021 -0500

    dma-buf/sync_file: Don't leak fences on merge failure
    
    commit ffe000217c5068c5da07ccb1c0f8cce7ad767435 upstream.
    
    Each add_fence() call does a dma_fence_get() on the relevant fence.  In
    the error path, we weren't calling dma_fence_put() so all those fences
    got leaked.  Also, in the krealloc_array failure case, we weren't
    freeing the fences array.  Instead, ensure that i and fences are always
    zero-initialized and dma_fence_put() all the fences and kfree(fences) on
    every error path.
    
    Signed-off-by: Jason Ekstrand <jason@jlekstrand.net>
    Reviewed-by: Christian König <christian.koenig@amd.com>
    Fixes: a02b9dc90d84 ("dma-buf/sync_file: refactor fence storage in struct sync_file")
    Cc: Gustavo Padovan <gustavo.padovan@collabora.co.uk>
    Cc: Christian König <christian.koenig@amd.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210624174732.1754546-1-jason@jlekstrand.net
    Signed-off-by: Christian König <christian.koenig@amd.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bdfbb51f7a437ae8ea91317a5c133ec13adf3c47
Author: Pavel Skripkin <paskripkin@gmail.com>
Date:   Tue Jul 13 13:58:53 2021 +0300

    net: fddi: fix UAF in fza_probe
    
    commit deb7178eb940e2c5caca1b1db084a69b2e59b4c9 upstream.
    
    fp is netdev private data and it cannot be
    used after free_netdev() call. Using fp after free_netdev()
    can cause UAF bug. Fix it by moving free_netdev() after error message.
    
    Fixes: 61414f5ec983 ("FDDI: defza: Add support for DEC FDDIcontroller 700
    TURBOchannel adapter")
    Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d7243e2ab1c6c3d5dfc7a583c336ada2b6c9dcaf
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Tue Jul 13 12:40:21 2021 +0300

    net: dsa: properly check for the bridge_leave methods in dsa_switch_bridge_leave()
    
    commit bcb9928a155444dbd212473e60241ca0a7f641e1 upstream.
    
    This was not caught because there is no switch driver which implements
    the .port_bridge_join but not .port_bridge_leave method, but it should
    nonetheless be fixed, as in certain conditions (driver development) it
    might lead to NULL pointer dereference.
    
    Fixes: f66a6a69f97a ("net: dsa: permit cross-chip bridging between all trees in the system")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a915379594f1e045421635c6316d8f3ffa018c58
Author: Taehee Yoo <ap420073@gmail.com>
Date:   Fri Jul 9 17:35:18 2021 +0000

    net: validate lwtstate->data before returning from skb_tunnel_info()
    
    commit 67a9c94317402b826fc3db32afc8f39336803d97 upstream.
    
    skb_tunnel_info() returns pointer of lwtstate->data as ip_tunnel_info
    type without validation. lwtstate->data can have various types such as
    mpls_iptunnel_encap, etc and these are not compatible.
    So skb_tunnel_info() should validate before returning that pointer.
    
    Splat looks like:
    BUG: KASAN: slab-out-of-bounds in vxlan_get_route+0x418/0x4b0 [vxlan]
    Read of size 2 at addr ffff888106ec2698 by task ping/811
    
    CPU: 1 PID: 811 Comm: ping Not tainted 5.13.0+ #1195
    Call Trace:
     dump_stack_lvl+0x56/0x7b
     print_address_description.constprop.8.cold.13+0x13/0x2ee
     ? vxlan_get_route+0x418/0x4b0 [vxlan]
     ? vxlan_get_route+0x418/0x4b0 [vxlan]
     kasan_report.cold.14+0x83/0xdf
     ? vxlan_get_route+0x418/0x4b0 [vxlan]
     vxlan_get_route+0x418/0x4b0 [vxlan]
     [ ... ]
     vxlan_xmit_one+0x148b/0x32b0 [vxlan]
     [ ... ]
     vxlan_xmit+0x25c5/0x4780 [vxlan]
     [ ... ]
     dev_hard_start_xmit+0x1ae/0x6e0
     __dev_queue_xmit+0x1f39/0x31a0
     [ ... ]
     neigh_xmit+0x2f9/0x940
     mpls_xmit+0x911/0x1600 [mpls_iptunnel]
     lwtunnel_xmit+0x18f/0x450
     ip_finish_output2+0x867/0x2040
     [ ... ]
    
    Fixes: 61adedf3e3f1 ("route: move lwtunnel state to dst_entry")
    Signed-off-by: Taehee Yoo <ap420073@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 12917871d234a5bcdf2b554dd9ef4cbcc272f121
Author: Antoine Tenart <atenart@kernel.org>
Date:   Fri Jul 9 18:16:09 2021 +0200

    net: do not reuse skbuff allocated from skbuff_fclone_cache in the skb cache
    
    commit 28b34f01a73435a754956ebae826e728c03ffa38 upstream.
    
    Some socket buffers allocated in the fclone cache (in __alloc_skb) can
    end-up in the following path[1]:
    
    napi_skb_finish
      __kfree_skb_defer
        napi_skb_cache_put
    
    The issue is napi_skb_cache_put is not fclone friendly and will put
    those skbuff in the skb cache to be reused later, although this cache
    only expects skbuff allocated from skbuff_head_cache. When this happens
    the skbuff is eventually freed using the wrong origin cache, and we can
    see traces similar to:
    
    [ 1223.947534] cache_from_obj: Wrong slab cache. skbuff_head_cache but object is from skbuff_fclone_cache
    [ 1223.948895] WARNING: CPU: 3 PID: 0 at mm/slab.h:442 kmem_cache_free+0x251/0x3e0
    [ 1223.950211] Modules linked in:
    [ 1223.950680] CPU: 3 PID: 0 Comm: swapper/3 Not tainted 5.13.0+ #474
    [ 1223.951587] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-3.fc34 04/01/2014
    [ 1223.953060] RIP: 0010:kmem_cache_free+0x251/0x3e0
    
    Leading sometimes to other memory related issues.
    
    Fix this by using __kfree_skb for fclone skbuff, similar to what is done
    the other place __kfree_skb_defer is called.
    
    [1] At least in setups using veth pairs and tunnels. Building a kernel
        with KASAN we can for example see packets allocated in
        sk_stream_alloc_skb hit the above path and later the issue arises
        when the skbuff is reused.
    
    Fixes: 9243adfc311a ("skbuff: queue NAPI_MERGED_FREE skbs into NAPI cache instead of freeing")
    Cc: Alexander Lobakin <alobakin@pm.me>
    Signed-off-by: Antoine Tenart <atenart@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d731dcbcefd23a01713df91523e1bcaf52ac1852
Author: Alexander Ovechkin <ovov@yandex-team.ru>
Date:   Fri Jul 9 18:28:23 2021 +0300

    net: send SYNACK packet with accepted fwmark
    
    commit 43b90bfad34bcb81b8a5bc7dc650800f4be1787e upstream.
    
    commit e05a90ec9e16 ("net: reflect mark on tcp syn ack packets")
    fixed IPv4 only.
    
    This part is for the IPv6 side.
    
    Fixes: e05a90ec9e16 ("net: reflect mark on tcp syn ack packets")
    Signed-off-by: Alexander Ovechkin <ovov@yandex-team.ru>
    Acked-by: Dmitry Yakunin <zeil@yandex-team.ru>
    Reviewed-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 93efab0ef2a607fff9166d447c4035f98b5db342
Author: Pavel Skripkin <paskripkin@gmail.com>
Date:   Fri Jul 9 17:58:29 2021 +0300

    net: ti: fix UAF in tlan_remove_one
    
    commit 0336f8ffece62f882ab3012820965a786a983f70 upstream.
    
    priv is netdev private data and it cannot be
    used after free_netdev() call. Using priv after free_netdev()
    can cause UAF bug. Fix it by moving free_netdev() at the end of the
    function.
    
    Fixes: 1e0a8b13d355 ("tlan: cancel work at remove path")
    Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8a225a6e07a57a1538d53637cb3d82bd3e477839
Author: Pavel Skripkin <paskripkin@gmail.com>
Date:   Fri Jul 9 17:24:18 2021 +0300

    net: qcom/emac: fix UAF in emac_remove
    
    commit ad297cd2db8953e2202970e9504cab247b6c7cb4 upstream.
    
    adpt is netdev private data and it cannot be
    used after free_netdev() call. Using adpt after free_netdev()
    can cause UAF bug. Fix it by moving free_netdev() at the end of the
    function.
    
    Fixes: 54e19bc74f33 ("net: qcom/emac: do not use devm on internal phy pdev")
    Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit aa92c87dc2d8c65dd36c3cdb9105fd14c6b41720
Author: Pavel Skripkin <paskripkin@gmail.com>
Date:   Fri Jul 9 17:09:53 2021 +0300

    net: moxa: fix UAF in moxart_mac_probe
    
    commit c78eaeebe855fd93f2e77142ffd0404a54070d84 upstream.
    
    In case of netdev registration failure the code path will
    jump to init_fail label:
    
    init_fail:
            netdev_err(ndev, "init failed\n");
            moxart_mac_free_memory(ndev);
    irq_map_fail:
            free_netdev(ndev);
            return ret;
    
    So, there is no need to call free_netdev() before jumping
    to error handling path, since it can cause UAF or double-free
    bug.
    
    Fixes: 6c821bd9edc9 ("net: Add MOXA ART SoCs ethernet driver")
    Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit db3177b7ff0e969ced0f2f942de25fd61b8417fe
Author: Hangbin Liu <liuhangbin@gmail.com>
Date:   Fri Jul 9 11:45:02 2021 +0800

    net: ip_tunnel: fix mtu calculation for ETHER tunnel devices
    
    commit 9992a078b1771da354ac1f9737e1e639b687caa2 upstream.
    
    Commit 28e104d00281 ("net: ip_tunnel: fix mtu calculation") removed
    dev->hard_header_len subtraction when calculate MTU for tunnel devices
    as there is an overhead for device that has header_ops.
    
    But there are ETHER tunnel devices, like gre_tap or erspan, which don't
    have header_ops but set dev->hard_header_len during setup. This makes
    pkts greater than (MTU - ETH_HLEN) could not be xmited. Fix it by
    subtracting the ETHER tunnel devices' dev->hard_header_len for MTU
    calculation.
    
    Fixes: 28e104d00281 ("net: ip_tunnel: fix mtu calculation")
    Reported-by: Jianlin Shi <jishi@redhat.com>
    Signed-off-by: Hangbin Liu <liuhangbin@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 02906fda9e7fcc81d8318bb70e7fb2c49f43fbad
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Jul 8 18:55:32 2021 -0700

    net: bcmgenet: Ensure all TX/RX queues DMAs are disabled
    
    commit 2b452550a203d88112eaf0ba9fc4b750a000b496 upstream.
    
    Make sure that we disable each of the TX and RX queues in the TDMA and
    RDMA control registers. This is a correctness change to be symmetrical
    with the code that enables the TX and RX queues.
    
    Tested-by: Maxime Ripard <maxime@cerno.tech>
    Fixes: 1c1008c793fa ("net: bcmgenet: add main driver file")
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fd51ccd9c97131888683d4c74c82b7e139c9fd66
Author: Taehee Yoo <ap420073@gmail.com>
Date:   Mon Jul 5 15:38:08 2021 +0000

    net: netdevsim: use xso.real_dev instead of xso.dev in callback functions of struct xfrmdev_ops
    
    commit 09adf7566d436322ced595b166dea48b06852efe upstream.
    
    There are two pointers in struct xfrm_state_offload, *dev, *real_dev.
    These are used in callback functions of struct xfrmdev_ops.
    The *dev points whether bonding interface or real interface.
    If bonding ipsec offload is used, it points bonding interface If not,
    it points real interface.
    And real_dev always points real interface.
    So, netdevsim should always use real_dev instead of dev.
    Of course, real_dev always not be null.
    
    Test commands:
        ip netns add A
        ip netns exec A bash
        modprobe netdevsim
        echo "1 1" > /sys/bus/netdevsim/new_device
        ip link add bond0 type bond mode active-backup
        ip link set eth0 master bond0
        ip link set eth0 up
        ip link set bond0 up
        ip x s add proto esp dst 14.1.1.1 src 15.1.1.1 spi 0x07 mode \
    transport reqid 0x07 replay-window 32 aead 'rfc4106(gcm(aes))' \
    0x44434241343332312423222114131211f4f3f2f1 128 sel src 14.0.0.52/24 \
    dst 14.0.0.70/24 proto tcp offload dev bond0 dir in
    
    Splat looks like:
    BUG: spinlock bad magic on CPU#5, kworker/5:1/53
     lock: 0xffff8881068c2cc8, .magic: 11121314, .owner: <none>/-1,
    .owner_cpu: -235736076
    CPU: 5 PID: 53 Comm: kworker/5:1 Not tainted 5.13.0-rc3+ #1168
    Workqueue: events linkwatch_event
    Call Trace:
     dump_stack+0xa4/0xe5
     do_raw_spin_lock+0x20b/0x270
     ? rwlock_bug.part.1+0x90/0x90
     _raw_spin_lock_nested+0x5f/0x70
     bond_get_stats+0xe4/0x4c0 [bonding]
     ? rcu_read_lock_sched_held+0xc0/0xc0
     ? bond_neigh_init+0x2c0/0x2c0 [bonding]
     ? dev_get_alias+0xe2/0x190
     ? dev_get_port_parent_id+0x14a/0x360
     ? rtnl_unregister+0x190/0x190
     ? dev_get_phys_port_name+0xa0/0xa0
     ? memset+0x1f/0x40
     ? memcpy+0x38/0x60
     ? rtnl_phys_switch_id_fill+0x91/0x100
     dev_get_stats+0x8c/0x270
     rtnl_fill_stats+0x44/0xbe0
     ? nla_put+0xbe/0x140
     rtnl_fill_ifinfo+0x1054/0x3ad0
    [ ... ]
    
    Fixes: 272c2330adc9 ("xfrm: bail early on slave pass over skb")
    Signed-off-by: Taehee Yoo <ap420073@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c5e07e8c8ec87f09e2bb6718daa05a78a58eb23d
Author: Lorenzo Bianconi <lorenzo@kernel.org>
Date:   Sat Jul 3 21:17:27 2021 +0200

    net: marvell: always set skb_shared_info in mvneta_swbm_add_rx_fragment
    
    commit 6ff63a150b5556012589ae59efac1b5eeb7d32c3 upstream.
    
    Always set skb_shared_info data structure in mvneta_swbm_add_rx_fragment
    routine even if the fragment contains only the ethernet FCS.
    
    Fixes: 039fbc47f9f1 ("net: mvneta: alloc skb_shared_info on the mvneta_rx_swbm stack")
    Signed-off-by: Lorenzo Bianconi <lorenzo@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3863428b04be93cb7163cc34c9d9478acf808ae9
Author: Wolfgang Bumiller <w.bumiller@proxmox.com>
Date:   Fri Jul 2 14:07:36 2021 +0200

    net: bridge: sync fdb to new unicast-filtering ports
    
    commit a019abd8022061b917da767cd1a66ed823724eab upstream.
    
    Since commit 2796d0c648c9 ("bridge: Automatically manage
    port promiscuous mode.")
    bridges with `vlan_filtering 1` and only 1 auto-port don't
    set IFF_PROMISC for unicast-filtering-capable ports.
    
    Normally on port changes `br_manage_promisc` is called to
    update the promisc flags and unicast filters if necessary,
    but it cannot distinguish between *new* ports and ones
    losing their promisc flag, and new ports end up not
    receiving the MAC address list.
    
    Fix this by calling `br_fdb_sync_static` in `br_add_if`
    after the port promisc flags are updated and the unicast
    filter was supposed to have been filled.
    
    Fixes: 2796d0c648c9 ("bridge: Automatically manage port promiscuous mode.")
    Signed-off-by: Wolfgang Bumiller <w.bumiller@proxmox.com>
    Acked-by: Nikolay Aleksandrov <nikolay@nvidia.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fda8adcbbc70136547b10f373481dce0afbbb76b
Author: Louis Peens <louis.peens@corigine.com>
Date:   Fri Jul 2 11:21:38 2021 +0200

    net/sched: act_ct: remove and free nf_table callbacks
    
    commit 77ac5e40c44eb78333fbc38482d61fc2af7dda0a upstream.
    
    When cleaning up the nf_table in tcf_ct_flow_table_cleanup_work
    there is no guarantee that the callback list, added to by
    nf_flow_table_offload_add_cb, is empty. This means that it is
    possible that the flow_block_cb memory allocated will be lost.
    
    Fix this by iterating the list and freeing the flow_block_cb entries
    before freeing the nf_table entry (via freeing ct_ft).
    
    Fixes: 978703f42549 ("netfilter: flowtable: Add API for registering to flow table events")
    Signed-off-by: Louis Peens <louis.peens@corigine.com>
    Signed-off-by: Yinjun Zhang <yinjun.zhang@corigine.com>
    Signed-off-by: Simon Horman <simon.horman@corigine.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c3eb534eae09de6cdd3e0ff63897b20e1b079cdb
Author: Ronak Doshi <doshir@vmware.com>
Date:   Thu Jul 1 23:44:27 2021 -0700

    vmxnet3: fix cksum offload issues for tunnels with non-default udp ports
    
    commit b22580233d473dbf7bbfa4f6549c09e2c80e9e64 upstream.
    
    Commit dacce2be3312 ("vmxnet3: add geneve and vxlan tunnel offload
    support") added support for encapsulation offload. However, the inner
    offload capability is to be restricted to UDP tunnels with default
    Vxlan and Geneve ports.
    
    This patch fixes the issue for tunnels with non-default ports using
    features check capability and filtering appropriate features for such
    tunnels.
    
    Fixes: dacce2be3312 ("vmxnet3: add geneve and vxlan tunnel offload support")
    Signed-off-by: Ronak Doshi <doshir@vmware.com>
    Acked-by: Guolin Yang <gyang@vmware.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 70a5a1950cca02c5cd161bb3846b4d983eed97d3
Author: Colin Ian King <colin.king@canonical.com>
Date:   Thu Jun 24 20:57:18 2021 +0100

    netfilter: nf_tables: Fix dereference of null pointer flow
    
    commit 4ca041f919f13783b0b03894783deee00dbca19a upstream.
    
    In the case where chain->flags & NFT_CHAIN_HW_OFFLOAD is false then
    nft_flow_rule_create is not called and flow is NULL. The subsequent
    error handling execution via label err_destroy_flow_rule will lead
    to a null pointer dereference on flow when calling nft_flow_rule_destroy.
    Since the error path to err_destroy_flow_rule has to cater for null
    and non-null flows, only call nft_flow_rule_destroy if flow is non-null
    to fix this issue.
    
    Addresses-Coverity: ("Explicity null dereference")
    Fixes: 3c5e44622011 ("netfilter: nf_tables: memleak in hw offload abort path")
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c6eb7ce9f11c955ea29302dbd107cc4c6c544b45
Author: wenxu <wenxu@ucloud.cn>
Date:   Fri Jul 2 11:34:31 2021 +0800

    net/sched: act_ct: fix err check for nf_conntrack_confirm
    
    commit 8955b90c3cdad199137809aac8ccbbb585355913 upstream.
    
    The confirm operation should be checked. If there are any failed,
    the packet should be dropped like in ovs and netfilter.
    
    Fixes: b57dc7c13ea9 ("net/sched: Introduce action ct")
    Signed-off-by: wenxu <wenxu@ucloud.cn>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a598091fc909b26c8d72cfaa6f90da1b2c1a1858
Author: Vasily Averin <vvs@virtuozzo.com>
Date:   Thu Jul 1 08:02:49 2021 +0300

    netfilter: ctnetlink: suspicious RCU usage in ctnetlink_dump_helpinfo
    
    commit c23a9fd209bc6f8c1fa6ee303fdf037d784a1627 upstream.
    
    Two patches listed below removed ctnetlink_dump_helpinfo call from under
    rcu_read_lock. Now its rcu_dereference generates following warning:
    =============================
    WARNING: suspicious RCU usage
    5.13.0+ #5 Not tainted
    -----------------------------
    net/netfilter/nf_conntrack_netlink.c:221 suspicious rcu_dereference_check() usage!
    
    other info that might help us debug this:
    rcu_scheduler_active = 2, debug_locks = 1
    stack backtrace:
    CPU: 1 PID: 2251 Comm: conntrack Not tainted 5.13.0+ #5
    Call Trace:
     dump_stack+0x7f/0xa1
     ctnetlink_dump_helpinfo+0x134/0x150 [nf_conntrack_netlink]
     ctnetlink_fill_info+0x2c2/0x390 [nf_conntrack_netlink]
     ctnetlink_dump_table+0x13f/0x370 [nf_conntrack_netlink]
     netlink_dump+0x10c/0x370
     __netlink_dump_start+0x1a7/0x260
     ctnetlink_get_conntrack+0x1e5/0x250 [nf_conntrack_netlink]
     nfnetlink_rcv_msg+0x613/0x993 [nfnetlink]
     netlink_rcv_skb+0x50/0x100
     nfnetlink_rcv+0x55/0x120 [nfnetlink]
     netlink_unicast+0x181/0x260
     netlink_sendmsg+0x23f/0x460
     sock_sendmsg+0x5b/0x60
     __sys_sendto+0xf1/0x160
     __x64_sys_sendto+0x24/0x30
     do_syscall_64+0x36/0x70
     entry_SYSCALL_64_after_hwframe+0x44/0xae
    
    Fixes: 49ca022bccc5 ("netfilter: ctnetlink: don't dump ct extensions of unconfirmed conntracks")
    Fixes: 0b35f6031a00 ("netfilter: Remove duplicated rcu_read_lock.")
    Signed-off-by: Vasily Averin <vvs@virtuozzo.com>
    Reviewed-by: Florian Westphal <fw@strlen.de>
    Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f6eaa0620312d9f0619229d86d53130313a00494
Author: Vadim Fedorenko <vfedorenko@novek.ru>
Date:   Fri Jul 2 02:47:00 2021 +0300

    net: ipv6: fix return value of ip6_skb_dst_mtu
    
    commit 40fc3054b45820c28ea3c65e2c86d041dc244a8a upstream.
    
    Commit 628a5c561890 ("[INET]: Add IP(V6)_PMTUDISC_RPOBE") introduced
    ip6_skb_dst_mtu with return value of signed int which is inconsistent
    with actually returned values. Also 2 users of this function actually
    assign its value to unsigned int variable and only __xfrm6_output
    assigns result of this function to signed variable but actually uses
    as unsigned in further comparisons and calls. Change this function
    to return unsigned int value.
    
    Fixes: 628a5c561890 ("[INET]: Add IP(V6)_PMTUDISC_RPOBE")
    Reviewed-by: David Ahern <dsahern@kernel.org>
    Signed-off-by: Vadim Fedorenko <vfedorenko@novek.ru>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 231ea21690249761950cc546d3fa06a32957410a
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:31 2021 +0200

    net: dsa: mv88e6xxx: enable SerDes PCS register dump via ethtool -d on Topaz
    
    commit 953b0dcbe2e3f7bee98cc3bca2ec82c8298e9c16 upstream.
    
    Commit bf3504cea7d7e ("net: dsa: mv88e6xxx: Add 6390 family PCS
    registers to ethtool -d") added support for dumping SerDes PCS registers
    via ethtool -d for Peridot.
    
    The same implementation is also valid for Topaz, but was not
    enabled at the time.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: bf3504cea7d7e ("net: dsa: mv88e6xxx: Add 6390 family PCS registers to ethtool -d")
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c57e63264dfb31ae17f74bd551a25a081c6a8cf0
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:30 2021 +0200

    net: dsa: mv88e6xxx: enable SerDes RX stats for Topaz
    
    commit a03b98d68367b18e5db6d6850e2cc18754fba94a upstream.
    
    Commit 0df952873636a ("mv88e6xxx: Add serdes Rx statistics") added
    support for RX statistics on SerDes ports for Peridot.
    
    This same implementation is also valid for Topaz, but was not enabled
    at the time.
    
    We need to use the generic .serdes_get_lane() method instead of the
    Peridot specific one in the stats methods so that on Topaz the proper
    one is used.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: 0df952873636a ("mv88e6xxx: Add serdes Rx statistics")
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8eef55a596209d6ac08de98ec0aafb87587740da
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:29 2021 +0200

    net: dsa: mv88e6xxx: enable devlink ATU hash param for Topaz
    
    commit c07fff3492acae41cedbabea395b644dd5872b8c upstream.
    
    Commit 23e8b470c7788 ("net: dsa: mv88e6xxx: Add devlink param for ATU
    hash algorithm.") introduced ATU hash algorithm access via devlink, but
    did not enable it for Topaz.
    
    Enable this feature also for Topaz.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: 23e8b470c7788 ("net: dsa: mv88e6xxx: Add devlink param for ATU hash algorithm.")
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0104c68efb3e1e777021baa9494635b092c92e4c
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:28 2021 +0200

    net: dsa: mv88e6xxx: enable .rmu_disable() on Topaz
    
    commit 3709488790022c85720f991bff50d48ed5a36e6a upstream.
    
    Commit 9e5baf9b36367 ("net: dsa: mv88e6xxx: add RMU disable op")
    introduced .rmu_disable() method with implementation for several models,
    but forgot to add Topaz, which can use the Peridot implementation.
    
    Use the Peridot implementation of .rmu_disable() on Topaz.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: 9e5baf9b36367 ("net: dsa: mv88e6xxx: add RMU disable op")
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8263e5c08f4651665c85dbb7a7f80ff0facee124
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:27 2021 +0200

    net: dsa: mv88e6xxx: use correct .stats_set_histogram() on Topaz
    
    commit 11527f3c4725640e6c40a2b7654e303f45e82a6c upstream.
    
    Commit 40cff8fca9e3 ("net: dsa: mv88e6xxx: Fix stats histogram mode")
    introduced wrong .stats_set_histogram() method for Topaz family.
    
    The Peridot method should be used instead.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: 40cff8fca9e3 ("net: dsa: mv88e6xxx: Fix stats histogram mode")
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 36d57bbdf93fe4430178ca5c35957e2c5fe8f6da
Author: Marek Behún <kabel@kernel.org>
Date:   Thu Jul 1 00:22:26 2021 +0200

    net: dsa: mv88e6xxx: enable .port_set_policy() on Topaz
    
    commit 7da467d82d1ed4fb317aff836f99709169e73f10 upstream.
    
    Commit f3a2cd326e44 ("net: dsa: mv88e6xxx: introduce .port_set_policy")
    introduced .port_set_policy() method with implementation for several
    models, but forgot to add Topaz, which can use the 6352 implementation.
    
    Use the 6352 implementation of .port_set_policy() on Topaz.
    
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Fixes: f3a2cd326e44 ("net: dsa: mv88e6xxx: introduce .port_set_policy")
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c74ded51a37f4e393998ce87901e649c5888abe0
Author: Doug Berger <opendmb@gmail.com>
Date:   Tue Jun 29 17:14:19 2021 -0700

    net: bcmgenet: ensure EXT_ENERGY_DET_MASK is clear
    
    commit 5a3c680aa2c12c90c44af383fe6882a39875ab81 upstream.
    
    Setting the EXT_ENERGY_DET_MASK bit allows the port energy detection
    logic of the internal PHY to prevent the system from sleeping. Some
    internal PHYs will report that energy is detected when the network
    interface is closed which can prevent the system from going to sleep
    if WoL is enabled when the interface is brought down.
    
    Since the driver does not support waking the system on this logic,
    this commit clears the bit whenever the internal PHY is powered up
    and the other logic for manipulating the bit is removed since it
    serves no useful function.
    
    Fixes: 1c1008c793fa ("net: bcmgenet: add main driver file")
    Signed-off-by: Doug Berger <opendmb@gmail.com>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8c4f51b15196ff3a95fd872906ad1b1055386906
Author: Daniel Rosenberg <drosen@google.com>
Date:   Thu Jun 3 09:50:37 2021 +0000

    f2fs: Show casefolding support only when supported
    
    commit 39307f8ee3539478c28e71b4909b5b028cce14b1 upstream.
    
    The casefolding feature is only supported when CONFIG_UNICODE is set.
    This modifies the feature list f2fs presents under sysfs accordingly.
    
    Fixes: 5aba54302a46 ("f2fs: include charset encoding information in the superblock")
    Cc: stable@vger.kernel.org # v5.4+
    Signed-off-by: Daniel Rosenberg <drosen@google.com>
    Reviewed-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Chao Yu <yuchao0@huawei.com>
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ac17145560031d7e1684c49039ad43a2aaf76343
Author: Peter Xu <peterx@redhat.com>
Date:   Wed Jun 30 18:49:02 2021 -0700

    mm/userfaultfd: fix uffd-wp special cases for fork()
    
    commit 8f34f1eac3820fc2722e5159acceb22545b30b0d upstream.
    
    We tried to do something similar in b569a1760782 ("userfaultfd: wp: drop
    _PAGE_UFFD_WP properly when fork") previously, but it's not doing it all
    right..  A few fixes around the code path:
    
    1. We were referencing VM_UFFD_WP vm_flags on the _old_ vma rather
       than the new vma.  That's overlooked in b569a1760782, so it won't work
       as expected.  Thanks to the recent rework on fork code
       (7a4830c380f3a8b3), we can easily get the new vma now, so switch the
       checks to that.
    
    2. Dropping the uffd-wp bit in copy_huge_pmd() could be wrong if the
       huge pmd is a migration huge pmd.  When it happens, instead of using
       pmd_uffd_wp(), we should use pmd_swp_uffd_wp().  The fix is simply to
       handle them separately.
    
    3. Forget to carry over uffd-wp bit for a write migration huge pmd
       entry.  This also happens in copy_huge_pmd(), where we converted a
       write huge migration entry into a read one.
    
    4. In copy_nonpresent_pte(), drop uffd-wp if necessary for swap ptes.
    
    5. In copy_present_page() when COW is enforced when fork(), we also
       need to pass over the uffd-wp bit if VM_UFFD_WP is armed on the new
       vma, and when the pte to be copied has uffd-wp bit set.
    
    Remove the comment in copy_present_pte() about this.  It won't help a huge
    lot to only comment there, but comment everywhere would be an overkill.
    Let's assume the commit messages would help.
    
    [peterx@redhat.com: fix a few thp pmd missing uffd-wp bit]
      Link: https://lkml.kernel.org/r/20210428225030.9708-4-peterx@redhat.com
    
    Link: https://lkml.kernel.org/r/20210428225030.9708-3-peterx@redhat.com
    Fixes: b569a1760782f ("userfaultfd: wp: drop _PAGE_UFFD_WP properly when fork")
    Signed-off-by: Peter Xu <peterx@redhat.com>
    Cc: Jerome Glisse <jglisse@redhat.com>
    Cc: Mike Rapoport <rppt@linux.vnet.ibm.com>
    Cc: Alexander Viro <viro@zeniv.linux.org.uk>
    Cc: Andrea Arcangeli <aarcange@redhat.com>
    Cc: Axel Rasmussen <axelrasmussen@google.com>
    Cc: Brian Geffon <bgeffon@google.com>
    Cc: "Dr . David Alan Gilbert" <dgilbert@redhat.com>
    Cc: Hugh Dickins <hughd@google.com>
    Cc: Joe Perches <joe@perches.com>
    Cc: Kirill A. Shutemov <kirill@shutemov.name>
    Cc: Lokesh Gidra <lokeshgidra@google.com>
    Cc: Mike Kravetz <mike.kravetz@oracle.com>
    Cc: Mina Almasry <almasrymina@google.com>
    Cc: Oliver Upton <oupton@google.com>
    Cc: Shaohua Li <shli@fb.com>
    Cc: Shuah Khan <shuah@kernel.org>
    Cc: Stephen Rothwell <sfr@canb.auug.org.au>
    Cc: Wang Qing <wangqing@vivo.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fd26ee0a1a8214f3c8526754a324477851f89fa9
Author: Peter Xu <peterx@redhat.com>
Date:   Wed Jun 30 18:48:59 2021 -0700

    mm/thp: simplify copying of huge zero page pmd when fork
    
    commit 5fc7a5f6fd04bc18f309d9f979b32ef7d1d0a997 upstream.
    
    Patch series "mm/uffd: Misc fix for uffd-wp and one more test".
    
    This series tries to fix some corner case bugs for uffd-wp on either thp
    or fork().  Then it introduced a new test with pagemap/pageout.
    
    Patch layout:
    
    Patch 1:    cleanup for THP, it'll slightly simplify the follow up patches
    Patch 2-4:  misc fixes for uffd-wp here and there; please refer to each patch
    Patch 5:    add pagemap support for uffd-wp
    Patch 6:    add pagemap/pageout test for uffd-wp
    
    The last test introduced can also verify some of the fixes in previous
    patches, as the test will fail without the fixes.  However it's not easy
    to verify all the changes in patch 2-4, but hopefully they can still be
    properly reviewed.
    
    Note that if considering the ongoing uffd-wp shmem & hugetlbfs work, patch
    5 will be incomplete as it's missing e.g.  hugetlbfs part or the special
    swap pte detection.  However that's not needed in this series, and since
    that series is still during review, this series does not depend on that
    one (the last test only runs with anonymous memory, not file-backed).  So
    this series can be merged even before that series.
    
    This patch (of 6):
    
    Huge zero page is handled in a special path in copy_huge_pmd(), however it
    should share most codes with a normal thp page.  Trying to share more code
    with it by removing the special path.  The only leftover so far is the
    huge zero page refcounting (mm_get_huge_zero_page()), because that's
    separately done with a global counter.
    
    This prepares for a future patch to modify the huge pmd to be installed,
    so that we don't need to duplicate it explicitly into huge zero page case
    too.
    
    Link: https://lkml.kernel.org/r/20210428225030.9708-1-peterx@redhat.com
    Link: https://lkml.kernel.org/r/20210428225030.9708-2-peterx@redhat.com
    Signed-off-by: Peter Xu <peterx@redhat.com>
    Cc: Kirill A. Shutemov <kirill@shutemov.name>
    Cc: Mike Kravetz <mike.kravetz@oracle.com>, peterx@redhat.com
    Cc: Mike Rapoport <rppt@linux.vnet.ibm.com>
    Cc: Axel Rasmussen <axelrasmussen@google.com>
    Cc: Andrea Arcangeli <aarcange@redhat.com>
    Cc: Hugh Dickins <hughd@google.com>
    Cc: Jerome Glisse <jglisse@redhat.com>
    Cc: Alexander Viro <viro@zeniv.linux.org.uk>
    Cc: Brian Geffon <bgeffon@google.com>
    Cc: "Dr . David Alan Gilbert" <dgilbert@redhat.com>
    Cc: Joe Perches <joe@perches.com>
    Cc: Lokesh Gidra <lokeshgidra@google.com>
    Cc: Mina Almasry <almasrymina@google.com>
    Cc: Oliver Upton <oupton@google.com>
    Cc: Shaohua Li <shli@fb.com>
    Cc: Shuah Khan <shuah@kernel.org>
    Cc: Stephen Rothwell <sfr@canb.auug.org.au>
    Cc: Wang Qing <wangqing@vivo.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b33e80b18a0a553dee39ec19e2397b5c474b25fb
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Thu Jul 22 15:46:08 2021 +0200

    Revert "mm/shmem: fix shmem_swapin() race with swapoff"
    
    This reverts commit a533a21b692fc15a6aadfa827b29c7d9989109ca which is
    commit 2efa33fc7f6ec94a3a538c1a264273c889be2b36 upstream.
    
    It should not have been added to the stable trees, sorry about that.
    
    Link: https://lore.kernel.org/r/YPVgaY6uw59Fqg5x@casper.infradead.org
    Reported-by: From: Matthew Wilcox <willy@infradead.org>
    Cc: Miaohe Lin <linmiaohe@huawei.com>
    Cc: Ying Huang <ying.huang@intel.com>
    Cc: Alex Shi <alexs@kernel.org>
    Cc: David Hildenbrand <david@redhat.com>
    Cc: Dennis Zhou <dennis@kernel.org>
    Cc: Hugh Dickins <hughd@google.com>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com>
    Cc: Matthew Wilcox <willy@infradead.org>
    Cc: Michal Hocko <mhocko@suse.com>
    Cc: Minchan Kim <minchan@kernel.org>
    Cc: Tim Chen <tim.c.chen@linux.intel.com>
    Cc: Wei Yang <richard.weiyang@gmail.com>
    Cc: Yang Shi <shy828301@gmail.com>
    Cc: Yu Zhao <yuzhao@google.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Sasha Levin <sashal@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 58d7ce3934ae6da952052d8d0f2ea458b16deef9
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Thu Jul 22 15:43:47 2021 +0200

    Revert "swap: fix do_swap_page() race with swapoff"
    
    This reverts commit c3b39134bbd088b7dce5e5f342ccd6bb9142fd18 which is
    commit 2799e77529c2a25492a4395db93996e3dacd762d upstream.
    
    It should not have been added to the stable trees, sorry about that.
    
    Link: https://lore.kernel.org/r/YPVgaY6uw59Fqg5x@casper.infradead.org
    Reported-by: From: Matthew Wilcox <willy@infradead.org>
    Cc: Miaohe Lin <linmiaohe@huawei.com>
    Cc: Ying Huang <ying.huang@intel.com>
    Cc: Alex Shi <alexs@kernel.org>
    Cc: David Hildenbrand <david@redhat.com>
    Cc: Dennis Zhou <dennis@kernel.org>
    Cc: Hugh Dickins <hughd@google.com>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com>
    Cc: Matthew Wilcox <willy@infradead.org>
    Cc: Michal Hocko <mhocko@suse.com>
    Cc: Minchan Kim <minchan@kernel.org>
    Cc: Tim Chen <tim.c.chen@linux.intel.com>
    Cc: Wei Yang <richard.weiyang@gmail.com>
    Cc: Yang Shi <shy828301@gmail.com>
    Cc: Yu Zhao <yuzhao@google.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Sasha Levin <sashal@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 03c03b8936615ef11941e35b90566c63ad0df788
Author: Pali Rohár <pali@kernel.org>
Date:   Thu May 20 13:38:44 2021 +0200

    arm64: dts: marvell: armada-37xx: move firmware node to generic dtsi file
    
    [ Upstream commit 3a52a48973b355b3aac5add92ef50650ae37c2bd ]
    
    Move the turris-mox-rwtm firmware node from Turris MOX' device tree into
    the generic armada-37xx.dtsi file and use the generic compatible string
    'marvell,armada-3700-rwtm-firmware' instead of the current one.
    
    Turris MOX DTS file contains also old compatible string for backward
    compatibility.
    
    The Turris MOX rWTM firmware can be used on any Armada 37xx device,
    giving them access to the rWTM hardware random number generator, which
    is otherwise unavailable.
    
    This change allows Linux to load the turris-mox-rwtm.ko module on these
    boards.
    
    Tested on ESPRESSObin v5 with both default Marvell WTMI firmware and
    CZ.NIC's firmware. With default WTMI firmware the turris-mox-rwtm fails
    to probe, while with CZ.NIC's firmware it registers the HW random number
    generator.
    
    Signed-off-by: Pali Rohár <pali@kernel.org>
    Signed-off-by: Marek Behún <kabel@kernel.org>
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Gregory CLEMENT <gregory.clement@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cffb7390312edc921a365a8781a3555f36053026
Author: Pali Rohár <pali@kernel.org>
Date:   Thu May 20 13:38:43 2021 +0200

    firmware: turris-mox-rwtm: add marvell,armada-3700-rwtm-firmware compatible string
    
    [ Upstream commit 90ae47215de3fec862aeb1a0f0e28bb505ab1351 ]
    
    Add more generic compatible string 'marvell,armada-3700-rwtm-firmware' for
    this driver, since it can also be used on other Armada 3720 devices.
    
    Current compatible string 'cznic,turris-mox-rwtm' is kept for backward
    compatibility.
    
    Signed-off-by: Pali Rohár <pali@kernel.org>
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Gregory CLEMENT <gregory.clement@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ae3d181f4e912f51af7776ea165f199b16fc165d
Author: Paulo Alcantara <pc@cjr.nz>
Date:   Fri Jul 2 11:50:54 2021 -0300

    cifs: prevent NULL deref in cifs_compose_mount_options()
    
    [ Upstream commit 03313d1c3a2f086bb60920607ab79ac8f8578306 ]
    
    The optional @ref parameter might contain an NULL node_name, so
    prevent dereferencing it in cifs_compose_mount_options().
    
    Addresses-Coverity: 1476408 ("Explicit null dereferenced")
    Signed-off-by: Paulo Alcantara (SUSE) <pc@cjr.nz>
    Signed-off-by: Steve French <stfrench@microsoft.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c007614e78a14001eea38de45e209ec963620c6b
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Mon Jul 5 20:16:10 2021 +0200

    s390: introduce proper type handling call_on_stack() macro
    
    [ Upstream commit 41d71fe59cce41237f24f3b7bdc1b414069a34ed ]
    
    The existing CALL_ON_STACK() macro allows for subtle bugs:
    
    - There is no type checking of the function that is being called. That
      is: missing or too many arguments do not cause any compile error or
      warning. The same is true if the return type of the called function
      changes. This can lead to quite random bugs.
    
    - Sign and zero extension of arguments is missing. Given that the s390
      C ABI requires that the caller of a function performs proper sign
      and zero extension this can also lead to subtle bugs.
    
    - If arguments to the CALL_ON_STACK() macros contain functions calls
      register corruption can happen due to register asm constructs being
      used.
    
    Therefore introduce a new call_on_stack() macro which is supposed to
    fix all these problems.
    
    Reviewed-by: Sven Schnelle <svens@linux.ibm.com>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6ef3f584b593383ba70dff55be0198f5af7668e7
Author: Ilya Leoshkevich <iii@linux.ibm.com>
Date:   Fri Jul 2 15:54:55 2021 +0200

    s390/traps: do not test MONITOR CALL without CONFIG_BUG
    
    [ Upstream commit b8e9cc20b808e26329090c19ff80b7f5098e98ff ]
    
    tinyconfig fails to boot, because without CONFIG_BUG report_bug()
    always returns BUG_TRAP_TYPE_BUG, which causes mc 0,0 in
    test_monitor_call() to panic. Fix by skipping the test without
    CONFIG_BUG.
    
    Signed-off-by: Ilya Leoshkevich <iii@linux.ibm.com>
    Reviewed-by: Heiko Carstens <hca@linux.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 09f1a8d85ec1ea6d8a6040f619cb881220c5eea5
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Wed Jun 16 22:04:13 2021 +0300

    thermal/core/thermal_of: Stop zone device before unregistering it
    
    [ Upstream commit 5e5c9f9a75fc4532980c2e699caf8a36070a3a2e ]
    
    Zone device is enabled after thermal_zone_of_sensor_register() completion,
    but it's not disabled before senor is unregistered, leaving temperature
    polling active. This results in accessing a disabled zone device and
    produces a warning about this problem. Stop zone device before
    unregistering it in order to fix this "use-after-free" problem.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20210616190417.32214-3-digetx@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 505c12a1bd71a262aedeaf91b10ecbdab3c48a6b
Author: Kan Liang <kan.liang@linux.intel.com>
Date:   Thu Jun 24 11:17:57 2021 -0700

    perf/x86/intel/uncore: Clean up error handling path of iio mapping
    
    [ Upstream commit d4ba0b06306a70c99a43f9d452886a86e2d3bd26 ]
    
    The error handling path of iio mapping looks fragile. We already fixed
    one issue caused by it, commit f797f05d917f ("perf/x86/intel/uncore:
    Fix for iio mapping on Skylake Server"). Clean up the error handling
    path and make the code robust.
    
    Reported-by: gushengxian <gushengxian@yulong.com>
    Signed-off-by: Kan Liang <kan.liang@linux.intel.com>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Link: https://lkml.kernel.org/r/40e66cf9-398b-20d7-ce4d-433be6e08921@linux.intel.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 06d6142e1421e76ead80589cf0e197fa7dab37de
Author: Odin Ugedal <odin@uged.al>
Date:   Tue Jun 29 14:14:52 2021 +0200

    sched/fair: Fix CFS bandwidth hrtimer expiry type
    
    [ Upstream commit 72d0ad7cb5bad265adb2014dbe46c4ccb11afaba ]
    
    The time remaining until expiry of the refresh_timer can be negative.
    Casting the type to an unsigned 64-bit value will cause integer
    underflow, making the runtime_refresh_within return false instead of
    true. These situations are rare, but they do happen.
    
    This does not cause user-facing issues or errors; other than
    possibly unthrottling cfs_rq's using runtime from the previous period(s),
    making the CFS bandwidth enforcement less strict in those (special)
    situations.
    
    Signed-off-by: Odin Ugedal <odin@uged.al>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Reviewed-by: Ben Segall <bsegall@google.com>
    Link: https://lore.kernel.org/r/20210629121452.18429-1-odin@uged.al
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8997002a88aa1070028a0e793c1be44d5a56890e
Author: Javed Hasan <jhasan@marvell.com>
Date:   Thu Jun 24 10:18:02 2021 -0700

    scsi: qedf: Add check to synchronize abort and flush
    
    [ Upstream commit df99446d5c2a63dc6e6920c8090da0e9da6539d5 ]
    
    A race condition was observed between qedf_cleanup_fcport() and
    qedf_process_error_detect()->qedf_initiate_abts():
    
     [2069091.203145] BUG: unable to handle kernel NULL pointer dereference at 0000000000000030
     [2069091.213100] IP: [<ffffffffc0666cc6>] qedf_process_error_detect+0x96/0x130 [qedf]
     [2069091.223391] PGD 1943049067 PUD 194304e067 PMD 0
     [2069091.233420] Oops: 0000 [#1] SMP
     [2069091.361820] CPU: 1 PID: 14751 Comm: kworker/1:46 Kdump: loaded Tainted: P           OE  ------------   3.10.0-1160.25.1.el7.x86_64 #1
     [2069091.388474] Hardware name: HPE Synergy 480 Gen10/Synergy 480 Gen10 Compute Module, BIOS I42 04/08/2020
     [2069091.402148] Workqueue: qedf_io_wq qedf_fp_io_handler [qedf]
     [2069091.415780] task: ffff9bb9f5190000 ti: ffff9bacaef9c000 task.ti: ffff9bacaef9c000
     [2069091.429590] RIP: 0010:[<ffffffffc0666cc6>]  [<ffffffffc0666cc6>] qedf_process_error_detect+0x96/0x130 [qedf]
     [2069091.443666] RSP: 0018:ffff9bacaef9fdb8  EFLAGS: 00010246
     [2069091.457692] RAX: 0000000000000000 RBX: ffff9bbbbbfb18a0 RCX: ffffffffc0672310
     [2069091.471997] RDX: 00000000000005de RSI: ffffffffc066e7f0 RDI: ffff9beb3f4538d8
     [2069091.486130] RBP: ffff9bacaef9fdd8 R08: 0000000000006000 R09: 0000000000006000
     [2069091.500321] R10: 0000000000001551 R11: ffffb582996ffff8 R12: ffffb5829b39cc18
     [2069091.514779] R13: ffff9badab380c28 R14: ffffd5827f643900 R15: 0000000000000040
     [2069091.529472] FS:  0000000000000000(0000) GS:ffff9beb3f440000(0000) knlGS:0000000000000000
     [2069091.543926] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
     [2069091.558942] CR2: 0000000000000030 CR3: 000000193b9a2000 CR4: 00000000007607e0
     [2069091.573424] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
     [2069091.587876] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
     [2069091.602007] PKRU: 00000000
     [2069091.616010] Call Trace:
     [2069091.629902]  [<ffffffffc0663969>] qedf_process_cqe+0x109/0x2e0 [qedf]
     [2069091.643941]  [<ffffffffc0663b66>] qedf_fp_io_handler+0x26/0x60 [qedf]
     [2069091.657948]  [<ffffffff85ebddcf>] process_one_work+0x17f/0x440
     [2069091.672111]  [<ffffffff85ebeee6>] worker_thread+0x126/0x3c0
     [2069091.686057]  [<ffffffff85ebedc0>] ? manage_workers.isra.26+0x2a0/0x2a0
     [2069091.700033]  [<ffffffff85ec5da1>] kthread+0xd1/0xe0
     [2069091.713891]  [<ffffffff85ec5cd0>] ? insert_kthread_work+0x40/0x40
    
    Add check in qedf_process_error_detect(). When flush is active, let the
    cmds be completed from the cleanup contex.
    
    Link: https://lore.kernel.org/r/20210624171802.598-1-jhasan@marvell.com
    Signed-off-by: Javed Hasan <jhasan@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8511293e643a18b248510ae5734e4f360754348c
Author: Javed Hasan <jhasan@marvell.com>
Date:   Tue Jun 15 09:59:39 2021 -0700

    scsi: libfc: Fix array index out of bound exception
    
    [ Upstream commit b27c4577557045f1ab3cdfeabfc7f3cd24aca1fe ]
    
    Fix array index out of bound exception in fc_rport_prli_resp().
    
    Link: https://lore.kernel.org/r/20210615165939.24327-1-jhasan@marvell.com
    Signed-off-by: Javed Hasan <jhasan@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f661723909ad25a89eda98315637a68a45e00340
Author: Yufen Yu <yuyufen@huawei.com>
Date:   Tue Jun 22 11:40:37 2021 +0800

    scsi: libsas: Add LUN number check in .slave_alloc callback
    
    [ Upstream commit 49da96d77938db21864dae6b7736b71e96c1d203 ]
    
    Offlining a SATA device connected to a hisi SAS controller and then
    scanning the host will result in detecting 255 non-existent devices:
    
      # lsscsi
      [2:0:0:0]    disk    ATA      Samsung SSD 860  2B6Q  /dev/sda
      [2:0:1:0]    disk    ATA      WDC WD2003FYYS-3 1D01  /dev/sdb
      [2:0:2:0]    disk    SEAGATE  ST600MM0006      B001  /dev/sdc
      # echo "offline" > /sys/block/sdb/device/state
      # echo "- - -" > /sys/class/scsi_host/host2/scan
      # lsscsi
      [2:0:0:0]    disk    ATA      Samsung SSD 860  2B6Q  /dev/sda
      [2:0:1:0]    disk    ATA      WDC WD2003FYYS-3 1D01  /dev/sdb
      [2:0:1:1]    disk    ATA      WDC WD2003FYYS-3 1D01  /dev/sdh
      ...
      [2:0:1:255]  disk    ATA      WDC WD2003FYYS-3 1D01  /dev/sdjb
    
    After a REPORT LUN command issued to the offline device fails, the SCSI
    midlayer tries to do a sequential scan of all devices whose LUN number is
    not 0. However, SATA does not support LUN numbers at all.
    
    Introduce a generic sas_slave_alloc() handler which will return -ENXIO for
    SATA devices if the requested LUN number is larger than 0 and make libsas
    drivers use this function as their .slave_alloc callback.
    
    Link: https://lore.kernel.org/r/20210622034037.1467088-1-yuyufen@huawei.com
    Reported-by: Wu Bo <wubo40@huawei.com>
    Suggested-by: John Garry <john.garry@huawei.com>
    Reviewed-by: John Garry <john.garry@huawei.com>
    Reviewed-by: Jason Yan <yanaijie@huawei.com>
    Signed-off-by: Yufen Yu <yuyufen@huawei.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9015de5e72d067b7bee858392e7311fef0feecd2
Author: Colin Ian King <colin.king@canonical.com>
Date:   Mon Jun 21 16:17:27 2021 +0100

    scsi: aic7xxx: Fix unintentional sign extension issue on left shift of u8
    
    [ Upstream commit 332a9dd1d86f1e7203fc7f0fd7e82f0b304200fe ]
    
    The shifting of the u8 integer returned fom ahc_inb(ahc, port+3) by 24 bits
    to the left will be promoted to a 32 bit signed int and then sign-extended
    to a u64. In the event that the top bit of the u8 is set then all then all
    the upper 32 bits of the u64 end up as also being set because of the
    sign-extension. Fix this by casting the u8 values to a u64 before the 24
    bit left shift.
    
    [ This dates back to 2002, I found the offending commit from the git
    history git://git.kernel.org/pub/scm/linux/kernel/git/tglx/history.git,
    commit f58eb66c0b0a ("Update aic7xxx driver to 6.2.10...") ]
    
    Link: https://lore.kernel.org/r/20210621151727.20667-1-colin.king@canonical.com
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Addresses-Coverity: ("Unintended sign extension")
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1c033966a916daa5da8de27219344cff3ff72812
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed May 26 13:20:34 2021 -0400

    rtc: max77686: Do not enforce (incorrect) interrupt trigger type
    
    [ Upstream commit 742b0d7e15c333303daad4856de0764f4bc83601 ]
    
    Interrupt line can be configured on different hardware in different way,
    even inverted.  Therefore driver should not enforce specific trigger
    type - edge falling - but instead rely on Devicetree to configure it.
    
    The Maxim 77686 datasheet describes the interrupt line as active low
    with a requirement of acknowledge from the CPU therefore the edge
    falling is not correct.
    
    The interrupt line is shared between PMIC and RTC driver, so using level
    sensitive interrupt is here especially important to avoid races.  With
    an edge configuration in case if first PMIC signals interrupt followed
    shortly after by the RTC, the interrupt might not be yet cleared/acked
    thus the second one would not be noticed.
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210526172036.183223-6-krzysztof.kozlowski@canonical.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2a04a3607548003f7e36d864ca1f6efe7ea51763
Author: Konstantin Porotchkin <kostap@marvell.com>
Date:   Tue Feb 9 15:46:07 2021 +0200

    arch/arm64/boot/dts/marvell: fix NAND partitioning scheme
    
    [ Upstream commit e3850467bf8c82de4a052619136839fe8054b774 ]
    
    Eliminate 1MB gap between Linux and filesystem partitions.
    
    Signed-off-by: Konstantin Porotchkin <kostap@marvell.com>
    Signed-off-by: Gregory CLEMENT <gregory.clement@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 26125ddc690492470de76d3f46bc0da4651bed4f
Author: Matthias Maennich <maennich@google.com>
Date:   Sat Jun 12 15:18:38 2021 +0100

    kbuild: mkcompile_h: consider timestamp if KBUILD_BUILD_TIMESTAMP is set
    
    [ Upstream commit a979522a1a88556e42a22ce61bccc58e304cb361 ]
    
    To avoid unnecessary recompilations, mkcompile_h does not regenerate
    compile.h if just the timestamp changed.
    Though, if KBUILD_BUILD_TIMESTAMP is set, an explicit timestamp for the
    build was requested, in which case we should not ignore it.
    
    If a user follows the documentation for reproducible builds [1] and
    defines KBUILD_BUILD_TIMESTAMP as the git commit timestamp, a clean
    build will have the correct timestamp. A subsequent cherry-pick (or
    amend) changes the commit timestamp and if an incremental build is done
    with a different KBUILD_BUILD_TIMESTAMP now, that new value is not taken
    into consideration. But it should for reproducibility.
    
    Hence, whenever KBUILD_BUILD_TIMESTAMP is explicitly set, do not ignore
    UTS_VERSION when making a decision about whether the regenerated version
    of compile.h should be moved into place.
    
    [1] https://www.kernel.org/doc/html/latest/kbuild/reproducible-builds.html
    
    Signed-off-by: Matthias Maennich <maennich@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4a7f9e9b24b9255c7403633a951de74bb123f45a
Author: Konrad Dybcio <konrad.dybcio@somainline.org>
Date:   Fri Jun 11 22:33:00 2021 +0200

    arm64: dts: qcom: sm8150: Disable Adreno and modem by default
    
    [ Upstream commit b1dc3c6b3dabbedaf896a3c1a998da191c311c70 ]
    
    Components that rely on proprietary (not to mention signed!) firmware should
    not be enabled by default, as lack of the aforementioned firmware could cause
    various issues, from random errors to straight-up failing to boot.
    
    Not enabling modem back on the HDK, as it uses a sa8150.
    
    Also fixed a sorting mistake in both boards' dt while at it.
    
    Signed-off-by: Konrad Dybcio <konrad.dybcio@somainline.org>
    Link: https://lore.kernel.org/r/20210611203301.101067-1-konrad.dybcio@somainline.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 81c2374228cf774097e148309766f79f5767e249
Author: Konrad Dybcio <konrad.dybcio@somainline.org>
Date:   Sun Jun 13 20:53:34 2021 +0200

    arm64: dts: qcom: sm8250: Fix pcie2_lane unit address
    
    [ Upstream commit dc2f86369b157dfe4dccd31497d2e3c541e7239d ]
    
    The previous one was likely a mistaken copy from pcie1_lane.
    
    Signed-off-by: Konrad Dybcio <konrad.dybcio@somainline.org>
    Link: https://lore.kernel.org/r/20210613185334.306225-1-konrad.dybcio@somainline.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9e159edfefb1c009fb7e9ea7e2d5bd98dbfe4c43
Author: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Date:   Mon Jun 14 21:22:30 2021 +0200

    thermal/drivers/sprd: Add missing of_node_put for loop iteration
    
    [ Upstream commit d8ac5bb4ae653e092d7429a7587b73f1662d6ad7 ]
    
    Early exits from for_each_available_child_of_node() should decrement the
    node reference counter.  Reported by Coccinelle:
    
      drivers/thermal/sprd_thermal.c:387:1-23: WARNING:
        Function "for_each_child_of_node" should have of_node_put() before goto around lines 391.
    
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Acked-by: Chunyan Zhang <zhang.lyra@gmail.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20210614192230.19248-2-krzysztof.kozlowski@canonical.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9a70f266994e92f4ee5f250190dba4018089a4c9
Author: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Date:   Mon Jun 14 21:22:29 2021 +0200

    thermal/drivers/imx_sc: Add missing of_node_put for loop iteration
    
    [ Upstream commit 3da97620e8d60da4a7eaae46e03e0a494780642d ]
    
    Early exits from for_each_available_child_of_node() should decrement the
    node reference counter.  Reported by Coccinelle:
    
      drivers/thermal/imx_sc_thermal.c:93:1-33: WARNING:
        Function "for_each_available_child_of_node" should have of_node_put() before return around line 97.
    
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Reviewed-by: Jacky Bai <ping.bai@nxp.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20210614192230.19248-1-krzysztof.kozlowski@canonical.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 82ad14246066ffabfe50dce7518df3bd5fd10284
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Jun 7 16:41:20 2021 +0200

    thermal/drivers/rcar_gen3_thermal: Do not shadow rcar_gen3_ths_tj_1
    
    [ Upstream commit 3ae5950db617d1cc3eb4eb55750fa9d138529b49 ]
    
    With -Wshadow:
    
        drivers/thermal/rcar_gen3_thermal.c: In function ‘rcar_gen3_thermal_probe’:
        drivers/thermal/rcar_gen3_thermal.c:310:13: warning: declaration of ‘rcar_gen3_ths_tj_1’ shadows a global declaration [-Wshadow]
          310 |  const int *rcar_gen3_ths_tj_1 = of_device_get_match_data(dev);
              |             ^~~~~~~~~~~~~~~~~~
        drivers/thermal/rcar_gen3_thermal.c:246:18: note: shadowed declaration is here
          246 | static const int rcar_gen3_ths_tj_1 = 126;
              |                  ^~~~~~~~~~~~~~~~~~
    
    To add to the confusion, the local variable has a different type.
    
    Fix the shadowing by renaming the local variable to ths_tj_1.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Reviewed-by: Niklas Söderlund <niklas.soderlund+renesas@ragnatech.se>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/9ea7e65d0331daba96f9a7925cb3d12d2170efb1.1623076804.git.geert+renesas@glider.be
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c3e1034bf7a29acfafc6ae87924583736292c56d
Author: Yang Yingliang <yangyingliang@huawei.com>
Date:   Mon May 17 13:10:20 2021 +0800

    thermal/core: Correct function name thermal_zone_device_unregister()
    
    [ Upstream commit a052b5118f13febac1bd901fe0b7a807b9d6b51c ]
    
    Fix the following make W=1 kernel build warning:
    
      drivers/thermal/thermal_core.c:1376: warning: expecting prototype for thermal_device_unregister(). Prototype was for thermal_zone_device_unregister() instead
    
    Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20210517051020.3463536-1-yangyingliang@huawei.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bbb41aa6ee4115753a3842675ac2d4f78150c7de
Author: Dong Aisheng <aisheng.dong@nxp.com>
Date:   Fri May 21 11:12:48 2021 +0800

    arm64: dts: imx8: conn: fix enet clock setting
    
    [ Upstream commit dfda1fd16aa71c839e4002109b0cd15f61105ebb ]
    
    enet_clk_ref actually is sourced from internal gpr clocks
    which needs a default rate. Also update enet lpcg clock
    output names to be more straightforward.
    
    Cc: Abel Vesa <abel.vesa@nxp.com>
    Cc: Stephen Boyd <sboyd@kernel.org>
    Signed-off-by: Dong Aisheng <aisheng.dong@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6d14b0e1cea1042783a945fc537ff7d8b11cf229
Author: Lucas Stach <l.stach@pengutronix.de>
Date:   Sat May 8 00:12:13 2021 +0200

    arm64: dts: imx8mq: assign PCIe clocks
    
    [ Upstream commit 15a5261e4d052bf85c7fba24dbe0e9a7c8c05925 ]
    
    This fixes multiple issues with the current non-existent PCIe clock setup:
    
    The controller can run at up to 250MHz, so use a parent that provides this
    clock.
    
    The PHY needs an exact 100MHz reference clock to function if the PCIe
    refclock is not fed in via the refclock pads. While this mode is not
    supported (yet) in the driver it doesn't hurt to make sure we are
    providing a clock with the right rate.
    
    The AUX clock is specified to have a maximum clock rate of 10MHz. So
    the current setup, which drives it straight from the 25MHz oscillator is
    actually overclocking the AUX input.
    
    Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 646b6021ff2e654115d9d7dc8a18f04d0e2be939
Author: Adam Ford <aford173@gmail.com>
Date:   Wed Apr 28 08:00:58 2021 -0500

    arm64: dts: imx8mn-beacon-som: Assign PMIC clock
    
    [ Upstream commit 1de3aa8611d21d6be546ca1cd13ee05bdd650018 ]
    
    The PMIC throws an errors because the clock isn't assigned to it.
    Fix this by assigning the clocks info.
    
    Signed-off-by: Adam Ford <aford173@gmail.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5345699a52970820b0abb25db61f5086497d2d43
Author: Mian Yousaf Kaukab <ykaukab@suse.de>
Date:   Wed Apr 28 14:58:07 2021 +0200

    arm64: dts: ls208xa: remove bus-num from dspi node
    
    [ Upstream commit 8240c972c1798ea013cbb407722295fc826b3584 ]
    
    On LS2088A-RDB board, if the spi-fsl-dspi driver is built as module
    then its probe fails with the following warning:
    
    [   10.471363] couldn't get idr
    [   10.471381] WARNING: CPU: 4 PID: 488 at drivers/spi/spi.c:2689 spi_register_controller+0x73c/0x8d0
    ...
    [   10.471651] fsl-dspi 2100000.spi: Problem registering DSPI ctlr
    [   10.471708] fsl-dspi: probe of 2100000.spi failed with error -16
    
    Reason for the failure is that bus-num property is set for dspi node.
    However, bus-num property is not set for the qspi node. If probe for
    spi-fsl-qspi happens first then id 0 is dynamically allocated to it.
    Call to spi_register_controller() from spi-fsl-dspi driver then fails.
    Since commit 29d2daf2c33c ("spi: spi-fsl-dspi: Make bus-num property
    optional") bus-num property is optional. Remove bus-num property from
    dspi node to fix the issue.
    
    Signed-off-by: Mian Yousaf Kaukab <ykaukab@suse.de>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cef210690a7afa6e5fd36c110cead6aa9ed6fa63
Author: Punit Agrawal <punitagrawal@gmail.com>
Date:   Mon Jun 7 20:28:56 2021 +0900

    arm64: dts: rockchip: Update RK3399 PCI host bridge window to 32-bit address memory
    
    [ Upstream commit 8efe01b4386ab38a36b99cfdc1dc02c38a8898c3 ]
    
    The PCIe host bridge on RK3399 advertises a single 64-bit memory
    address range even though it lies entirely below 4GB.
    
    Previously the OF PCI range parser treated 64-bit ranges more
    leniently (i.e., as 32-bit), but since commit 9d57e61bf723 ("of/pci:
    Add IORESOURCE_MEM_64 to resource flags for 64-bit memory addresses")
    the code takes a stricter view and treats the ranges as advertised in
    the device tree (i.e, as 64-bit).
    
    The change in behaviour causes failure when allocating bus addresses
    to devices connected behind a PCI-to-PCI bridge that require
    non-prefetchable memory ranges. The allocation failure was observed
    for certain Samsung NVMe drives connected to RockPro64 boards.
    
    Update the host bridge window attributes to treat it as 32-bit address
    memory. This fixes the allocation failure observed since commit
    9d57e61bf723.
    
    Reported-by: Alexandru Elisei <alexandru.elisei@arm.com>
    Link: https://lore.kernel.org/r/7a1e2ebc-f7d8-8431-d844-41a9c36a8911@arm.com
    Suggested-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Punit Agrawal <punitagrawal@gmail.com>
    Tested-by: Alexandru Elisei <alexandru.elisei@arm.com>
    Link: https://lore.kernel.org/r/20210607112856.3499682-5-punitagrawal@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ee3acd45dc45e841616e87ca48877a7f431359b4
Author: Thierry Reding <treding@nvidia.com>
Date:   Tue Apr 13 14:23:35 2021 +0200

    firmware: tegra: bpmp: Fix Tegra234-only builds
    
    [ Upstream commit bd778b893963d67d7eb01f49d84ffcd3eaf229dd ]
    
    The tegra186_bpmp_ops symbol is used on Tegra234, so make sure it's
    available.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ad36bf954334d8bc2d949481045e638690d20553
Author: Thierry Reding <treding@nvidia.com>
Date:   Tue Apr 13 14:20:57 2021 +0200

    soc/tegra: fuse: Fix Tegra234-only builds
    
    [ Upstream commit e2d0ee225e49a5553986f3138dd2803852a31fd5 ]
    
    The tegra30_fuse_read() symbol is used on Tegra234, so make sure it's
    available.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7d9beefb89d0cfd00ae0c49ab8212360c644a6f9
Author: Tony Lindgren <tony@atomide.com>
Date:   Tue May 25 12:33:11 2021 +0300

    ARM: OMAP2+: Block suspend for am3 and am4 if PM is not configured
    
    [ Upstream commit 093a474ce10d8ea3db3ef2922aca5a38f34bab1b ]
    
    If the PM related modules are not loaded and PM firmware not configured,
    the system suspend fails to resume. Let's fix this by adding initial
    platform_suspend_ops to block suspend and warn about missing modules.
    
    When pm33xx and wkup_m3_ipc have been loaded and m3 coprocessor booted
    with it's firmware, pm33xx sets up working platform_suspend_ops. Note
    that we need to configure at least PM_SUSPEND_STANDBY to have
    suspend_set_ops().
    
    Cc: Dave Gerlach <d-gerlach@ti.com>
    Cc: Suman Anna <s-anna@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 72ea603ebc7f36e5a13279440cd374127db3b9c5
Author: Srinivasa Rao Mandadapu <srivasam@codeaurora.org>
Date:   Thu May 13 17:54:29 2021 +0530

    arm64: dts: qcom: sc7180: Add wakeup delay for adau codec
    
    [ Upstream commit ba5f9b5d7ff3452e69275080c3d59265bc1db8ea ]
    
    Add wakeup delay for fixing PoP noise during capture begin.
    
    Reviewed-by: Douglas Anderson <dianders@chromium.org>
    Signed-off-by: Judy Hsiao <judyhsiao@chromium.org>
    Signed-off-by: Srinivasa Rao Mandadapu <srivasam@codeaurora.org>
    Link: https://lore.kernel.org/r/20210513122429.25295-1-srivasam@codeaurora.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a38e8678f0ad04e38ae61eab7fd9d055d0f8cf18
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:33 2021 +0200

    ARM: dts: stm32: fix stpmic node for stm32mp1 boards
    
    [ Upstream commit 4bf4abe19089245b7b12f35e5cafb5477b3e2c48 ]
    
    On some STM32 MP15 boards, stpmic node is not correct which generates
    warnings running "make dtbs_check W=1" command. Issues are:
    
    -"regulator-active-discharge" is not a boolean but an uint32.
    -"regulator-over-current-protection" is not a valid entry for vref_ddr.
    -LDO4 has a fixed voltage (3v3) so min/max entries are not allowed.
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6ea5c31a9ff6df99b20088a6bcdc025d1662332b
Author: Marek Vasut <marex@denx.de>
Date:   Thu Jun 10 02:25:52 2021 +0200

    ARM: dts: stm32: Rename spi-flash/mx66l51235l@N to flash@N on DHCOM SoM
    
    [ Upstream commit 9b8a9b389d8464e1ca5a4e92c6a4422844ad4ef3 ]
    
    Fix the following dtbs_check warning:
    spi-flash@0: $nodename:0: 'spi-flash@0' does not match '^flash(@.*)?$'
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Cc: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Cc: Patrice Chotard <patrice.chotard@foss.st.com>
    Cc: Patrick Delaunay <patrick.delaunay@foss.st.com>
    Cc: kernel@dh-electronics.com
    Cc: linux-stm32@st-md-mailman.stormreply.com
    To: linux-arm-kernel@lists.infradead.org
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 208d0b5c4fe8138e2098e24d8302b75e76e8c93d
Author: Marek Vasut <marex@denx.de>
Date:   Thu Jun 10 02:25:51 2021 +0200

    ARM: dts: stm32: Rename eth@N to ethernet@N on DHCOM SoM
    
    [ Upstream commit b586250df24226f8a257e11e1f5953054c54fd35 ]
    
    Fix the following dtbs_check warning:
    eth@1,0: $nodename:0: 'eth@1,0' does not match '^ethernet(@.*)?$'
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Cc: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Cc: Patrice Chotard <patrice.chotard@foss.st.com>
    Cc: Patrick Delaunay <patrick.delaunay@foss.st.com>
    Cc: kernel@dh-electronics.com
    Cc: linux-stm32@st-md-mailman.stormreply.com
    To: linux-arm-kernel@lists.infradead.org
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5ba5ec23b95da6702fa905e6c55edae5944fbe17
Author: Marek Vasut <marex@denx.de>
Date:   Thu Jun 10 02:25:50 2021 +0200

    ARM: dts: stm32: Drop unused linux,wakeup from touchscreen node on DHCOM SoM
    
    [ Upstream commit 5247a50c8b53ca214a488da648e1bb35c35c2597 ]
    
    Fix the following dtbs_check warning:
    touchscreen@38: 'linux,wakeup' does not match any of the regexes: 'pinctrl-[0-9]+'
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Cc: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Cc: Patrice Chotard <patrice.chotard@foss.st.com>
    Cc: Patrick Delaunay <patrick.delaunay@foss.st.com>
    Cc: kernel@dh-electronics.com
    Cc: linux-stm32@st-md-mailman.stormreply.com
    To: linux-arm-kernel@lists.infradead.org
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1ff4043818da250115df40313da213b48596bbe7
Author: Grzegorz Szymaszek <gszymaszek@short.pl>
Date:   Thu Jun 3 17:40:48 2021 +0200

    ARM: dts: stm32: fix the Odyssey SoM eMMC VQMMC supply
    
    [ Upstream commit f493162319788802b6a49634f7268e691b4c10ec ]
    
    The Seeed SoM-STM32MP157C device tree had the eMMC’s (SDMMC2) VQMMC
    supply set to v3v3 (buck4), the same as the VMMC supply. That was
    incorrect, as on the SoM, the VQMMC supply is provided from vdd (buck3)
    instead.
    
    Signed-off-by: Grzegorz Szymaszek <gszymaszek@short.pl>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d3ad6193b11be71fb19ab7ebd0a758df1f2cb955
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:37 2021 +0200

    ARM: dts: stm32: fix ltdc pinctrl on microdev2.0-of7
    
    [ Upstream commit 11aaf2a0f8f070e87833775965950157bf57e49a ]
    
    It prevents the following warning:
    
     pin-controller@50002000: 'ltdc' does not match any of the regexes:
    '-[0-9]*$', '^gpio@[0-9a-f]*$', 'pinctrl-[0-9]+'
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 45134048d407cda3f469b7455eb54971ab8daa6a
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:31 2021 +0200

    ARM: dts: stm32: move stmmac axi config in ethernet node on stm32mp15
    
    [ Upstream commit fb1406335c067be074eab38206cf9abfdce2fb0b ]
    
    It fixes the following warning seen running "make dtbs_check W=1"
    
    Warning (simple_bus_reg): /soc/stmmac-axi-config: missing or empty
    reg/ranges property
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c68df704e91fa92dff17d3d891514a8440f38ff9
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:30 2021 +0200

    ARM: dts: stm32: fix i2c node name on stm32f746 to prevent warnings
    
    [ Upstream commit ad0ed10ba5792064fc3accbf8f0341152a57eecb ]
    
    Replace upper case by lower case in i2c nodes name.
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4d74e43113bc321fb610e33dbe637521e8370fbb
Author: Johan Jonker <jbx6244@gmail.com>
Date:   Sun Jun 6 20:16:32 2021 +0200

    ARM: dts: rockchip: fix supply properties in io-domains nodes
    
    [ Upstream commit f07edc41220b14ce057a4e6d7161b30688ddb8a2 ]
    
    A test with rockchip-io-domain.yaml gives notifications
    for supply properties in io-domains nodes.
    Fix them all into ".*-supply$" format.
    
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210606181632.13371-1-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b6824bc92923f9a8957877c9fc236f4186178211
Author: Sudeep Holla <sudeep.holla@arm.com>
Date:   Tue Jun 8 15:51:33 2021 +0100

    arm64: dts: juno: Update SCPI nodes as per the YAML schema
    
    [ Upstream commit 70010556b158a0fefe43415fb0c58347dcce7da0 ]
    
    The SCPI YAML schema expects standard node names for clocks and
    power domain controllers. Fix those as per the schema for Juno
    platforms.
    
    Link: https://lore.kernel.org/r/20210608145133.2088631-1-sudeep.holla@arm.com
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6ddae8441dc264778065483d77fe67a7f70f4846
Author: Yang Yingliang <yangyingliang@huawei.com>
Date:   Wed Jun 2 16:49:35 2021 +0800

    i3c: master: svc: drop free_irq of devm_request_irq allocated irq
    
    [ Upstream commit 59a61e69c4252b4e8ecd15e752b0d2337f0121b7 ]
    
    irq allocated with devm_request_irq() will be freed in devm_irq_release(),
    using free_irq() in ->remove() will causes a dangling pointer, and a
    subsequent double free. So remove the free_irq() in svc_i3c_master_remove().
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
    Reviewed-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210602084935.3977636-1-yangyingliang@huawei.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 81cc76202847212953e1258b6670a038b424203c
Author: Stefan Wahren <stefan.wahren@i2se.com>
Date:   Sun Jun 6 14:16:15 2021 +0200

    ARM: dts: bcm283x: Fix up GPIO LED node names
    
    [ Upstream commit 5f30dacf37bc93308e91e4d0fc94681ca73f0f91 ]
    
    Fix the node names for the GPIO LEDs to conform to the standard node
    name led-..
    
    Signed-off-by: Stefan Wahren <stefan.wahren@i2se.com>
    Link: https://lore.kernel.org/r/1622981777-5023-6-git-send-email-stefan.wahren@i2se.com
    Signed-off-by: Nicolas Saenz Julienne <nsaenz@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 97b95aa1abfcddf49f92190ea90efe5dbbc5fb77
Author: Stefan Wahren <stefan.wahren@i2se.com>
Date:   Sun Jun 6 14:16:11 2021 +0200

    ARM: dts: bcm283x: Fix up MMC node names
    
    [ Upstream commit f230c32349eb0a43a012a81c08a7f13859b86cbb ]
    
    Fix the node names for the MMC/SD card controller to conform
    to the standard node name mmc@..
    
    Signed-off-by: Stefan Wahren <stefan.wahren@i2se.com>
    Link: https://lore.kernel.org/r/1622981777-5023-2-git-send-email-stefan.wahren@i2se.com
    Signed-off-by: Nicolas Saenz Julienne <nsaenz@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 668f66189026168c68af3dae126ad4e4f70317ae
Author: Santosh Puranik <santosh.puranik@in.ibm.com>
Date:   Fri Apr 30 13:59:58 2021 -0500

    ARM: dts: aspeed: Everest: Fix cable card PCA chips
    
    [ Upstream commit 010da3daf9278ed03d38b7dcb0422f1a7df1bdd3 ]
    
    Correct two PCA chips which were placed on the wrong I2C bus and
    address.
    
    Signed-off-by: Eddie James <eajames@linux.ibm.com>
    Signed-off-by: Santosh Puranik <santosh.puranik@in.ibm.com>
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9a92a6efb8e659e80dd0fd43f488aac43a934407
Author: Sudeep Holla <sudeep.holla@arm.com>
Date:   Thu Jun 3 08:26:31 2021 +0100

    firmware: arm_scmi: Fix the build when CONFIG_MAILBOX is not selected
    
    [ Upstream commit ab7766b72855e6a68109b915d071181b93086e29 ]
    
    0day CI kernel test robot reported following build error with randconfig
    
    aarch64-linux-ld: drivers/firmware/arm_scmi/driver.o:(.rodata+0x1e0):
                    undefined reference to `scmi_mailbox_desc'
    
    Fix the error by adding CONFIG_MAILBOX dependency for scmi_mailbox_desc.
    
    Link: https://lore.kernel.org/r/20210603072631.1660963-1-sudeep.holla@arm.com
    Cc: Etienne Carriere <etienne.carriere@linaro.org>
    Cc: Cristian Marussi <cristian.marussi@arm.com>
    Reviewed-by: Etienne Carriere <etienne.carriere@linaro.org>
    Reviewed-by: Cristian Marussi <cristian.marussi@arm.com>
    Tested-by: Cristian Marussi <cristian.marussi@arm.com>
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b9e7b8c0b9efa05b7039a35cabb8073c9125c787
Author: Etienne Carriere <etienne.carriere@linaro.org>
Date:   Fri May 21 15:40:51 2021 +0200

    firmware: arm_scmi: Add SMCCC discovery dependency in Kconfig
    
    [ Upstream commit c05b07963e965ae34e75ee8c33af1095350cd87e ]
    
    ARM_SCMI_PROTOCOL depends on either MAILBOX or HAVE_ARM_SMCCC_DISCOVERY,
    not MAILBOX alone. Fix the depedency in Kconfig file and driver to
    reflect the same.
    
    Link: https://lore.kernel.org/r/20210521134055.24271-1-etienne.carriere@linaro.org
    Reviewed-by: Cristian Marussi <cristian.marussi@arm.com>
    Signed-off-by: Etienne Carriere <etienne.carriere@linaro.org>
    [sudeep.holla: Minor tweaks to subject and change log]
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8ec19b8b9c33368b68baa33d16c8ac8497a71964
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Tue Jun 1 05:31:12 2021 +0300

    memory: tegra: Fix compilation warnings on 64bit platforms
    
    [ Upstream commit e0740fb869730110b36a4afcf05ad1b9d6f5fb6d ]
    
    Fix compilation warning on 64bit platforms caused by implicit promotion
    of 32bit signed integer to a 64bit unsigned value which happens after
    enabling compile-testing of the EMC drivers.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bf6e424135e394de0847223789bb13c0a4e378d8
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:27 2021 +0200

    ARM: dts: stm32: fix timer nodes on STM32 MCU to prevent warnings
    
    [ Upstream commit 2388f14d8747f8304e26ee870790e188c9431efd ]
    
    Prevent warning seen with "make dtbs_check W=1" command:
    
    Warning (avoid_unnecessary_addr_size): /soc/timers@40001c00: unnecessary
    address-cells/size-cells without "ranges" or child "reg" property
    
    Reviewed-by: Fabrice Gasnier <fabrice.gasnier@foss.st.com>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9e4183ab28b067a64b83100ea6553799534db7eb
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:26 2021 +0200

    ARM: dts: stm32: fix RCC node name on stm32f429 MCU
    
    [ Upstream commit e4b948415a89a219d13e454011cdcf9e63ecc529 ]
    
    This prevent warning observed with "make dtbs_check W=1"
    
    Warning (simple_bus_reg): /soc/rcc@40023810: simple-bus unit address format
    error, expected "40023800"
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5d36882a85f70665163dbacd71edcda99179d03d
Author: Alexandre Torgue <alexandre.torgue@foss.st.com>
Date:   Thu Apr 15 12:10:25 2021 +0200

    ARM: dts: stm32: fix gpio-keys node on STM32 MCU boards
    
    [ Upstream commit bf24b91f4baf7e421c770a1d9c7d381b10206ac9 ]
    
    Fix following warning observed with "make dtbs_check W=1" command.
    It concerns f429 eval and disco boards, f769 disco board.
    
    Warning (unit_address_vs_reg): /gpio_keys/button@0: node has a unit name,
    but no reg or ranges property
    
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2a735d7a8167c43fa9f7ac0545cceda95a475ba4
Author: Grzegorz Szymaszek <gszymaszek@short.pl>
Date:   Sat Apr 10 21:35:21 2021 +0200

    ARM: dts: stm32: fix stm32mp157c-odyssey card detect pin
    
    [ Upstream commit 0171b07373cc8c2815ca5fa79a7308fdefa54ca4 ]
    
    The microSD card detect pin is physically connected to the MPU pin PI3.
    The Device Tree configuration of the card detect pin was wrong—it was
    set to pin PB7 instead. If such configuration was used, the kernel would
    hang on “Waiting for root device” when booting from a microSD card.
    
    Signed-off-by: Grzegorz Szymaszek <gszymaszek@short.pl>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea9312e7804e993a2e7b80e789253ce99e4efbdd
Author: Marek Vasut <marex@denx.de>
Date:   Mon Apr 26 17:00:13 2021 +0200

    ARM: dts: stm32: Fix touchscreen node on dhcom-pdk2
    
    [ Upstream commit 4b5fadef3fc2ab8863ffdf31eed6a745b1bf6e61 ]
    
    Fix make dtbs_check warning:
    arch/arm/boot/dts/stm32mp157c-dhcom-pdk2.dt.yaml:0:0: /soc/i2c@40015000/polytouch@38: failed to match any schema with compatible: ['edt,edt-ft5x06']
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Cc: Alexandre Torgue <alexandre.torgue@st.com>
    Cc: Patrice Chotard <patrice.chotard@st.com>
    Cc: Patrick Delaunay <patrick.delaunay@st.com>
    Cc: linux-stm32@st-md-mailman.stormreply.com
    To: linux-arm-kernel@lists.infradead.org
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 39fb433494c205c45b7b9d7bdade67c8cf59c89e
Author: Marek Vasut <marex@denx.de>
Date:   Mon Apr 26 17:00:12 2021 +0200

    ARM: dts: stm32: Remove extra size-cells on dhcom-pdk2
    
    [ Upstream commit 28b9a4679d8074512f12967497c161b992eb3b75 ]
    
    Fix make dtbs_check warning:
    arch/arm/boot/dts/stm32mp157c-dhcom-pdk2.dt.yaml: gpio-keys-polled: '#address-cells' is a dependency of '#size-cells'
    arch/arm/boot/dts/stm32mp157c-dhcom-pdk2.dt.yaml: gpio-keys: '#address-cells' is a dependency of '#size-cells'
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Cc: Alexandre Torgue <alexandre.torgue@st.com>
    Cc: Patrice Chotard <patrice.chotard@st.com>
    Cc: Patrick Delaunay <patrick.delaunay@st.com>
    Cc: linux-stm32@st-md-mailman.stormreply.com
    To: linux-arm-kernel@lists.infradead.org
    
    Signed-off-by: Marek Vasut <marex@denx.de>
    Signed-off-by: Alexandre Torgue <alexandre.torgue@foss.st.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1dfe852260bde02e835d61036895d3f8b6dc9c51
Author: Sujit Kautkar <sujitka@chromium.org>
Date:   Fri May 14 11:34:34 2021 -0700

    arm64: dts: qcom: sc7180: Move rmtfs memory region
    
    [ Upstream commit d4282fb4f8f9683711ae6c076da16aa8e675fdbd ]
    
    Move rmtfs memory region so that it does not overlap with system
    RAM (kernel data) when KAsan is enabled. This puts rmtfs right
    after mba_mem which is not supposed to increase beyond 0x94600000
    
    Reviewed-by: Sibi Sankar <sibis@codeaurora.org>
    Signed-off-by: Sujit Kautkar <sujitka@chromium.org>
    Link: https://lore.kernel.org/r/20210514113430.1.Ic2d032cd80424af229bb95e2c67dd4de1a70cb0c@changeid
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 58e1d4a68cb5fd28f5fa56c31ba1e624b3f79022
Author: Jonathan Marek <jonathan@marek.ca>
Date:   Mon Mar 29 15:00:51 2021 +0300

    arm64: dts: qcom: sm8250: fix display nodes
    
    [ Upstream commit dc5d91250ae6b810bc8d599d8d6590a06a4ce84a ]
    
    Use sm8250 compatibles instead of sdm845 compatibles
    
    Reviewed-by: Stephen Boyd <swboyd@chromium.org>
    Signed-off-by: Jonathan Marek <jonathan@marek.ca>
    Signed-off-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
    Link: https://lore.kernel.org/r/20210329120051.3401567-5-dmitry.baryshkov@linaro.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 638c3fc9774ef6937201e2e34126c230f9c86780
Author: Vinod Koul <vkoul@kernel.org>
Date:   Thu May 13 11:37:33 2021 +0530

    arm64: dts: qcom: sm8350: fix the node unit addresses
    
    [ Upstream commit 1dee9e3b0997fef7170f7ea2d8eab47d0cd334d8 ]
    
    Some node unit addresses were put wrongly in the dts, resulting in
    below warning when run with W=1
    
    arch/arm64/boot/dts/qcom/sm8350.dtsi:693.34-702.5: Warning (simple_bus_reg): /soc@0/thermal-sensor@c222000: simple-bus unit address format error, expected "c263000"
    arch/arm64/boot/dts/qcom/sm8350.dtsi:704.34-713.5: Warning (simple_bus_reg): /soc@0/thermal-sensor@c223000: simple-bus unit address format error, expected "c265000"
    arch/arm64/boot/dts/qcom/sm8350.dtsi:1180.32-1185.5: Warning (simple_bus_reg): /soc@0/interconnect@90e0000: simple-bus unit address format error, expected "90c0000"
    
    Fix by correcting to the correct address as given in reg node
    
    Reviewed-by: Robert Foss <robert.foss@linaro.org>
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Link: https://lore.kernel.org/r/20210513060733.382420-1-vkoul@kernel.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3df317941718cbecd960fc31105c7c948f235660
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Mon May 10 23:26:00 2021 +0300

    ARM: tegra: nexus7: Correct 3v3 regulator GPIO of PM269 variant
    
    [ Upstream commit c4dd6066bc304649e3159f1c7a08ece25d537e00 ]
    
    The 3v3 regulator GPIO is GP6 and not GP7, which is the DDR regulator.
    Both regulators are always-on, nevertheless the DT model needs to be
    corrected, fix it.
    
    Reported-by: Svyatoslav Ryhel <clamor95@gmail.com>
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 94c054179d1745ab3ef0161d3933ac109b6136ca
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Mon May 10 23:25:55 2021 +0300

    ARM: tegra: wm8903: Fix polarity of headphones-detection GPIO in device-trees
    
    [ Upstream commit 5f45da704de425d74abd75feaa928fc8a3df03ba ]
    
    All Tegra boards which use WM8903 audio codec are specifying a wrong
    polarity for the headphones detection GPIO. The kernel driver hardcodes
    the polarity to active-low, which is the correct polarity, so we can fix
    the device-trees safely.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cf48dfa5aa264a15d2d63a19d2046d4f3574db60
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Wed May 26 16:20:41 2021 +0300

    arm64: dts: ti: k3-am654x/j721e/j7200-common-proc-board: Fix MCU_RGMII1_TXC direction
    
    [ Upstream commit 69db725cdb2b803af67897a08ea54467d11f6020 ]
    
    The MCU RGMII MCU_RGMII1_TXC pin is defined as input by mistake, although
    this does not make any difference functionality wise it's better to update
    to avoid confusion.
    
    Hence fix MCU RGMII MCU_RGMII1_TXC pin pinmux definitions to be an output
    in K3 am654x/j721e/j7200 board files.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Reviewed-by: Vignesh Raghavendra <vigneshr@ti.com>
    Signed-off-by: Nishanth Menon <nm@ti.com>
    Link: https://lore.kernel.org/r/20210526132041.6104-1-grygorii.strashko@ti.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 105f6beddcb827e3f02c94a187b3089d0bd86d6f
Author: Jon Hunter <jonathanh@nvidia.com>
Date:   Wed May 19 17:41:35 2021 +0100

    arm64: tegra: Add PMU node for Tegra194
    
    [ Upstream commit 9e79e58f330ea4860f2ced65a8a35dfb05fc03c1 ]
    
    Populate the device-tree node for the PMU device on Tegra194. This also
    fixes the following warning that is observed on booting Tegra194.
    
     ERR KERN kvm: pmu event creation failed -2
    
    Signed-off-by: Jon Hunter <jonathanh@nvidia.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7ac85c09d5be547df719b02c57aa41b1a5b8be56
Author: Suman Anna <s-anna@ti.com>
Date:   Tue May 18 12:36:45 2021 -0500

    ARM: dts: OMAP2+: Replace underscores in sub-mailbox node names
    
    [ Upstream commit 9e7f5ee1137397def6580461e27e5efcb68183ee ]
    
    A number of sub-mailbox node names in various OMAP2+ dts files are
    currently using underscores. This is not adhering to the node name
    convention, fix all of these to use hiphens.
    
    These nodes are already using the prefix mbox, so they will be in
    compliance with the sub-mailbox node name convention being added in
    the OMAP Mailbox YAML binding as well.
    
    Signed-off-by: Suman Anna <s-anna@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7752857c652f6d1425b4e0a138cb9befa55ed003
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Sat May 22 01:24:11 2021 +0300

    ARM: dts: am335x: fix ti,no-reset-on-init flag for gpios
    
    [ Upstream commit d7d30b8fcd111e9feb171023c0e0c8d855582dcb ]
    
    The ti,no-reset-on-init flag need to be at the interconnect target module
    level for the modules that have it defined.
    The ti-sysc driver handles this case, but produces warning, not a critical
    issue.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7bfbec1bf56f5cf22e2c641235784cec2503eb30
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Sat May 22 01:24:10 2021 +0300

    ARM: dts: am437x-gp-evm: fix ti,no-reset-on-init flag for gpios
    
    [ Upstream commit 2566d5b8c1670f7d7a44cc1426d254147ec5c421 ]
    
    The ti,no-reset-on-init flag need to be at the interconnect target module
    level for the modules that have it defined.
    The ti-sysc driver handles this case, but produces warning, not a critical
    issue.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 24df090958a340f395b7e5eb53c6dad09be0a18f
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Sat May 22 01:24:09 2021 +0300

    ARM: dts: am57xx-cl-som-am57x: fix ti,no-reset-on-init flag for gpios
    
    [ Upstream commit b644c5e01c870056e13a096e14b9a92075c8f682 ]
    
    The ti,no-reset-on-init flag need to be at the interconnect target module
    level for the modules that have it defined.
    The ti-sysc driver handles this case, but produces warning, not a critical
    issue.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1b45d9048ff49d9a9f2d3e3286f4c818bfbc266b
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Mon May 17 16:03:13 2021 +0900

    kbuild: sink stdout from cmd for silent build
    
    [ Upstream commit 174a1dcc96429efce4ef7eb2f5c4506480da2182 ]
    
    When building with 'make -s', no output to stdout should be printed.
    
    As Arnd Bergmann reported [1], mkimage shows the detailed information
    of the generated images.
    
    I think this should be suppressed by the 'cmd' macro instead of by
    individual scripts.
    
    Insert 'exec >/dev/null;' in order to redirect stdout to /dev/null for
    silent builds.
    
    [Note about this implementation]
    
    'exec >/dev/null;' may look somewhat tricky, but this has a reason.
    
    Appending '>/dev/null' at the end of command line is a common way for
    redirection, so I first tried this:
    
      cmd = @set -e; $(echo-cmd) $(cmd_$(1)) >/dev/null
    
    ... but it would not work if $(cmd_$(1)) itself contains a redirection.
    
    For example, cmd_wrap in scripts/Makefile.asm-generic redirects the
    output from the 'echo' command into the target file.
    
    It would be expanded into:
    
      echo "#include <asm-generic/$*.h>" > $@ >/dev/null
    
    Then, the target file gets empty because the string will go to /dev/null
    instead of $@.
    
    Next, I tried this:
    
      cmd = @set -e; $(echo-cmd) { $(cmd_$(1)); } >/dev/null
    
    The form above would be expanded into:
    
      { echo "#include <asm-generic/$*.h>" > $@; } >/dev/null
    
    This works as expected. However, it would be a syntax error if
    $(cmd_$(1)) is empty.
    
    When CONFIG_TRIM_UNUSED_KSYMS is disabled, $(call cmd,gen_ksymdeps) in
    scripts/Makefile.build would be expanded into:
    
      set -e;  { ; } >/dev/null
    
    ..., which causes an syntax error.
    
    I also tried this:
    
      cmd = @set -e; $(echo-cmd) ( $(cmd_$(1)) ) >/dev/null
    
    ... but this causes a syntax error for the same reason.
    
    So, finally I adopted:
    
      cmd = @set -e; $(echo-cmd) exec >/dev/null; $(cmd_$(1))
    
    [1]: https://lore.kernel.org/lkml/20210514135752.2910387-1-arnd@kernel.org/
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3e079812f469f4adf6a4a410c49bed2c05ae0c73
Author: Adam Ford <aford173@gmail.com>
Date:   Thu May 13 06:46:16 2021 -0500

    arm64: dts: renesas: beacon: Fix USB ref clock references
    
    [ Upstream commit ebc666f39ff67a01e748c34d670ddf05a9e45220 ]
    
    The RZ/G2 boards expect there to be an external clock reference for
    USB2 EHCI controllers.  For the Beacon boards, this reference clock
    is controlled by a programmable versaclock.  Because the RZ/G2
    family has a special clock driver when using an external clock,
    the third clock reference in the EHCI node needs to point to this
    special clock, called usb2_clksel.
    
    Since the usb2_clksel does not keep the usb_extal clock enabled,
    the 4th clock entry for the EHCI nodes needs to reference it to
    keep the clock running and make USB functional.
    
    Signed-off-by: Adam Ford <aford173@gmail.com>
    Link: https://lore.kernel.org/r/20210513114617.30191-2-aford173@gmail.com
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 27469bcc5b058040d94be4ec02fd9de91f11f431
Author: Adam Ford <aford173@gmail.com>
Date:   Thu May 13 06:46:15 2021 -0500

    arm64: dts: renesas: beacon: Fix USB extal reference
    
    [ Upstream commit 56bc54496f5d6bc638127bfc9df3742cbf0039e7 ]
    
    The USB extal clock reference isn't associated to a crystal, it's
    associated to a programmable clock, so remove the extal reference,
    add the usb2_clksel.  Since usb_extal is referenced by the versaclock,
    reference it here so the usb2_clksel can get the proper clock speed
    of 50MHz.
    
    Signed-off-by: Adam Ford <aford173@gmail.com>
    Link: https://lore.kernel.org/r/20210513114617.30191-1-aford173@gmail.com
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b5f38dc8381c2ad4ef514056683e37f1d12ff2c2
Author: Bixuan Cui <cuibixuan@huawei.com>
Date:   Sat May 8 11:15:09 2021 +0800

    rtc: mxc_v2: add missing MODULE_DEVICE_TABLE
    
    [ Upstream commit 206e04ec7539e7bfdde9aa79a7cde656c9eb308e ]
    
    This patch adds missing MODULE_DEVICE_TABLE definition which generates
    correct modalias for automatic loading of this driver when it is built
    as an external module.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Bixuan Cui <cuibixuan@huawei.com>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210508031509.53735-1-cuibixuan@huawei.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0c5b081a4d0a093c9914524966e9f1034ee2925a
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Mon May 24 01:14:29 2021 +0200

    ARM: dts: ux500: Fix orientation of Janice accelerometer
    
    [ Upstream commit e409c1e1d5cb164361229e3a3f084e4a32544fb6 ]
    
    This fixes up the axis on the Janice accelerometer to give
    the right orientation according to tests.
    
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 15cd8eb0c2e64933e0a0f223772f28ef4ea11cb1
Author: Oleksij Rempel <linux@rempel-privat.de>
Date:   Tue May 11 06:30:39 2021 +0200

    ARM: dts: imx6dl-riotboard: configure PHY clock and set proper EEE value
    
    [ Upstream commit 723de6a4126b2474a8106e943749e1554012dad6 ]
    
    Without SoC specific PHY fixups the network interface on this board will
    fail to work. Provide missing DT properties to make it work again.
    
    Signed-off-by: Oleksij Rempel <o.rempel@pengutronix.de>
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4f0520fad7d8beab65cb53997bc0d641132c220b
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Thu Mar 18 09:27:58 2021 +0100

    ARM: dts: ux500: Fix some compatible strings
    
    [ Upstream commit 59ba546d1662c4beb738725965041f350afe24b4 ]
    
    The Golden and Skomer phones have BCM4334 WLAN+BT chips,
    so make the compatible strings reflect the new available
    bindings for these.
    
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b28ddd20572a65b990698866bfd33d29427d760c
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Sat May 15 02:02:34 2021 +0200

    ARM: dts: ux500: Fix orientation of accelerometer
    
    [ Upstream commit 4beba4011995a2c44ee27e1d358dc32e6b9211b3 ]
    
    This adds a mounting matrix to the accelerometer
    on the TVK1281618 R3.
    
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7f1d0da1cc41e506275b3c40007a80ce4b2b169b
Author: Sebastian Reichel <sebastian.reichel@collabora.com>
Date:   Tue Apr 13 01:03:17 2021 +0200

    ARM: dts: ux500: Rename gpio-controller node
    
    [ Upstream commit 4917b702818872fdf2a9973705af3aa7d3d1f19e ]
    
    Rename the AB8500 gpio controller node from ab8500-gpio to
    ab8500-gpiocontroller, since -gpio is a common suffix for
    gpio consumers.
    
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 049ec888cd62c1165040ef650e88a943e60af87c
Author: Sebastian Reichel <sebastian.reichel@collabora.com>
Date:   Tue Apr 13 01:03:16 2021 +0200

    ARM: dts: ux500: Fix interrupt cells
    
    [ Upstream commit e4ff0112a03c2e353c8457cd33c88feb89dfec41 ]
    
    Fix interrupt cells in DT AB8500/AB8505 source files. The
    compiled DTB files will stay the same.
    
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea98b9eb6862b436c979abffe7b2798d16b0b49a
Author: Johan Jonker <jbx6244@gmail.com>
Date:   Mon May 10 23:58:40 2021 +0200

    arm64: dts: rockchip: fix regulator-gpio states array
    
    [ Upstream commit b82f8e2992534aab0fa762a37376be30df263701 ]
    
    A test with the command below gives this error:
    
    /arch/arm64/boot/dts/rockchip/rk3328-nanopi-r2s.dt.yaml:
    sdmmcio-regulator: states:0:
    [1800000, 1, 3300000, 0] is too long
    
    dtbs_check expects regulator-gpio states in a format
    of 2 per item, so fix them all.
    
    make ARCH=arm64 dtbs_check
    DT_SCHEMA_FILES=Documentation/devicetree/bindings/
    regulator/gpio-regulator.yaml
    
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210510215840.16270-1-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9680f1e8f8b59aea74732c4704cefbc3fbe26605
Author: Jonathan Neuschäfer <j.neuschaefer@gmx.net>
Date:   Sat Apr 24 14:37:28 2021 +0200

    ARM: imx: pm-imx5: Fix references to imx5_cpu_suspend_info
    
    [ Upstream commit 89b759469d525f4d5f9c29cd3b1f490311c67f85 ]
    
    The name of the struct, as defined in arch/arm/mach-imx/pm-imx5.c,
    is imx5_cpu_suspend_info.
    
    Signed-off-by: Jonathan Neuschäfer <j.neuschaefer@gmx.net>
    Reviewed-by: Fabio Estevam <festevam@gmail.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9b3161825b240cc7220ce87aba3f60aed4be186f
Author: Primoz Fiser <primoz.fiser@norik.com>
Date:   Mon Apr 12 08:24:50 2021 +0200

    ARM: dts: imx6: phyFLEX: Fix UART hardware flow control
    
    [ Upstream commit 14cdc1f243d79e0b46be150502b7dba9c5a6bdfd ]
    
    Serial interface uart3 on phyFLEX board is capable of 5-wire connection
    including signals RTS and CTS for hardware flow control.
    
    Fix signals UART3_CTS_B and UART3_RTS_B padmux assignments and add
    missing property "uart-has-rtscts" to allow serial interface to be
    configured and used with the hardware flow control.
    
    Signed-off-by: Primoz Fiser <primoz.fiser@norik.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f686c2ca914532599115ae1cc3ff341b01f8600f
Author: Zou Wei <zou_wei@huawei.com>
Date:   Tue May 11 11:55:50 2021 +0800

    soc: mediatek: add missing MODULE_DEVICE_TABLE
    
    [ Upstream commit ba96de3ae5a7e2121cac80053b277eb2ab51a0ae ]
    
    This patch adds missing MODULE_DEVICE_TABLE definition which generates
    correct modalias for automatic loading of this driver when it is built
    as an external module.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Zou Wei <zou_wei@huawei.com>
    Link: https://lore.kernel.org/r/1620705350-104687-1-git-send-email-zou_wei@huawei.com
    Signed-off-by: Matthias Brugger <matthias.bgg@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 556e5beac048d02d74cbd9eac55024dc711b738f
Author: Jiapeng Chong <jiapeng.chong@linux.alibaba.com>
Date:   Wed Mar 31 16:39:59 2021 +0800

    soc: bcm: brcmstb: remove unused variable 'brcmstb_machine_match'
    
    [ Upstream commit c1f512182c54dc87efd2f7ac19f16a49ff8bb19e ]
    
    Fix the following clang warning:
    
    drivers/soc/bcm/brcmstb/common.c:17:34: warning: unused variable
    'brcmstb_machine_match' [-Wunused-const-variable].
    
    Reported-by: Abaci Robot <abaci@linux.alibaba.com>
    Signed-off-by: Jiapeng Chong <jiapeng.chong@linux.alibaba.com>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3e3a7d2bf0d57a23c6390a75126905e604f9bcc1
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Wed Apr 21 11:00:06 2021 +0200

    ARM: dts: BCM5301X: Fix pinmux subnodes names
    
    [ Upstream commit bb95d7d440fefd104c593d9cb20da6d34a474e97 ]
    
    This matches pinmux-node.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d8428468f91a37901a20b50765864e95a45e0149
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:53 2021 +0200

    ARM: dts: Hurricane 2: Fix NAND nodes names
    
    [ Upstream commit a4528d9029e2eda16e4fc9b9da1de1fbec10ab26 ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 051500990321aea5ed3f751a9b85288edce48e01
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:52 2021 +0200

    ARM: dts: BCM63xx: Fix NAND nodes names
    
    [ Upstream commit 75e2f012f6e34b93124d1d86eaa8f27df48e9ea0 ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c477ee9b6402ef8ce8c8d823a2f84adebd71c440
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:51 2021 +0200

    ARM: NSP: dts: fix NAND nodes names
    
    [ Upstream commit 0484594be733d5cdf976f55a2d4e8d887f351b69 ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 14a49e42f74ca3253419b426a67c35ec4c05a18b
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:50 2021 +0200

    ARM: Cygnus: dts: fix NAND nodes names
    
    [ Upstream commit e256b48a3b07ee1ae4bfa60abbf509ba8e386862 ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 12e303c937a27c94d18aeb04cb8783de202a83c5
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:49 2021 +0200

    ARM: brcmstb: dts: fix NAND nodes names
    
    [ Upstream commit 9a800ce1aada6e0f56b78e4713f4858c8990c1f7 ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ca57a034e8464b0581727455f04d8f2923802800
Author: Rafał Miłecki <rafal@milecki.pl>
Date:   Fri Apr 16 15:37:48 2021 +0200

    ARM: dts: BCM5301X: Fix NAND nodes names
    
    [ Upstream commit b660269cba748dfd07eb5551a88ff34d5ea0b86e ]
    
    This matches nand-controller.yaml requirements.
    
    Signed-off-by: Rafał Miłecki <rafal@milecki.pl>
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea49b15d27f022f5b4ffe3afc1fe554908aca661
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Mar 4 17:01:39 2021 +0100

    reset: ti-syscon: fix to_ti_syscon_reset_data macro
    
    [ Upstream commit 05cf8fffcdeb47aef1203c08cbec5224fd3a0e1c ]
    
    The to_ti_syscon_reset_data macro currently only works if the
    parameter passed into it is called 'rcdev'.
    
    Fixes a checkpatch --strict issue:
    
      CHECK: Macro argument reuse 'rcdev' - possible side-effects?
      #53: FILE: drivers/reset/reset-ti-syscon.c:53:
      +#define to_ti_syscon_reset_data(rcdev)       \
      +     container_of(rcdev, struct ti_syscon_reset_data, rcdev)
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ac00948749f1e25c7bf9415eae5480e101a0f41f
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:44 2021 +0200

    arm64: dts: rockchip: Fix power-controller node names for rk3399
    
    [ Upstream commit 148bbe29f9108812c6fedd8a228f9e1ed6b422f7 ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-8-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e2cc3578a62806798704adc205197e8be8bcc14b
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:43 2021 +0200

    arm64: dts: rockchip: Fix power-controller node names for rk3328
    
    [ Upstream commit 6e6a282b49c6db408d27231e3c709fbdf25e3c1b ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-7-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0ff2235f030af709a5f5baa089d37190b9157293
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:42 2021 +0200

    arm64: dts: rockchip: Fix power-controller node names for px30
    
    [ Upstream commit d5de0d688ac6e0202674577b05d0726b8a6af401 ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-6-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5ada42440f491a774008a1da8f1b421d0cda0a94
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:40 2021 +0200

    ARM: dts: rockchip: Fix power-controller node names for rk3288
    
    [ Upstream commit 970cdc53cb1afa73602028c103dbfb6a230080be ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-4-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0151a90fc279becb019336e1abdcedde3953f02a
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:39 2021 +0200

    ARM: dts: rockchip: Fix power-controller node names for rk3188
    
    [ Upstream commit d3bcbcd396175ac26aa54919c0b31c7d2878fc24 ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-3-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit af5ca9f83fadd229ec0a6c7a55e5f8caca314760
Author: Elaine Zhang <zhangqing@rock-chips.com>
Date:   Sat Apr 17 13:29:38 2021 +0200

    ARM: dts: rockchip: Fix power-controller node names for rk3066a
    
    [ Upstream commit f2948781a72f0d8cf2adf31758c357f2f35e6c79 ]
    
    Use more generic names (as recommended in the device tree specification
    or the binding documentation)
    
    Signed-off-by: Elaine Zhang <zhangqing@rock-chips.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210417112952.8516-2-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9015d0c9b0727f5b02507cdfaabf96f7c8db108e
Author: Benjamin Gaignard <benjamin.gaignard@collabora.com>
Date:   Fri May 7 11:02:29 2021 +0200

    ARM: dts: rockchip: Fix IOMMU nodes properties on rk322x
    
    [ Upstream commit 6b023929666f0be5df75f5e0278d1b70effadf42 ]
    
    Add '#" to iommu-cells properties.
    Remove useless interrupt-names properties
    
    Signed-off-by: Benjamin Gaignard <benjamin.gaignard@collabora.com>
    Link: https://lore.kernel.org/r/20210507090232.233049-4-benjamin.gaignard@collabora.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 991661f15817afa00080c73c62990998c7af63d1
Author: Ezequiel Garcia <ezequiel@collabora.com>
Date:   Thu May 6 08:11:35 2021 -0300

    ARM: dts: rockchip: Fix the timer clocks order
    
    [ Upstream commit 7b46d674ac000b101fdad92cf16cc11d90b72f86 ]
    
    Fixed order is the device-tree convention.
    The timer driver currently gets clocks by name,
    so no changes are needed there.
    
    Signed-off-by: Ezequiel Garcia <ezequiel@collabora.com>
    Link: https://lore.kernel.org/r/20210506111136.3941-3-ezequiel@collabora.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 670079df8659112858c9466be06dbc5d8a87af35
Author: Johan Jonker <jbx6244@gmail.com>
Date:   Tue Jan 26 12:02:21 2021 +0100

    arm64: dts: rockchip: fix pinctrl sleep nodename for rk3399.dtsi
    
    [ Upstream commit a7ecfad495f8af63a5cb332c91f60ab2018897f5 ]
    
    A test with the command below aimed at powerpc generates
    notifications in the Rockchip arm64 tree.
    
    Fix pinctrl "sleep" nodename by renaming it to "suspend"
    for rk3399.dtsi
    
    make ARCH=arm64 dtbs_check
    DT_SCHEMA_FILES=Documentation/devicetree/bindings/powerpc/sleep.yaml
    
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210126110221.10815-2-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5980cb81f165456adec6936540bb89f3dcc2d906
Author: Peter Robinson <pbrobinson@gmail.com>
Date:   Tue Apr 13 15:17:09 2021 +0100

    arm64: dts: rockchip: Use only supported PCIe link speed on rk3399
    
    [ Upstream commit 954d5986afa50c178ea7554e6abdd611d08f5ade ]
    
    The max link speed supported by the rk3399 is already set in the
    rk3399.dtsi file so don't set unsupported link speeds in device
    specific DTs. This is the same fix as 642fb27.
    
    Signed-off-by: Peter Robinson <pbrobinson@gmail.com>
    Link: https://lore.kernel.org/r/20210413141709.845592-1-pbrobinson@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 68d1369daf96fd9f0432e28c5e660c5075c00a1f
Author: Johan Jonker <jbx6244@gmail.com>
Date:   Tue Jan 26 12:02:20 2021 +0100

    ARM: dts: rockchip: fix pinctrl sleep nodename for rk3036-kylin and rk3288
    
    [ Upstream commit dfbfb86a43f9a5bbd166d88bca9e07ee4e1bff31 ]
    
    A test with the command below aimed at powerpc generates
    notifications in the Rockchip ARM tree.
    
    Fix pinctrl "sleep" nodename by renaming it to "suspend"
    for rk3036-kylin and rk3288
    
    make ARCH=arm dtbs_check
    DT_SCHEMA_FILES=Documentation/devicetree/bindings/powerpc/sleep.yaml
    
    Signed-off-by: Johan Jonker <jbx6244@gmail.com>
    Link: https://lore.kernel.org/r/20210126110221.10815-1-jbx6244@gmail.com
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit deacb07e91be7d01061ef5921bb256b8d0720cdc
Author: Ezequiel Garcia <ezequiel@collabora.com>
Date:   Thu May 6 14:55:11 2021 -0300

    ARM: dts: rockchip: Fix thermal sensor cells o rk322x
    
    [ Upstream commit d5c24e20daf09587cbc221d40be1ba92673e8d94 ]
    
    The number of cells to be used with a thermal sensor specifier
    must be "1". Fix this.
    
    Signed-off-by: Ezequiel Garcia <ezequiel@collabora.com>
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Link: https://lore.kernel.org/r/20210506175514.168365-2-ezequiel@collabora.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f6e1fd15b3ee72d8a4ec6c799adfcaec137666f5
Author: Corentin Labbe <clabbe@baylibre.com>
Date:   Mon May 3 18:52:28 2021 +0000

    ARM: dts: gemini: add device_type on pci
    
    [ Upstream commit 483f3645b3f7acfd1c78a19d51b80c0656161974 ]
    
    Fixes DT warning on pci node by adding the missing device_type.
    
    Signed-off-by: Corentin Labbe <clabbe@baylibre.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6f9ba39547e2c7465512f6cbda2a9eb738afdcc6
Author: Corentin Labbe <clabbe@baylibre.com>
Date:   Wed Apr 28 17:48:30 2021 +0000

    ARM: dts: gemini: rename mdio to the right name
    
    [ Upstream commit fc5b59b945b546e27977e99a5ca6fe61179ff0d2 ]
    
    ethernet-phy is not the right name for mdio, fix it.
    
    Signed-off-by: Corentin Labbe <clabbe@baylibre.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>
