commit f56f3d0e65adb447b8b583c8ed4fbbe544c9bfde
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Wed Nov 20 18:00:54 2019 +0100

    Linux 4.14.155

commit e979aaf21323ed95f4244b039a3aab9f9bf459dd
Author: Jouni Hogander <jouni.hogander@unikie.com>
Date:   Wed Nov 13 12:08:01 2019 +0200

    slcan: Fix memory leak in error path
    
    commit ed50e1600b4483c049ce76e6bd3b665a6a9300ed upstream.
    
    This patch is fixing memory leak reported by Syzkaller:
    
    BUG: memory leak unreferenced object 0xffff888067f65500 (size 4096):
      comm "syz-executor043", pid 454, jiffies 4294759719 (age 11.930s)
      hex dump (first 32 bytes):
        73 6c 63 61 6e 30 00 00 00 00 00 00 00 00 00 00 slcan0..........
        00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
      backtrace:
        [<00000000a06eec0d>] __kmalloc+0x18b/0x2c0
        [<0000000083306e66>] kvmalloc_node+0x3a/0xc0
        [<000000006ac27f87>] alloc_netdev_mqs+0x17a/0x1080
        [<0000000061a996c9>] slcan_open+0x3ae/0x9a0
        [<000000001226f0f9>] tty_ldisc_open.isra.1+0x76/0xc0
        [<0000000019289631>] tty_set_ldisc+0x28c/0x5f0
        [<000000004de5a617>] tty_ioctl+0x48d/0x1590
        [<00000000daef496f>] do_vfs_ioctl+0x1c7/0x1510
        [<0000000059068dbc>] ksys_ioctl+0x99/0xb0
        [<000000009a6eb334>] __x64_sys_ioctl+0x78/0xb0
        [<0000000053d0332e>] do_syscall_64+0x16f/0x580
        [<0000000021b83b99>] entry_SYSCALL_64_after_hwframe+0x44/0xa9
        [<000000008ea75434>] 0xffffffffffffffff
    
    Cc: Wolfgang Grandegger <wg@grandegger.com>
    Cc: Marc Kleine-Budde <mkl@pengutronix.de>
    Cc: Lukas Bulwahn <lukas.bulwahn@gmail.com>
    Signed-off-by: Jouni Hogander <jouni.hogander@unikie.com>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>
    Cc: Oliver Hartkopp <socketcan@hartkopp.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 988f701a805bf980e70a557894d26564e10fc1a6
Author: zhong jiang <zhongjiang@huawei.com>
Date:   Mon Nov 18 11:26:07 2019 +0800

    memfd: Use radix_tree_deref_slot_protected to avoid the warning.
    
    The commit 391d4ee568b5 ("memfd: Fix locking when tagging pins")
    introduces the following warning messages.
    
    *WARNING: suspicious RCU usage in memfd_wait_for_pins*
    
    It is because we still use radix_tree_deref_slot without read_rcu_lock.
    We should use radix_tree_deref_slot_protected instead in the case.
    
    Cc: stable@vger.kernel.org
    Fixes: 391d4ee568b5 ("memfd: Fix locking when tagging pins")
    Signed-off-by: zhong jiang <zhongjiang@huawei.com>
    Reviewed-by: Matthew Wilcox (Oracle) <willy@infradead.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7fdedf0c8d8eb93390c94533057d0666a10efd9e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Sep 26 15:14:10 2018 +0200

    net: phy: mdio-bcm-unimac: mark PM functions as __maybe_unused
    
    [ Upstream commit 9b97123a584f60a5bca5a2663485768a1f6cd0a4 ]
    
    The newly added runtime-pm support causes a harmless warning
    when CONFIG_PM is disabled:
    
    drivers/net/phy/mdio-bcm-unimac.c:330:12: error: 'unimac_mdio_resume' defined but not used [-Werror=unused-function]
     static int unimac_mdio_resume(struct device *d)
    drivers/net/phy/mdio-bcm-unimac.c:321:12: error: 'unimac_mdio_suspend' defined but not used [-Werror=unused-function]
     static int unimac_mdio_suspend(struct device *d)
    
    Marking the functions as __maybe_unused is the easiest workaround
    and avoids adding #ifdef checks.
    
    Fixes: b78ac6ecd1b6 ("net: phy: mdio-bcm-unimac: Allow configuring MDIO clock divider")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 24adb0e7d14b59266993b548de9ea2b60ea85570
Author: Israel Rukshin <israelr@mellanox.com>
Date:   Wed Sep 26 09:44:18 2018 +0000

    IB/iser: Fix possible NULL deref at iser_inv_desc()
    
    [ Upstream commit 65f07f5a09dacf3b60619f196f096ea3671a5eda ]
    
    In case target remote invalidates bogus rkey and signature is not used,
    pi_ctx is NULL deref.
    
    The commit also fails the connection on bogus remote invalidation.
    
    Fixes: 59caaed7a72a ("IB/iser: Support the remote invalidation exception")
    Signed-off-by: Israel Rukshin <israelr@mellanox.com>
    Reviewed-by: Max Gurtovoy <maxg@mellanox.com>
    Reviewed-by: Sagi Grimberg <sagi@grimberg.me>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2b149bb378bc34545549d2e8c35f2bbdf1debc92
Author: Kirill Tkhai <ktkhai@virtuozzo.com>
Date:   Mon Aug 27 18:29:29 2018 +0300

    fuse: use READ_ONCE on congestion_threshold and max_background
    
    [ Upstream commit 2a23f2b8adbe4bd584f936f7ac17a99750eed9d7 ]
    
    Since they are of unsigned int type, it's allowed to read them
    unlocked during reporting to userspace. Let's underline this fact
    with READ_ONCE() macroses.
    
    Signed-off-by: Kirill Tkhai <ktkhai@virtuozzo.com>
    Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9d7681036dd09c5e4c8699f413188a9ab8b53efb
Author: Chunfeng Yun <chunfeng.yun@mediatek.com>
Date:   Thu Sep 20 19:13:32 2018 +0300

    usb: xhci-mtk: fix ISOC error when interval is zero
    
    [ Upstream commit 87173acc0d8f0987bda8827da35fff67f52ad15d ]
    
    If the interval equal zero, needn't round up to power of two
    for the number of packets in each ESIT, so fix it.
    
    Signed-off-by: Chunfeng Yun <chunfeng.yun@mediatek.com>
    Signed-off-by: Mathias Nyman <mathias.nyman@linux.intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 85562d7a4fa73c35bcbe64565a801b0ee7230708
Author: Tan Hu <tan.hu@zte.com.cn>
Date:   Fri Sep 7 16:33:33 2018 +0800

    netfilter: masquerade: don't flush all conntracks if only one address deleted on device
    
    [ Upstream commit 097f95d319f817e651bd51f8846aced92a55a6a1 ]
    
    We configured iptables as below, which only allowed incoming data on
    established connections:
    
    iptables -t mangle -A PREROUTING -m state --state ESTABLISHED -j ACCEPT
    iptables -t mangle -P PREROUTING DROP
    
    When deleting a secondary address, current masquerade implements would
    flush all conntracks on this device. All the established connections on
    primary address also be deleted, then subsequent incoming data on the
    connections would be dropped wrongly because it was identified as NEW
    connection.
    
    So when an address was delete, it should only flush connections related
    with the address.
    
    Signed-off-by: Tan Hu <tan.hu@zte.com.cn>
    Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 23acf86994d35b750f8879761796f449de31c0cd
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Mon Sep 24 16:25:34 2018 +0200

    rtc: armada38x: fix possible race condition
    
    [ Upstream commit 7d61cbb945a753af08e247b5f10bdd5dbb8d6c80 ]
    
    The IRQ is requested before the struct rtc is allocated and registered, but
    this struct is used in the IRQ handler. This may lead to a NULL pointer
    dereference.
    
    Switch to devm_rtc_allocate_device/rtc_register_device to allocate the rtc
    before requesting the IRQ.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 52164377ed2be86665479876532f66368d9d96f8
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:33 2018 -0500

    ARM: dts: lpc32xx: Fix SPI controller node names
    
    [ Upstream commit 11236ef582b8d66290bb3b3710e03ca1d85d8ad8 ]
    
    SPI controller nodes should be named 'spi' rather than 'ssp'. Fixing the
    name enables dtc SPI bus checks.
    
    Cc: Vladimir Zapolskiy <vz@mleia.com>
    Cc: Sylvain Lemieux <slemieux.tyco@gmail.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a583b37a088b60668ca5d03484348cbf1f985280
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:44 2018 -0500

    arm64: dts: lg: Fix SPI controller node names
    
    [ Upstream commit 09bae3b64cb580c95329bd8d16f08f0a5cb81ec9 ]
    
    SPI controller nodes should be named 'spi' rather than 'ssp'. Fixing the
    name enables dtc SPI bus checks.
    
    Cc: Chanho Min <chanho.min@lge.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e083cad420a148c5a25efeb517c06ebf7400c75d
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:40 2018 -0500

    arm64: dts: amd: Fix SPI bus warnings
    
    [ Upstream commit e9f0878c4b2004ac19581274c1ae4c61ae3ca70e ]
    
    dtc has new checks for SPI buses. Fix the warnings in node names.
    
    arch/arm64/boot/dts/amd/amd-overdrive.dtb: Warning (spi_bus_bridge): /smb/ssp@e1030000: node name for SPI buses should be 'spi'
    arch/arm64/boot/dts/amd/amd-overdrive-rev-b0.dtb: Warning (spi_bus_bridge): /smb/ssp@e1030000: node name for SPI buses should be 'spi'
    arch/arm64/boot/dts/amd/amd-overdrive-rev-b1.dtb: Warning (spi_bus_bridge): /smb/ssp@e1030000: node name for SPI buses should be 'spi'
    
    Cc: Brijesh Singh <brijeshkumar.singh@amd.com>
    Cc: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
    Cc: Tom Lendacky <thomas.lendacky@amd.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ce837affeb34e61cc808cf23f93a11b958dd2199
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Check for bus reset
    
    [ Upstream commit 6b0e87a6aafe12d75c2bea6fc8e49e88b98b3083 ]
    
    The SR_RST bit isn't latched. Hence, detecting a bus reset isn't reliable.
    When it is detected, the right thing to do is to drop all connected and
    disconnected commands. The code for that is already present so refactor it and
    call it when SR_RST is set.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7459de2fceee874ba1ba2ba7d825290d9d141a54
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Handle BUS FREE during reselection
    
    [ Upstream commit ca694afad707cb3ae2fdef3b28454444d9ac726e ]
    
    The X3T9.2 specification (draft) says, under "6.1.4.2 RESELECTION time-out
    procedure", that a target may assert RST or go to BUS FREE phase if the
    initiator does not respond within 200 us. Something like this has been
    observed with AztecMonster II target. When it happens, all we can do is wait
    for the target to try again.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7f4e28afab0d11132abb9696fe552533f511add6
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Don't call dsprintk() following reselection interrupt
    
    [ Upstream commit 08267216b3f8aa5adc204bdccf8deb72c1cd7665 ]
    
    The X3T9.2 specification (draft) says, under "6.1.4.1 RESELECTION",
    
        ... The reselected initiator shall then assert the BSY signal
        within a selection abort time of its most recent detection of being
        reselected; this is required for correct operation of the time-out
        procedure.
    
    The selection abort time is only 200 us which may be insufficient time for a
    printk() call. Move the diagnostics to the error paths.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d0d7a75816be2fb2b70619c9542f5c0a9e70e058
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Don't clear busy flag when abort fails
    
    [ Upstream commit 45ddc1b24806cc8f1a09f23dd4e7b6e4a8ae36e1 ]
    
    When NCR5380_abort() returns FAILED, the driver forgets that the target is
    still busy. Hence, further commands may be sent to the target, which may fail
    during selection and produce the error message, "reselection after won
    arbitration?". Prevent this by leaving the busy flag set when NCR5380_abort()
    fails.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1975b27cad1a7d6b7ea475d43e7718da88837ca0
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Check for invalid reselection target
    
    [ Upstream commit 7ef55f6744c45e3d7c85a3f74ada39b67ac741dd ]
    
    The X3T9.2 specification (draft) says, under "6.1.4.1 RESELECTION", that "the
    initiator shall not respond to a RESELECTION phase if other than two SCSI ID
    bits are on the DATA BUS." This issue (too many bits set) has been observed in
    the wild, so add a check.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f41f9548e8a8ea1d4d00eace7f268c28a904eac5
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Use DRIVER_SENSE to indicate valid sense data
    
    [ Upstream commit 070356513963be6196142acff56acc8359069fa1 ]
    
    When sense data is valid, call set_driver_byte(cmd, DRIVER_SENSE).  Otherwise
    some callers of scsi_execute() will ignore sense data.  Don't set DID_ERROR or
    DID_RESET just because sense data is missing.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7717d068005234836bc94b4d0b721e5ad249b06b
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Withhold disconnect privilege for REQUEST SENSE
    
    [ Upstream commit 7c8ed783c2faa1e3f741844ffac41340338ea0f4 ]
    
    This is mostly needed because an AztecMonster II target has been observed
    disconnecting REQUEST SENSE commands and then failing to reselect properly.
    
    Suggested-by: Michael Schmitz <schmitzmic@gmail.com>
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9a24e85568a3635f54269f9ddfb6eb0b19f1ceb7
Author: Finn Thain <fthain@telegraphics.com.au>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Have NCR5380_select() return a bool
    
    [ Upstream commit dad8261e643849ea134c7cd5c8e794e31d93b9eb ]
    
    The return value is taken to mean "retry" or "don't retry". Change it to bool
    to improve readability. Fix related comments. No functional change.
    
    Tested-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9c71829435fc21a454786599c5a3a80cf3a3ae8e
Author: Hannes Reinecke <hare@suse.com>
Date:   Thu Sep 27 11:17:11 2018 +1000

    scsi: NCR5380: Clear all unissued commands on host reset
    
    [ Upstream commit 1aeeeed7f03c576f096eede7b0384f99a98f588c ]
    
    When doing a host reset we should be clearing all outstanding commands, not
    just the command triggering the reset.
    
    [mkp: adjusted Hannes' SoB address]
    
    Signed-off-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Cc: Ondrey Zary <linux@rainbow-software.org>
    Signed-off-by: Finn Thain <fthain@telegraphics.com.au>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 423d05a3fc5f1d0212eca3a2b7344f900fb9857f
Author: Ilan Peer <ilan.peer@intel.com>
Date:   Mon Jun 11 14:05:11 2018 +0300

    iwlwifi: mvm: Allow TKIP for AP mode
    
    [ Upstream commit 6f3df8c1192c873a6ad9a76328920f6f85af90a8 ]
    
    Support for setting keys for TKIP cipher suite was mistakenly removed
    for AP mode. Fix this.
    
    Fixes: 85aeb58cec1a ("iwlwifi: mvm: Enable security on new TX API")
    Signed-off-by: Ilan Peer <ilan.peer@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0391334d04bc6c79ea155cc43465c319075bcde4
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Wed May 30 14:13:18 2018 +0200

    iwlwifi: api: annotate compressed BA notif array sizes
    
    [ Upstream commit 6f68cc367ab6578a33cca21b6056804165621f00 ]
    
    Annotate the compressed BA notification array sizes and
    make both of them 0-length since the length of 1 is just
    confusing - it may be different than that and the offset
    to the second one needs to be calculated in the C code
    anyhow.
    
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a13fef816458140e4ace805d757fc445429d1393
Author: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
Date:   Tue May 29 10:04:16 2018 +0300

    iwlwifi: dbg: don't crash if the firmware crashes in the middle of a debug dump
    
    [ Upstream commit 79f25b10c9da3dbc953e47033d0494e51580ac3b ]
    
    We can dump data from the firmware either when it crashes,
    or when the firmware is alive.
    Not all the data is available if the firmware is running
    (like the Tx / Rx FIFOs which are available only when the
    firmware is halted), so we first check that the firmware
    is alive to compute the required size for the dump and then
    fill the buffer with the data.
    
    When we allocate the buffer, we test the STATUS_FW_ERROR
    bit to check if the firmware is alive or not. This bit
    can be changed during the course of the dump since it is
    modified in the interrupt handler.
    
    We hit a case where we allocate the buffer while the
    firmware is sill working, and while we start to fill the
    buffer, the firmware crashes. Then we test STATUS_FW_ERROR
    again and decide to fill the buffer with data like the
    FIFOs even if no room was allocated for this data in the
    buffer. This means that we overflow the buffer that was
    allocated leading to memory corruption.
    
    To fix this, test the STATUS_FW_ERROR bit only once and
    rely on local variables to check if we should dump fifos
    or other firmware components.
    
    Fixes: 04fd2c28226f ("iwlwifi: mvm: add rxf and txf to dump data")
    Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6081558fa8eaff568e44afedbf867937035283c9
Author: Dan Aloni <dan@kernelim.com>
Date:   Mon Sep 17 20:24:32 2018 +0300

    crypto: fix a memory leak in rsa-kcs1pad's encryption mode
    
    [ Upstream commit 3944f139d5592790b70bc64f197162e643a8512b ]
    
    The encryption mode of pkcs1pad never uses out_sg and out_buf, so
    there's no need to allocate the buffer, which presently is not even
    being freed.
    
    CC: Herbert Xu <herbert@gondor.apana.org.au>
    CC: linux-crypto@vger.kernel.org
    CC: "David S. Miller" <davem@davemloft.net>
    Signed-off-by: Dan Aloni <dan@kernelim.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9f5f7e9fe2a155463cb9ab20f58c6f2ead2ed394
Author: Christoph Manszewski <c.manszewski@samsung.com>
Date:   Mon Sep 17 17:09:28 2018 +0200

    crypto: s5p-sss: Fix Fix argument list alignment
    
    [ Upstream commit 6c12b6ba45490eeb820fdceccf5a53f42a26799c ]
    
    Fix misalignment of continued argument list.
    
    Signed-off-by: Christoph Manszewski <c.manszewski@samsung.com>
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Acked-by: Kamil Konieczny <k.konieczny@partner.samsung.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6827e0b4692eaf496da6cfd1cd71dd26a8132d9c
Author: Dexuan Cui <decui@microsoft.com>
Date:   Tue Sep 18 22:29:50 2018 +0000

    x86/hyperv: Suppress "PCI: Fatal: No config space access function found"
    
    [ Upstream commit 2f285f46240d67060061d153786740d4df53cd78 ]
    
    A Generation-2 Linux VM on Hyper-V doesn't have the legacy PCI bus, and
    users always see the scary warning, which is actually harmless.
    
    Suppress it.
    
    Signed-off-by: Dexuan Cui <decui@microsoft.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Reviewed-by: Michael Kelley <mikelley@microsoft.com>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: KY Srinivasan <kys@microsoft.com>
    Cc: Haiyang Zhang <haiyangz@microsoft.com>
    Cc: Stephen Hemminger <sthemmin@microsoft.com>
    Cc: "devel@linuxdriverproject.org" <devel@linuxdriverproject.org>
    Cc: Olaf Aepfle <olaf@aepfle.de>
    Cc: Andy Whitcroft <apw@canonical.com>
    Cc: Jason Wang <jasowang@redhat.com>
    Cc: Vitaly Kuznetsov <vkuznets@redhat.com>
    Cc: Marcelo Cerri <marcelo.cerri@canonical.com>
    Cc: Josh Poulson <jopoulso@microsoft.com>
    Link: https://lkml.kernel.org/r/ <KU1P153MB0166D977DC930996C4BF538ABF1D0@KU1P153MB0166.APCP153.PROD.OUTLOOK.COM
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 433a53dc26330e53bded59c4ac31e274ceb8f86e
Author: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Date:   Tue Sep 4 13:39:22 2018 +0300

    Bluetooth: L2CAP: Detect if remote is not able to use the whole MPS
    
    [ Upstream commit a5c3021bb62b970713550db3f7fd08aa70665d7e ]
    
    If the remote is not able to fully utilize the MPS choosen recalculate
    the credits based on the actual amount it is sending that way it can
    still send packets of MTU size without credits dropping to 0.
    
    Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 191e19752460e0cabfe0a95a75a9a1ddd9b1cdd7
Author: Balakrishna Godavarthi <bgodavar@codeaurora.org>
Date:   Wed Aug 22 17:34:11 2018 +0530

    Bluetooth: hci_serdev: clear HCI_UART_PROTO_READY to avoid closing proto races
    
    [ Upstream commit 7cf7846d27bfc9731e449857db3eec5e0e9701ba ]
    
    Clearing HCI_UART_PROTO_READY will avoid usage of proto function pointers
    before running the proto close function pointer. There is chance of kernel
    crash, due to usage of non proto close function pointers after proto close.
    
    Signed-off-by: Balakrishna Godavarthi <bgodavar@codeaurora.org>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a8d3a42686e1c32e01f198e6af6af51ae03cfdb2
Author: Stuart Hayes <stuart.w.hayes@gmail.com>
Date:   Wed Sep 26 16:50:17 2018 -0500

    firmware: dell_rbu: Make payload memory uncachable
    
    [ Upstream commit 6aecee6ad41cf97c0270f72da032c10eef025bf0 ]
    
    The dell_rbu driver takes firmware update payloads and puts them in memory so
    the system BIOS can find them after a reboot.  This sometimes fails (though
    rarely), because the memory containing the payload is in the CPU cache but
    never gets written back to main memory before the system is rebooted (CPU
    cache contents are lost on reboot).
    
    With this patch, the payload memory will be changed to uncachable to ensure
    that the payload is actually in main memory before the system is rebooted.
    
    Signed-off-by: Stuart Hayes <stuart.w.hayes@gmail.com>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3365b4bc9b56fd0dcb5346e48d423eeb39e3b32f
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:26 2018 -0500

    ARM: dts: realview: Fix SPI controller node names
    
    [ Upstream commit 016add12977bcc30f77d7e48fc9a3a024cb46645 ]
    
    SPI controller nodes should be named 'spi' rather than 'ssp'. Fixing the
    name enables dtc SPI bus checks.
    
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 05b2e15620b3080787d26de7d700f5ba867d850a
Author: Justin Ernst <justin.ernst@hpe.com>
Date:   Tue Sep 25 09:34:49 2018 -0500

    EDAC: Raise the maximum number of memory controllers
    
    [ Upstream commit 6b58859419554fb824e09cfdd73151a195473cbc ]
    
    We observe an oops in the skx_edac module during boot:
    
      EDAC MC0: Giving out device to module skx_edac controller Skylake Socket#0 IMC#0
      EDAC MC1: Giving out device to module skx_edac controller Skylake Socket#0 IMC#1
      EDAC MC2: Giving out device to module skx_edac controller Skylake Socket#1 IMC#0
      ...
      EDAC MC13: Giving out device to module skx_edac controller Skylake Socket#0 IMC#1
      EDAC MC14: Giving out device to module skx_edac controller Skylake Socket#1 IMC#0
      EDAC MC15: Giving out device to module skx_edac controller Skylake Socket#1 IMC#1
      Too many memory controllers: 16
      EDAC MC: Removed device 0 for skx_edac Skylake Socket#0 IMC#0
    
    We observe there are two memory controllers per socket, with a limit
    of 16. Raise the maximum number of memory controllers from 16 to 2 *
    MAX_NUMNODES (1024).
    
    [ bp: This is just a band-aid fix until we've sorted out the whole issue
      with the bus_type association and handling in EDAC and can get rid of
      this arbitrary limit. ]
    
    Signed-off-by: Justin Ernst <justin.ernst@hpe.com>
    Signed-off-by: Borislav Petkov <bp@suse.de>
    Acked-by: Russ Anderson <russ.anderson@hpe.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: linux-edac@vger.kernel.org
    Link: https://lkml.kernel.org/r/20180925143449.284634-1-justin.ernst@hpe.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 34ef1373863cdadb1653f32886f25c3a8e323f6c
Author: Chao Yu <chao@kernel.org>
Date:   Tue Sep 25 15:36:03 2018 +0800

    f2fs: mark inode dirty explicitly in recover_inode()
    
    [ Upstream commit 4a1728cad6340bfbe17bd17fd158b2165cd99508 ]
    
    Mark inode dirty explicitly in the end of recover_inode() to make sure
    that all recoverable fields can be persisted later.
    
    Signed-off-by: Chao Yu <yuchao0@huawei.com>
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 471d39b9f0df0719e547e26fe651bc89338ce098
Author: Chao Yu <chao@kernel.org>
Date:   Tue Sep 25 15:35:58 2018 +0800

    f2fs: fix to recover inode's project id during POR
    
    [ Upstream commit f4474aa6e5e901ee4af21f39f1b9115aaaaec503 ]
    
    Testcase to reproduce this bug:
    1. mkfs.f2fs -O extra_attr -O project_quota /dev/sdd
    2. mount -t f2fs /dev/sdd /mnt/f2fs
    3. touch /mnt/f2fs/file
    4. sync
    5. chattr -p 1 /mnt/f2fs/file
    6. xfs_io -f /mnt/f2fs/file -c "fsync"
    7. godown /mnt/f2fs
    8. umount /mnt/f2fs
    9. mount -t f2fs /dev/sdd /mnt/f2fs
    10. lsattr -p /mnt/f2fs/file
    
        0 -----------------N- /mnt/f2fs/file
    
    But actually, we expect the correct result is:
    
        1 -----------------N- /mnt/f2fs/file
    
    The reason is we didn't recover inode.i_projid field during mount,
    fix it.
    
    Signed-off-by: Chao Yu <yuchao0@huawei.com>
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5c33279d8b5c5f0f7c7e8513aec6a71c0e5e7d7d
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 26 17:13:05 2018 +0800

    net: faraday: fix return type of ndo_start_xmit function
    
    [ Upstream commit 0a715156656bddf4aa92d9868f850aeeb0465fd0 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit da4947410e512cbb9e2c6016d7598d2967f11560
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 26 17:06:29 2018 +0800

    net: smsc: fix return type of ndo_start_xmit function
    
    [ Upstream commit 6323d57f335ce1490d025cacc83fc10b07792130 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6fa9a0023e331aeed0f7a94c7f719dc94240b308
Author: Marc Dietrich <marvin24@gmx.de>
Date:   Thu Aug 2 10:45:40 2018 +0200

    ARM: dts: paz00: fix wakeup gpio keycode
    
    [ Upstream commit ebea2a43fdafdbce918bd7e200b709d6c33b9f3b ]
    
    The power key is controlled solely by the EC, which only tiggeres this
    gpio after wakeup.
    Fixes immediately return to suspend after wake from LP1.
    
    Signed-off-by: Marc Dietrich <marvin24@gmx.de>
    Tested-by: Nicolas Chauvet <kwizart@gmail.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5377c07d286b7caf6aff40289800a51fd2068c29
Author: Marcel Ziswiler <marcel.ziswiler@toradex.com>
Date:   Fri Aug 31 18:37:43 2018 +0200

    ARM: tegra: apalis_t30: fix mmc1 cmd pull-up
    
    [ Upstream commit 1c997fe4becdc6fcbc06e23982ceb65621e6572a ]
    
    Fix MMC1 cmd pin pull-up causing issues on carrier boards without
    external pull-up.
    
    Signed-off-by: Marcel Ziswiler <marcel.ziswiler@toradex.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cdd4bea5912cf9353f98728e671fbf319193b2f4
Author: Marcel Ziswiler <marcel.ziswiler@toradex.com>
Date:   Fri Aug 31 14:42:33 2018 +0200

    ARM: dts: tegra30: fix xcvr-setup-use-fuses
    
    [ Upstream commit 564706f65cda3de52b09e51feb423a43940fe661 ]
    
    There was a dot instead of a comma. Fix this.
    
    Signed-off-by: Marcel Ziswiler <marcel.ziswiler@toradex.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7d2bd594292dc12dbb3f93eacf688736c0ce338b
Author: Hauke Mehrtens <hauke@hauke-m.de>
Date:   Tue Sep 25 21:54:07 2018 +0200

    phy: lantiq: Fix compile warning
    
    [ Upstream commit 3a00dae006623d799266d85f28b5f76ef07d6b6c ]
    
    This local variable is unused, remove it.
    
    Fixes: dea54fbad332 ("phy: Add an USB PHY driver for the Lantiq SoCs using the RCU module")
    Signed-off-by: Hauke Mehrtens <hauke@hauke-m.de>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 001824a26e4cafc31bc3778fea272989fdbb0165
Author: Jason Yan <yanaijie@huawei.com>
Date:   Tue Sep 25 10:56:52 2018 +0800

    scsi: libsas: always unregister the old device if going to discover new
    
    [ Upstream commit 32c850bf587f993b2620b91e5af8a64a7813f504 ]
    
    If we went into sas_rediscover_dev() the attached_sas_addr was already insured
    not to be zero. So it's unnecessary to check if the attached_sas_addr is zero.
    
    And although if the sas address is not changed, we always have to unregister
    the old device when we are going to register a new one. We cannot just leave
    the device there and bring up the new.
    
    Signed-off-by: Jason Yan <yanaijie@huawei.com>
    CC: chenxiang <chenxiang66@hisilicon.com>
    CC: John Garry <john.garry@huawei.com>
    CC: Johannes Thumshirn <jthumshirn@suse.de>
    CC: Ewan Milne <emilne@redhat.com>
    CC: Christoph Hellwig <hch@lst.de>
    CC: Tomas Henzl <thenzl@redhat.com>
    CC: Dan Williams <dan.j.williams@intel.com>
    CC: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d7bb792bc8ff8e96ea344f6752d7749f82e1ff46
Author: Alex Williamson <alex.williamson@redhat.com>
Date:   Tue Sep 25 13:01:27 2018 -0600

    vfio/pci: Mask buggy SR-IOV VF INTx support
    
    [ Upstream commit db04264fe9bc0f2b62e036629f9afb530324b693 ]
    
    The SR-IOV spec requires that VFs must report zero for the INTx pin
    register as VFs are precluded from INTx support.  It's much easier for
    the host kernel to understand whether a device is a VF and therefore
    whether a non-zero pin register value is bogus than it is to do the
    same in userspace.  Override the INTx count for such devices and
    virtualize the pin register to provide a consistent view of the device
    to the user.
    
    As this is clearly a spec violation, warn about it to support hardware
    validation, but also provide a known whitelist as it doesn't do much
    good to continue complaining if the hardware vendor doesn't plan to
    fix it.
    
    Known devices with this issue: 8086:270c
    
    Tested-by: Gage Eads <gage.eads@intel.com>
    Reviewed-by: Ashok Raj <ashok.raj@intel.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f1b10ba5739440ca51d66f0b2949cead88d2dd02
Author: Li Qiang <liq3ea@gmail.com>
Date:   Tue Sep 25 13:01:27 2018 -0600

    vfio/pci: Fix potential memory leak in vfio_msi_cap_len
    
    [ Upstream commit 30ea32ab1951c80c6113f300fce2c70cd12659e4 ]
    
    Free allocated vdev->msi_perm in error path.
    
    Signed-off-by: Li Qiang <liq3ea@gmail.com>
    Reviewed-by: Eric Auger <eric.auger@redhat.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4cb9af0d93bd98fde55492885458f58fcf370b28
Author: zhong jiang <zhongjiang@huawei.com>
Date:   Thu Sep 20 10:29:13 2018 +0800

    misc: genwqe: should return proper error value.
    
    [ Upstream commit 02241995b004faa7d9ff628e97f24056190853f8 ]
    
    The function should return -EFAULT when copy_from_user fails. Even
    though the caller does not distinguish them. but we should keep backward
    compatibility.
    
    Signed-off-by: zhong jiang <zhongjiang@huawei.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0038e0fca9dc59569be43db00db659d6066831cc
Author: Laura Abbott <labbott@redhat.com>
Date:   Tue Sep 11 10:44:03 2018 -0700

    misc: kgdbts: Fix restrict error
    
    [ Upstream commit fa0218ef733e6f247a1a3986e3eb12460064ac77 ]
    
    kgdbts current fails when compiled with restrict:
    
    drivers/misc/kgdbts.c: In function ‘configure_kgdbts’:
    drivers/misc/kgdbts.c:1070:2: error: ‘strcpy’ source argument is the same as destination [-Werror=restrict]
      strcpy(config, opt);
      ^~~~~~~~~~~~~~~~~~~
    
    As the error says, config is being used in both the source and destination.
    Refactor the code to avoid the extra copy and put the parsing closer to
    the actual location.
    
    Signed-off-by: Laura Abbott <labbott@redhat.com>
    Acked-by: Daniel Thompson <daniel.thompson@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3cd8af57e0f57098c340657f6870f5614c1230c7
Author: Leo Yan <leo.yan@linaro.org>
Date:   Thu Sep 20 13:18:02 2018 -0600

    coresight: tmc: Fix byte-address alignment for RRP
    
    [ Upstream commit e7753f3937610633a540f2be81be87531f96ff04 ]
    
    >From the comment in the code, it claims the requirement for byte-address
    alignment for RRP register: 'for 32-bit, 64-bit and 128-bit wide trace
    memory, the four LSBs must be 0s. For 256-bit wide trace memory, the
    five LSBs must be 0s'.  This isn't consistent with the program, the
    program sets five LSBs as zeros for 32/64/128-bit wide trace memory and
    set six LSBs zeros for 256-bit wide trace memory.
    
    After checking with the CoreSight Trace Memory Controller technical
    reference manual (ARM DDI 0461B, section 3.3.4 RAM Read Pointer
    Register), it proves the comment is right and the program does wrong
    setting.
    
    This patch fixes byte-address alignment for RRP by following correct
    definition in the technical reference manual.
    
    Cc: Mathieu Poirier <mathieu.poirier@linaro.org>
    Cc: Mike Leach <mike.leach@linaro.org>
    Signed-off-by: Leo Yan <leo.yan@linaro.org>
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ff39cce5c3e50b58443f44d9501f1c2b1f1cf8d3
Author: Tomasz Nowicki <tnowicki@caviumnetworks.com>
Date:   Thu Sep 20 13:18:00 2018 -0600

    coresight: etm4x: Configure EL2 exception level when kernel is running in HYP
    
    [ Upstream commit b860801e3237ec4c74cf8de0be4816996757ae5c ]
    
    For non-VHE systems host kernel runs at EL1 and jumps to EL2 whenever
    hypervisor code should be executed. In this case ETM4x driver must
    restrict configuration to EL1 when it setups kernel tracing.
    However, there is no separate hypervisor privilege level when VHE
    is enabled, the host kernel runs at EL2.
    
    This patch fixes configuration of TRCACATRn register for VHE systems
    so that ETM_EXLEVEL_NS_HYP bit is used instead of ETM_EXLEVEL_NS_OS
    to on/off kernel tracing. At the same time, it moves common code
    to new helper.
    
    Signed-off-by: Tomasz Nowicki <tnowicki@caviumnetworks.com>
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit af525b7dcfc09a48d1a570d6c6f2961ff4f640b7
Author: Suzuki K Poulose <suzuki.poulose@arm.com>
Date:   Thu Sep 20 13:17:50 2018 -0600

    coresight: perf: Disable trace path upon source error
    
    [ Upstream commit 4f8ef21007531c3d7cb5b826e7b2c8999b65ecae ]
    
    We enable the trace path, before activating the source.
    If we fail to enable the source, we must disable the path
    to make sure it is available for another session.
    
    Cc: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Suzuki K Poulose <suzuki.poulose@arm.com>
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b6d0dacc13bd1f69eca981d62ab1445046ff3953
Author: Suzuki K Poulose <suzuki.poulose@arm.com>
Date:   Thu Sep 20 13:17:47 2018 -0600

    coresight: perf: Fix per cpu path management
    
    [ Upstream commit 5ecabe4a76e8cdb61fa3e24862d9ca240a1c4ddf ]
    
    We create a coresight trace path for each online CPU when
    we start the event. We rely on the number of online CPUs
    and then go on to allocate an array matching the "number of
    online CPUs" for holding the path and then uses normal
    CPU id as the index to the array. This is problematic as
    we could have some offline CPUs causing us to access beyond
    the actual array size (e.g, on a dual SMP system, if CPU0 is
    offline, CPU1 could be really accessing beyond the array).
    The solution is to switch to per-cpu array for holding the path.
    
    Cc: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Suzuki K Poulose <suzuki.poulose@arm.com>
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bd1810421faad894bac51a378889665b3de476d8
Author: Suzuki K Poulose <suzuki.poulose@arm.com>
Date:   Thu Sep 20 13:17:45 2018 -0600

    coresight: Fix handling of sinks
    
    [ Upstream commit c71369de02b285d9da526a526d8f2affc7b17c59 ]
    
    The coresight components could be operated either in sysfs mode or in perf
    mode. For some of the components, the mode of operation doesn't matter as
    they simply relay the data to the next component in the trace path. But for
    sinks, they need to be able to provide the trace data back to the user.
    Thus we need to make sure that "mode" is handled appropriately. e.g,
    the sysfs mode could have multiple sources driving the trace data, while
    perf mode doesn't allow sharing the sink.
    
    The coresight_enable_sink() however doesn't really allow this check to
    trigger as it skips the "enable_sink" callback if the component is
    already enabled, irrespective of the mode. This could cause mixing
    of data from different modes or even same mode (in perf), if the
    sources are different. Also, if we fail to enable the sink while
    enabling a path (where sink is the first component enabled),
    we could end up in disabling the components in the "entire"
    path which were not enabled in this trial, causing disruptions
    in the existing trace paths.
    
    Cc: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Suzuki K Poulose <suzuki.poulose@arm.com>
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8049910f4f01fffe808df1978e1f1597058a0340
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Fri Aug 10 15:44:57 2018 +0300

    usb: gadget: uvc: Only halt video streaming endpoint in bulk mode
    
    [ Upstream commit 8dbf9c7abefd5c1434a956d5c6b25e11183061a3 ]
    
    When USB requests for video data fail to be submitted, the driver
    signals a problem to the host by halting the video streaming endpoint.
    This is only valid in bulk mode, as isochronous transfers have no
    handshake phase and can't thus report a stall. The usb_ep_set_halt()
    call returns an error when using isochronous endpoints, which we happily
    ignore, but some UDCs complain in the kernel log. Fix this by only
    trying to halt the endpoint in bulk mode.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Reviewed-by: Paul Elder <paul.elder@ideasonboard.com>
    Tested-by: Paul Elder <paul.elder@ideasonboard.com>
    Reviewed-by: Kieran Bingham <kieran.bingham@ideasonboard.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1e61ce9d404511eb6904e79c1c5347f22ef06e8a
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Fri Aug 10 15:42:03 2018 +0300

    usb: gadget: uvc: Factor out video USB request queueing
    
    [ Upstream commit 9d1ff5dcb3cd3390b1e56f1c24ae42c72257c4a3 ]
    
    USB requests for video data are queued from two different locations in
    the driver, with the same code block occurring twice. Factor it out to a
    function.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Reviewed-by: Paul Elder <paul.elder@ideasonboard.com>
    Tested-by: Paul Elder <paul.elder@ideasonboard.com>
    Reviewed-by: Kieran Bingham <kieran.bingham@ideasonboard.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 16f9d73aae71b29157f9ccd6623e6bccbab70c95
Author: Andreas Kemnade <andreas@kemnade.info>
Date:   Sat Sep 22 11:44:05 2018 +0200

    phy: phy-twl4030-usb: fix denied runtime access
    
    [ Upstream commit 6c7103aa026094a4ee2c2708ec6977a6dfc5331d ]
    
    When runtime is not enabled, pm_runtime_get_sync() returns -EACCESS,
    the counter will be incremented but the resume callback not called,
    so enumeration and charging will not start properly.
    To avoid that happen, disable irq on suspend and recheck on resume.
    
    Practically this happens when the device is woken up from suspend by
    plugging in usb.
    
    Signed-off-by: Andreas Kemnade <andreas@kemnade.info>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1ddc4c618dfb74e4f0330e0d6da8fb0917cfbf92
Author: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com>
Date:   Fri Sep 21 20:53:18 2018 +0900

    phy: renesas: rcar-gen3-usb2: fix vbus_ctrl for role sysfs
    
    [ Upstream commit 09938ea9d136243e8d1fed6d4d7a257764f28f6d ]
    
    This patch fixes and issue that the vbus_ctrl is disabled by
    rcar_gen3_init_from_a_peri_to_a_host(), so a usb host cannot
    supply the vbus.
    
    Note that this condition will exit when the otg irq happens
    even if we don't apply this patch.
    
    Fixes: 9bb86777fb71 ("phy: rcar-gen3-usb2: add sysfs for usb role swap")
    Signed-off-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com>
    Reviewed-by: Simon Horman <horms+renesas@verge.net.au>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d2c8e94b586686d2d2f58a1a0b3184036c82359a
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Sep 20 12:16:36 2018 -0700

    phy: brcm-sata: allow PHY_BRCM_SATA driver to be built for DSL SoCs
    
    [ Upstream commit 26728df4b254ae06247726a9a6e64823e39ac504 ]
    
    Broadcom ARM-based DSL SoCs (BCM63xx product line) have the same
    Broadcom SATA PHY that other SoCs are using, make it possible to select
    that driver on these platforms.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 384bf41f4cf60dad4b202a506e34a991c78a3233
Author: Brendan Higgins <brendanhiggins@google.com>
Date:   Fri Sep 21 16:30:50 2018 -0700

    i2c: aspeed: fix invalid clock parameters for very large divisors
    
    [ Upstream commit 17ccba67109cd0631f206cf49e17986218b47854 ]
    
    The function that computes clock parameters from divisors did not
    respect the maximum size of the bitfields that the parameters were
    written to. This fixes the bug.
    
    This bug can be reproduced with (and this fix verified with) the test
    at: https://kunit-review.googlesource.com/c/linux/+/1035/
    
    Discovered-by-KUnit: https://kunit-review.googlesource.com/c/linux/+/1035/
    Signed-off-by: Brendan Higgins <brendanhiggins@google.com>
    Reviewed-by: Jae Hyun Yoo <jae.hyun.yoo@linux.intel.com>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f010f1618e937e0037e53302bb28d57511c30217
Author: Joel Pepper <joel.pepper@rwth-aachen.de>
Date:   Tue May 29 21:02:12 2018 +0200

    usb: gadget: uvc: configfs: Prevent format changes after linking header
    
    [ Upstream commit cb2200f7af8341aaf0c6abd7ba37e4c667c41639 ]
    
    While checks are in place to avoid attributes and children of a format
    being manipulated after the format is linked into the streaming header,
    the linked flag was never actually set, invalidating the protections.
    Update the flag as appropriate in the header link calls.
    
    Signed-off-by: Joel Pepper <joel.pepper@rwth-aachen.de>
    Reviewed-by: Kieran Bingham <kieran.bingham@ideasonboard.com>
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6e1fed986ac9cf32495bcf2b8885611e4b0132fe
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Thu Aug 2 00:14:00 2018 +0300

    usb: gadget: uvc: configfs: Drop leaked references to config items
    
    [ Upstream commit 86f3daed59bceb4fa7981d85e89f63ebbae1d561 ]
    
    Some of the .allow_link() and .drop_link() operations implementations
    call config_group_find_item() and then leak the reference to the
    returned item. Fix this by dropping those references where needed.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Reviewed-by: Kieran Bingham <kieran.bingham@ideasonboard.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b197d34b6083bae1ea368e87c64156719ab94ad7
Author: Heiko Stuebner <heiko@sntech.de>
Date:   Thu Sep 20 11:34:36 2018 +0200

    ARM: dts: rockchip: explicitly set vcc_sd0 pin to gpio on rk3188-radxarock
    
    [ Upstream commit a2df0984e73fd9e1dad5fc3f1c307ec3de395e30 ]
    
    It is good practice to make the setting of gpio-pinctrls explicitly in the
    devicetree, and in this case even necessary.
    Rockchip boards start with iomux settings set to gpio for most pins and
    while the linux pinctrl driver also implicitly sets the gpio function if
    a pin is requested as gpio that is not necessarily true for other drivers.
    
    The issue in question stems from uboot, where the sdmmc_pwr pin is set
    to function 1 (sdmmc-power) by the bootrom when reading the 1st-stage
    loader. The regulator controlled by the pin is active-low though, so
    when the dwmmc hw-block sets its enabled bit, it actually disables the
    regulator. By changing the pin back to gpio we fix that behaviour.
    
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5ccea94cb2c80ecb0d6444e62e2971ef24703769
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Sat Sep 15 02:16:15 2018 -0400

    media: davinci: Fix implicit enum conversion warning
    
    [ Upstream commit 4158757395b300b6eb308fc20b96d1d231484413 ]
    
    Clang warns when one enumerated type is implicitly converted to another.
    
    drivers/media/platform/davinci/vpbe_display.c:524:24: warning: implicit
    conversion from enumeration type 'enum osd_v_exp_ratio' to different
    enumeration type 'enum osd_h_exp_ratio' [-Wenum-conversion]
                            layer_info->h_exp = V_EXP_6_OVER_5;
                                              ~ ^~~~~~~~~~~~~~
    1 warning generated.
    
    This appears to be a copy and paste error judging from the couple of
    lines directly above this statement and the way that height is handled
    in the if block above this one.
    
    Reported-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0b9c70939b60221f2210ef55a325fec6dea8cde1
Author: Brad Love <brad@nextdimension.cc>
Date:   Thu Sep 6 17:07:49 2018 -0400

    media: au0828: Fix incorrect error messages
    
    [ Upstream commit f347596f2bf114a3af3d80201c6e6bef538d884f ]
    
    Correcting red herring error messages.
    
    Where appropriate, replaces au0282_dev_register with:
    - au0828_analog_register
    - au0828_dvb_register
    
    Signed-off-by: Brad Love <brad@nextdimension.cc>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 16afeb2513f8540d7e40aabc7d5bd3413f8a96de
Author: Jia-Ju Bai <baijiaju1990@gmail.com>
Date:   Sat Sep 1 07:44:09 2018 -0400

    media: pci: ivtv: Fix a sleep-in-atomic-context bug in ivtv_yuv_init()
    
    [ Upstream commit 8d11eb847de7d89c2754988c944d51a4f63e219b ]
    
    The driver may sleep in a interrupt handler.
    
    The function call paths (from bottom to top) in Linux-4.16 are:
    
    [FUNC] kzalloc(GFP_KERNEL)
    drivers/media/pci/ivtv/ivtv-yuv.c, 938:
            kzalloc in ivtv_yuv_init
    drivers/media/pci/ivtv/ivtv-yuv.c, 960:
            ivtv_yuv_init in ivtv_yuv_next_free
    drivers/media/pci/ivtv/ivtv-yuv.c, 1126:
            ivtv_yuv_next_free in ivtv_yuv_setup_stream_frame
    drivers/media/pci/ivtv/ivtv-irq.c, 827:
            ivtv_yuv_setup_stream_frame in ivtv_irq_dec_data_req
    drivers/media/pci/ivtv/ivtv-irq.c, 1013:
            ivtv_irq_dec_data_req in ivtv_irq_handler
    
    To fix this bug, GFP_KERNEL is replaced with GFP_ATOMIC.
    
    This bug is found by my static analysis tool DSAC.
    
    Signed-off-by: Jia-Ju Bai <baijiaju1990@gmail.com>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 551345e77a2dcd357be2eba8fb614ccf3db9f813
Author: Vicente Bergas <vicencb@gmail.com>
Date:   Mon Sep 17 15:47:14 2018 +0200

    arm64: dts: rockchip: Fix microSD in rk3399 sapphire board
    
    [ Upstream commit 88a20edf76091ee7f1bb459b89d714d53f0f8940 ]
    
    The microSD card slot in the Sapphire board is not working because of
    several issues:
     1.- The vmmc power supply is missing in the DTS. It is capable of 3.0V
     and has a GPIO-based enable control.
     2.- The vqmmc power supply can provide up to 3.3V, but it is capped in
     the DTS to just 3.0V because of the vmmc capability. This results in a
     conflict from the mmc driver requesting an unsupportable voltage range
     from 3.3V to 3.0V (min > max) as reported in dmesg. So, extend the
     range up to 3.3V. The hw should be able to stand this 0.3V tolerance.
     See mmc_regulator_set_vqmmc in drivers/mmc/core/core.c.
     3.- The card detect signal is non-working. There is a known conflict
     with jtag, but the workaround in drivers/soc/rockchip/grf.c does not
     work. Adding the broken-cd attribute to the DTS fixes the issue.
    
    Signed-off-by: Vicente Bergas <vicencb@gmail.com>
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 27afaf325b06a5899e21084a20ccafb439758114
Author: Dengcheng Zhu <dzhu@wavecomp.com>
Date:   Tue Sep 11 14:49:23 2018 -0700

    MIPS: kexec: Relax memory restriction
    
    [ Upstream commit a6da4d6fdf8bd512c98d3ac7f1d16bc4bb282919 ]
    
    We can rely on the system kernel and the dump capture kernel themselves in
    memory usage.
    
    Being restrictive with 512MB limit may cause kexec tool failure on some
    platforms.
    
    Tested-by: Rachel Mozes <rachel.mozes@intel.com>
    Reported-by: Rachel Mozes <rachel.mozes@intel.com>
    Signed-off-by: Dengcheng Zhu <dzhu@wavecomp.com>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20568/
    Cc: pburton@wavecomp.com
    Cc: ralf@linux-mips.org
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e63d40f685c632ed8e0d7a632e851c741e17cab6
Author: Matthew Whitehead <tedheadster@gmail.com>
Date:   Fri Sep 21 17:20:41 2018 -0400

    x86/CPU: Change query logic so CPUID is enabled before testing
    
    [ Upstream commit 2893cc8ff892fa74972d8dc0e1d0dc65116daaa3 ]
    
    Presently we check first if CPUID is enabled. If it is not already
    enabled, then we next call identify_cpu_without_cpuid() and clear
    X86_FEATURE_CPUID.
    
    Unfortunately, identify_cpu_without_cpuid() is the function where CPUID
    becomes _enabled_ on Cyrix 6x86/6x86L CPUs.
    
    Reverse the calling sequence so that CPUID is first enabled, and then
    check a second time to see if the feature has now been activated.
    
    [ bp: Massage commit message and remove trailing whitespace. ]
    
    Suggested-by: Andy Lutomirski <luto@amacapital.net>
    Signed-off-by: Matthew Whitehead <tedheadster@gmail.com>
    Signed-off-by: Borislav Petkov <bp@suse.de>
    Reviewed-by: Andy Lutomirski <luto@amacapital.net>
    Cc: David Woodhouse <dwmw@amazon.co.uk>
    Cc: H. Peter Anvin <hpa@zytor.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Link: http://lkml.kernel.org/r/20180921212041.13096-3-tedheadster@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9f5fe6d39938cf787a003f2d0e7c49faff093f57
Author: Matthew Whitehead <tedheadster@gmail.com>
Date:   Fri Sep 21 17:20:40 2018 -0400

    x86/CPU: Use correct macros for Cyrix calls
    
    [ Upstream commit 03b099bdcdf7125d4a63dc9ddeefdd454e05123d ]
    
    There are comments in processor-cyrix.h advising you to _not_ make calls
    using the deprecated macros in this style:
    
      setCx86_old(CX86_CCR4, getCx86_old(CX86_CCR4) | 0x80);
    
    This is because it expands the macro into a non-functioning calling
    sequence. The calling order must be:
    
      outb(CX86_CCR2, 0x22);
      inb(0x23);
    
    From the comments:
    
     * When using the old macros a line like
     *   setCx86(CX86_CCR2, getCx86(CX86_CCR2) | 0x88);
     * gets expanded to:
     *  do {
     *    outb((CX86_CCR2), 0x22);
     *    outb((({
     *        outb((CX86_CCR2), 0x22);
     *        inb(0x23);
     *    }) | 0x88), 0x23);
     *  } while (0);
    
    The new macros fix this problem, so use them instead.
    
    Signed-off-by: Matthew Whitehead <tedheadster@gmail.com>
    Signed-off-by: Borislav Petkov <bp@suse.de>
    Reviewed-by: Andy Lutomirski <luto@amacapital.net>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: Jia Zhang <qianyue.zj@alibaba-inc.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Philippe Ombredanne <pombredanne@nexb.com>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Link: http://lkml.kernel.org/r/20180921212041.13096-2-tedheadster@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c2e6ce2eb3631c19974bc5ac2a6206d0b009e3d3
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Fri Sep 21 10:50:32 2018 +0800

    net: freescale: fix return type of ndo_start_xmit function
    
    [ Upstream commit 06983aa526c759ebdf43f202d8d0491d9494e2f4 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 53532b083ab4a5fb223f5a6ece76d554e7cc2757
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Fri Sep 21 10:42:15 2018 +0800

    net: micrel: fix return type of ndo_start_xmit function
    
    [ Upstream commit 2b49117a5abee8478b0470cba46ac74f93b4a479 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 700feda306559979fe5daccefa07365332408f50
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Sep 20 17:05:40 2018 -0700

    net: phy: mdio-bcm-unimac: Allow configuring MDIO clock divider
    
    [ Upstream commit b78ac6ecd1b6b46f8767cbafa95a7b0b51b87ad8 ]
    
    Allow the configuration of the MDIO clock divider when the Device Tree
    contains 'clock-frequency' property (similar to I2C and SPI buses).
    Because the hardware may have lost its state during suspend/resume,
    re-apply the MDIO clock divider upon resumption.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 146fccec7ca7e96848cd696a3279d1f49fddc038
Author: Prashant Bhole <bhole_prashant_q7@lab.ntt.co.jp>
Date:   Thu Sep 20 16:52:03 2018 +0900

    samples/bpf: fix compilation failure
    
    [ Upstream commit 32c009798385ce21080beaa87a9b95faad3acd1e ]
    
    following commit:
    commit d58e468b1112 ("flow_dissector: implements flow dissector BPF hook")
    added struct bpf_flow_keys which conflicts with the struct with
    same name in sockex2_kern.c and sockex3_kern.c
    
    similar to commit:
    commit 534e0e52bc23 ("samples/bpf: fix a compilation failure")
    we tried the rename it "flow_keys" but it also conflicted with struct
    having same name in include/net/flow_dissector.h. Hence renaming the
    struct to "flow_key_record". Also, this commit doesn't fix the
    compilation error completely because the similar struct is present in
    sockex3_kern.c. Hence renaming it in both files sockex3_user.c and
    sockex3_kern.c
    
    Signed-off-by: Prashant Bhole <bhole_prashant_q7@lab.ntt.co.jp>
    Acked-by: Song Liu <songliubraving@fb.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3d30bea686142879f9cf0ec396fb23f08918db66
Author: Shahed Shaikh <Shahed.Shaikh@cavium.com>
Date:   Thu Sep 20 11:22:51 2018 -0700

    bnx2x: Ignore bandwidth attention in single function mode
    
    [ Upstream commit 75a110a1783ef8324ffd763b24f4ac268253cbca ]
    
    This is a workaround for FW bug -
    MFW generates bandwidth attention in single function mode, which
    is only expected to be generated in multi function mode.
    This undesired attention in SF mode results in incorrect HW
    configuration and resulting into Tx timeout.
    
    Signed-off-by: Shahed Shaikh <Shahed.Shaikh@cavium.com>
    Signed-off-by: Ariel Elior <ariel.elior@cavium.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7796870c62b254ea9dcf36f81169124c1e9d3662
Author: Baruch Siach <baruch@tkos.co.il>
Date:   Tue Aug 21 22:12:33 2018 +0300

    ARM: dts: clearfog: fix sdhci supply property name
    
    [ Upstream commit e807f0298144c06740022a2f900d86b7f115595e ]
    
    The vmmc phandle, like all power supply property names, must have the
    '-supply' suffix.
    
    Signed-off-by: Baruch Siach <baruch@tkos.co.il>
    Signed-off-by: Gregory CLEMENT <gregory.clement@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ed5f6f8d4ff4829c30ea7f5b9b3a904d7bbf9eb3
Author: Borislav Petkov <bp@suse.de>
Date:   Tue Sep 4 11:22:12 2018 +0200

    x86/mce-inject: Reset injection struct after injection
    
    [ Upstream commit 7401a633c34adc7aefd3edfec60074cb0475a3e8 ]
    
    Clear the MCE struct which is used for collecting the injection details
    after injection.
    
    Also, populate it with more details from the machine.
    
    Signed-off-by: Borislav Petkov <bp@suse.de>
    Link: https://lkml.kernel.org/r/20180905081954.10391-1-bp@alien8.de
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1190bbd4687704be2a1f352869ae6d6c05bbd00c
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:31 2018 -0500

    ARM: dts: marvell: Fix SPI and I2C bus warnings
    
    [ Upstream commit cf680cc5251487b9a39919c3cda31a108af19cf8 ]
    
    dtc has new checks for I2C and SPI buses. Fix the warnings in node names
    and unit-addresses.
    
    arch/arm/boot/dts/dove-cubox.dtb: Warning (i2c_bus_reg): /i2c-mux/i2c@0/clock-generator: I2C bus unit address format error, expected "60"
    arch/arm/boot/dts/dove-cubox-es.dtb: Warning (i2c_bus_reg): /i2c-mux/i2c@0/clock-generator: I2C bus unit address format error, expected "60"
    arch/arm/boot/dts/dove-cubox.dtb: Warning (spi_bus_bridge): /mbus/internal-regs/spi-ctrl@10600: node name for SPI buses should be 'spi'
    arch/arm/boot/dts/dove-cubox-es.dtb: Warning (spi_bus_bridge): /mbus/internal-regs/spi-ctrl@10600: node name for SPI buses should be 'spi'
    arch/arm/boot/dts/dove-dove-db.dtb: Warning (spi_bus_bridge): /mbus/internal-regs/spi-ctrl@10600: node name for SPI buses should be 'spi'
    arch/arm/boot/dts/dove-sbc-a510.dtb: Warning (spi_bus_bridge): /mbus/internal-regs/spi-ctrl@10600: node name for SPI buses should be 'spi'
    arch/arm/boot/dts/dove-sbc-a510.dtb: Warning (spi_bus_bridge): /mbus/internal-regs/spi-ctrl@14600: node name for SPI buses should be 'spi'
    arch/arm/boot/dts/orion5x-kuroboxpro.dtb: Warning (i2c_bus_reg): /soc/internal-regs/i2c@11000/rtc: I2C bus unit address format error, expected "32"
    arch/arm/boot/dts/orion5x-linkstation-lschl.dtb: Warning (i2c_bus_reg): /soc/internal-regs/i2c@11000/rtc: I2C bus unit address format error, expected "32"
    arch/arm/boot/dts/orion5x-linkstation-lsgl.dtb: Warning (i2c_bus_reg): /soc/internal-regs/i2c@11000/rtc: I2C bus unit address format error, expected "32"
    arch/arm/boot/dts/orion5x-linkstation-lswtgl.dtb: Warning (i2c_bus_reg): /soc/internal-regs/i2c@11000/rtc: I2C bus unit address format error, expected "32"
    
    Cc: Jason Cooper <jason@lakedaemon.net>
    Cc: Andrew Lunn <andrew@lunn.ch>
    Cc: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Cc: Gregory Clement <gregory.clement@bootlin.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Gregory CLEMENT <gregory.clement@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a9791599935f620b3767161b3400fb6515a600cf
Author: Stefan Agner <stefan@agner.ch>
Date:   Sat Sep 15 21:38:25 2018 -0700

    crypto: arm/crc32 - avoid warning when compiling with Clang
    
    [ Upstream commit cd560235d8f9ddd94aa51e1c4dabdf3212b9b241 ]
    
    The table id (second) argument to MODULE_DEVICE_TABLE is often
    referenced otherwise. This is not the case for CPU features. This
    leads to a warning when building the kernel with Clang:
      arch/arm/crypto/crc32-ce-glue.c:239:33: warning: variable
        'crc32_cpu_feature' is not needed and will not be emitted
        [-Wunneeded-internal-declaration]
      static const struct cpu_feature crc32_cpu_feature[] = {
                                      ^
    
    Avoid warnings by using __maybe_unused, similar to commit 1f318a8bafcf
    ("modules: mark __inittest/__exittest as __maybe_unused").
    
    Fixes: 2a9faf8b7e43 ("crypto: arm/crc32 - enable module autoloading based on CPU feature bits")
    Signed-off-by: Stefan Agner <stefan@agner.ch>
    Acked-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 49b12aea4f443aedf531403141eb8862f28734ec
Author: Stefan Agner <stefan@agner.ch>
Date:   Sat Sep 15 21:38:24 2018 -0700

    cpufeature: avoid warning when compiling with clang
    
    [ Upstream commit c785896b21dd8e156326ff660050b0074d3431df ]
    
    The table id (second) argument to MODULE_DEVICE_TABLE is often
    referenced otherwise. This is not the case for CPU features. This
    leads to warnings when building the kernel with Clang:
      arch/arm/crypto/aes-ce-glue.c:450:1: warning: variable
        'cpu_feature_match_AES' is not needed and will not be emitted
        [-Wunneeded-internal-declaration]
      module_cpu_feature_match(AES, aes_init);
      ^
    
    Avoid warnings by using __maybe_unused, similar to commit 1f318a8bafcf
    ("modules: mark __inittest/__exittest as __maybe_unused").
    
    Fixes: 67bad2fdb754 ("cpu: add generic support for CPU feature based module autoloading")
    Signed-off-by: Stefan Agner <stefan@agner.ch>
    Acked-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0abe78e62eada89a6ca4d1e97a7c99eb572bce7e
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Thu Sep 20 16:13:37 2018 -0700

    spi: pic32: Use proper enum in dmaengine_prep_slave_rg
    
    [ Upstream commit 8cfde7847d5ed0bb77bace41519572963e43cd17 ]
    
    Clang warns when one enumerated type is converted implicitly to another:
    
    drivers/spi/spi-pic32.c:323:8: warning: implicit conversion from
    enumeration type 'enum dma_data_direction' to different enumeration type
    'enum dma_transfer_direction' [-Wenum-conversion]
                                              DMA_FROM_DEVICE,
                                              ^~~~~~~~~~~~~~~
    drivers/spi/spi-pic32.c:333:8: warning: implicit conversion from
    enumeration type 'enum dma_data_direction' to different enumeration type
    'enum dma_transfer_direction' [-Wenum-conversion]
                                              DMA_TO_DEVICE,
                                              ^~~~~~~~~~~~~
    2 warnings generated.
    
    Use the proper enums from dma_transfer_direction (DMA_FROM_DEVICE =
    DMA_DEV_TO_MEM = 2, DMA_TO_DEVICE = DMA_MEM_TO_DEV = 1) to satify Clang.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/159
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bb4c022b0d53d80f74046dea8bfcf0c1759126de
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:34 2018 -0500

    ARM: dts: ste: Fix SPI controller node names
    
    [ Upstream commit 2f967f9e9fa076affb711da1a8389b5d33814fc6 ]
    
    SPI controller nodes should be named 'spi' rather than 'ssp'. Fixing the
    name enables dtc SPI bus checks.
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f4b69c0e008b06e50c2f56796d70ef9cbb1c88ae
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Tue Jul 3 10:30:03 2018 +0200

    ARM: dts: ux500: Fix LCDA clock line muxing
    
    [ Upstream commit ecde29569e3484e1d0a032bf4074449bce4d4a03 ]
    
    The "lcdaclk_b_1" group is muxed with the function "lcd"
    but needs a separate entry to be muxed in with "lcda"
    rather than "lcd".
    
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit abaa421d5dc06dde5fa291f47bb6f0c5c92b30c4
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Jun 26 09:50:09 2018 +0200

    ARM: dts: ux500: Correct SCU unit address
    
    [ Upstream commit 2f217d24ecaec2012e628d21e244eef0608656a4 ]
    
    The unit address of the Cortex-A9 SCU device node contains one zero too
    many.  Remove it.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 47df751764700abe7986e4d0cb07d6a5be481c65
Author: Chao Yu <chao@kernel.org>
Date:   Thu Sep 20 17:41:30 2018 +0800

    f2fs: fix to recover inode's uid/gid during POR
    
    [ Upstream commit dc4cd1257c86451cec3e8e352cc376348e4f4af4 ]
    
    Step to reproduce this bug:
    1. logon as root
    2. mount -t f2fs /dev/sdd /mnt;
    3. touch /mnt/file;
    4. chown system /mnt/file; chgrp system /mnt/file;
    5. xfs_io -f /mnt/file -c "fsync";
    6. godown /mnt;
    7. umount /mnt;
    8. mount -t f2fs /dev/sdd /mnt;
    
    After step 8) we will expect file's uid/gid are all system, but during
    recovery, these two fields were not been recovered, fix it.
    
    Signed-off-by: Chao Yu <yuchao0@huawei.com>
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 581bcaf84e4b652655ac3d9de948d1e708147fba
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Sat Sep 8 17:33:40 2018 -0500

    ARM: dts: am335x-evm: fix number of cpsw
    
    [ Upstream commit dcbf6b18d81bcdc51390ca1b258c17e2e13b7d0c ]
    
    am335x-evm has only one CPSW external port physically wired, but DT defines
    2 ext. ports. As result, PHY connection failure reported for the second
    ext. port.
    
    Update DT to reflect am335x-evm board HW configuration, and, while here,
    switch to use phy-handle instead of phy_id.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 18b30a7a81508d85768c46ea61f720f6a5a64de4
Author: Petr Machata <petrm@mellanox.com>
Date:   Thu Sep 20 09:21:24 2018 +0300

    mlxsw: spectrum: Init shaper for TCs 8..15
    
    [ Upstream commit a9f36656b519a9a21309793c306941a3cd0eeb8f ]
    
    With introduction of MC-aware mode to mlxsw, it became necessary to
    configure TCs above 7 as well. There is now code in mlxsw to disable ETS
    for these higher classes, but disablement of max shaper was neglected.
    
    By default, max shaper is currently disabled to begin with, so the
    problem is just cosmetic. However, for symmetry, do like we do for ETS
    configuration, and call mlxsw_sp_port_ets_maxrate_set() for both TC i
    and i + 8.
    
    Signed-off-by: Petr Machata <petrm@mellanox.com>
    Reviewed-by: Jiri Pirko <jiri@mellanox.com>
    Signed-off-by: Ido Schimmel <idosch@mellanox.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0407eece7ea1d27a3206f90dfbf30873c72cc3da
Author: Loic Poulain <loic.poulain@linaro.org>
Date:   Tue Sep 4 17:18:58 2018 +0200

    usb: chipidea: Fix otg event handler
    
    [ Upstream commit 59739131e0ca06db7560f9073fff2fb83f6bc2a5 ]
    
    At OTG work running time, it's possible that several events need to be
    addressed (e.g. ID and VBUS events). The current implementation handles
    only one event at a time which leads to ignoring the other one. Fix it.
    
    Signed-off-by: Loic Poulain <loic.poulain@linaro.org>
    Signed-off-by: Peter Chen <peter.chen@nxp.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c4d64f2d93e1f16c3d8efc3d95461f7f6dbdff65
Author: Nicolas Adell <nicolas.adell@actia.fr>
Date:   Mon Aug 27 15:59:56 2018 +0200

    usb: chipidea: imx: enable OTG overcurrent in case USB subsystem is already started
    
    [ Upstream commit 1dedbdf2bbb1ede8d96f35f9845ecae179dc1988 ]
    
    When initializing the USB subsystem before starting the kernel,
    OTG overcurrent detection is disabled. In case the OTG polarity of
    overcurrent is low active, the overcurrent detection is never enabled
    again and events cannot be reported as expected. Because imx usb
    overcurrent polarity is low active by default, only detection needs
    to be enable in usbmisc init function.
    
    Signed-off-by: Nicolas Adell <nicolas.adell@actia.fr>
    Signed-off-by: Peter Chen <peter.chen@nxp.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 93c6eddad8473bc6582b865200add350ddab40ea
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Wed Sep 19 14:42:50 2018 -0700

    nfp: provide a better warning when ring allocation fails
    
    [ Upstream commit 23d9f5531c7c28546954b0bf332134a9b8a38c0a ]
    
    NFP supports fairly enormous ring sizes (up to 256k descriptors).
    In commit 466271703867 ("nfp: use kvcalloc() to allocate SW buffer
    descriptor arrays") we have started using kvcalloc() functions to
    make sure the allocation of software state arrays doesn't hit
    the MAX_ORDER limit.  Unfortunately, we can't use virtual mappings
    for the DMA region holding HW descriptors.  In case this allocation
    fails instead of the generic (and fairly scary) warning/splat in
    the logs print a helpful message explaining what happened and
    suggesting how to fix it.
    
    Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
    Reviewed-by: Dirk van der Merwe <dirk.vandermerwe@netronome.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 947ef993e0cbd389f25c6deb545fc78bb55f7f55
Author: Jian Shen <shenjian15@huawei.com>
Date:   Wed Sep 19 18:29:58 2018 +0100

    net: hns3: Fix parameter type for q_id in hclge_tm_q_to_qs_map_cfg()
    
    [ Upstream commit 32c7fbc8ffd752c6aa05d2dd7c13b0f0aa00ddaa ]
    
    So far all the places calling hclge_tm_q_to_qs_map_cfg() are assigning
    an u16 type value to "q_id", and in the processing of
    hclge_tm_q_to_qs_map_cfg(), it also converts the "q_id" to le16.
    
    The max tqp number for pf can be more than 256, we should use "u16" to
    store the queue id, instead of "u8", which may cause data lost.
    
    Fixes: 848440544b41 ("net: hns3: Add support of TX Scheduler & Shaper to HNS3 driver")
    Signed-off-by: Jian Shen <shenjian15@huawei.com>
    Signed-off-by: Peng Li <lipeng321@huawei.com>
    Signed-off-by: Salil Mehta <salil.mehta@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f860e746fb08df1dcd3983fe9b604cb5e79b6b52
Author: Fuyun Liang <liangfuyun1@huawei.com>
Date:   Wed Sep 19 18:29:54 2018 +0100

    net: hns3: Fix for setting speed for phy failed problem
    
    [ Upstream commit fd8133148eb6a733f9cfdaecd4d99f378e21d582 ]
    
    The function of genphy_read_status is that reading phy information
    from HW and using these information to update SW variable. If user
    is using ethtool to setting the speed of phy and service task is calling
    by hclge_get_mac_phy_link, the result of speed setting is uncertain.
    Because ethtool cmd will modified phydev and hclge_get_mac_phy_link also
    will modified phydev.
    
    Because phy state machine will update phy link periodically, we can
    just use phydev->link to check the link status. This patch removes
    function call of genphy_read_status. To ensure accuracy, this patch
    adds a phy state check. If phy state is not PHY_RUNNING, we consider
    link is down. Because in some scenarios, phydev->link may be link up,
    but phy state is not PHY_RUNNING. This is just an intermediate state.
    In fact, the link is not ready yet.
    
    Fixes: 46a3df9f9718 ("net: hns3: Add HNS3 Acceleration Engine & Compatibility Layer Support")
    Signed-off-by: Fuyun Liang <liangfuyun1@huawei.com>
    Signed-off-by: Peng Li <lipeng321@huawei.com>
    Signed-off-by: Salil Mehta <salil.mehta@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 53a5d204161bb0ffa4a4791be3ccb92e5b9b7956
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 19 19:21:32 2018 +0800

    net: sun: fix return type of ndo_start_xmit function
    
    [ Upstream commit 0e0cc31f6999df18bb5cfd0bd83c892ed5633975 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, but the implementation in this
    driver returns an 'int'.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Acked-by: Shannon Nelson <shannon.nelson@oracle.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 804a9a60568afd7aa9c9a511e30c460d615157b2
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 19 18:50:17 2018 +0800

    net: amd: fix return type of ndo_start_xmit function
    
    [ Upstream commit fe72352e37ae8478f4c97975a9831f0c50f22e73 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 70c3daaa03e965d3f2bd10696be130b376f73bca
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 19 18:45:12 2018 +0800

    net: broadcom: fix return type of ndo_start_xmit function
    
    [ Upstream commit 0c13b8d1aee87c35a2fbc1d85a1f766227cf54b5 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2cef1eda48328fef25062c75b691b49cee473561
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 19 18:32:40 2018 +0800

    net: xilinx: fix return type of ndo_start_xmit function
    
    [ Upstream commit 81255af8d9d5565004792c295dde49344df450ca ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c2e8f9ed18237079105c9adc8f01942c2a58a6a2
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Sep 19 18:23:39 2018 +0800

    net: toshiba: fix return type of ndo_start_xmit function
    
    [ Upstream commit bacade822524e02f662d88f784d2ae821a5546fb ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, so make sure the implementation in
    this driver has returns 'netdev_tx_t' value, and change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2ed6502bd9dd7f0dd1f0e0e6381d545a4fdcfa79
Author: Andreas Kemnade <andreas@kemnade.info>
Date:   Mon Sep 17 07:00:07 2018 +0200

    power: supply: twl4030_charger: disable eoc interrupt on linear charge
    
    [ Upstream commit 079cdff3d0a09c5da10ae1be35def7a116776328 ]
    
    This avoids getting woken up from suspend after power interruptions
    when the bci wrongly thinks the battery is full just because
    of input current going low because of low input power
    
    Signed-off-by: Andreas Kemnade <andreas@kemnade.info>
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b1fdcfbdb93cc899d19091a2385edb40a07420e3
Author: Andreas Kemnade <andreas@kemnade.info>
Date:   Mon Sep 17 07:20:35 2018 +0200

    power: supply: twl4030_charger: fix charging current out-of-bounds
    
    [ Upstream commit 8314c212f995bc0d06b54ad02ef0ab4089781540 ]
    
    the charging current uses unsigned int variables, if we step back
    if the current is still low, we would run into negative which
    means setting the target to a huge value.
    Better add checks here.
    
    Signed-off-by: Andreas Kemnade <andreas@kemnade.info>
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit dcd758c0346d1f03fca83ac4f5b8b1f589a3cda1
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 15:16:22 2018 -0500

    libfdt: Ensure INT_MAX is defined in libfdt_env.h
    
    [ Upstream commit 53dd9dce6979bc54d64a3a09a2fb20187a025be7 ]
    
    The next update of libfdt has a new dependency on INT_MAX. Update the
    instances of libfdt_env.h in the kernel to either include the necessary
    header with the definition or define it locally.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: linuxppc-dev@lists.ozlabs.org
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 714ab224a8db6e8255c61a42613de9349ceb0bba
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Fri Aug 3 07:05:21 2018 +0530

    OPP: Protect dev_list with opp_table lock
    
    [ Upstream commit 3d2556992a878a2210d3be498416aee39e0c32aa ]
    
    The dev_list needs to be protected with a lock, else we may have
    simultaneous access (addition/removal) to it and that would be racy.
    Extend scope of the opp_table lock to protect dev_list as well.
    
    Tested-by: Niklas Cassel <niklas.cassel@linaro.org>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7dbc3efb7430abdddf0be186bd0ad2611d767d23
Author: Håkon Bugge <Haakon.Bugge@oracle.com>
Date:   Mon Sep 17 16:07:07 2018 +0200

    RDMA/i40iw: Fix incorrect iterator type
    
    [ Upstream commit 802fa45cd320de319e86c93bca72abec028ba059 ]
    
    Commit f27b4746f378 ("i40iw: add connection management code") uses an
    incorrect rcu iterator, whilst holding the rtnl_lock. Since the
    critical region invokes i40iw_manage_qhash(), which is a sleeping
    function, the rcu locking and traversal cannot be used.
    
    Signed-off-by: Håkon Bugge <haakon.bugge@oracle.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9bee4f9f4460db86c47fe01f9671af6a8951efda
Author: Anton Blanchard <anton@samba.org>
Date:   Fri Sep 14 13:36:48 2018 +0930

    powerpc: Fix duplicate const clang warning in user access code
    
    [ Upstream commit e00d93ac9a189673028ac125a74b9bc8ae73eebc ]
    
    This re-applies commit b91c1e3e7a6f ("powerpc: Fix duplicate const
    clang warning in user access code") (Jun 2015) which was undone in
    commits:
      f2ca80905929 ("powerpc/sparse: Constify the address pointer in __get_user_nosleep()") (Feb 2017)
      d466f6c5cac1 ("powerpc/sparse: Constify the address pointer in __get_user_nocheck()") (Feb 2017)
      f84ed59a612d ("powerpc/sparse: Constify the address pointer in __get_user_check()") (Feb 2017)
    
    We see a large number of duplicate const errors in the user access
    code when building with llvm/clang:
    
      include/linux/pagemap.h:576:8: warning: duplicate 'const' declaration specifier [-Wduplicate-decl-specifier]
            ret = __get_user(c, uaddr);
    
    The problem is we are doing const __typeof__(*(ptr)), which will hit
    the warning if ptr is marked const.
    
    Removing const does not seem to have any effect on GCC code
    generation.
    
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2c4c8ad782e4215b6f374535b4cac085e6228aff
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Sep 17 14:14:02 2018 -0500

    powerpc/pseries: Disable CPU hotplug across migrations
    
    [ Upstream commit 85a88cabad57d26d826dd94ea34d3a785824d802 ]
    
    When performing partition migrations all present CPUs must be online
    as all present CPUs must make the H_JOIN call as part of the migration
    process. Once all present CPUs make the H_JOIN call, one CPU is returned
    to make the rtas call to perform the migration to the destination system.
    
    During testing of migration and changing the SMT state we have found
    instances where CPUs are offlined, as part of the SMT state change,
    before they make the H_JOIN call. This results in a hung system where
    every CPU is either in H_JOIN or offline.
    
    To prevent this this patch disables CPU hotplug during the migration
    process.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 87227faf46b25dc70ce50c9d05efa2157917c18a
Author: Nicholas Piggin <npiggin@gmail.com>
Date:   Sat Sep 15 01:30:45 2018 +1000

    powerpc/64s/hash: Fix stab_rr off by one initialization
    
    [ Upstream commit 09b4438db13fa83b6219aee5993711a2aa2a0c64 ]
    
    This causes SLB alloation to start 1 beyond the start of the SLB.
    There is no real problem because after it wraps it stats behaving
    properly, it's just surprisig to see when looking at SLB traces.
    
    Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit be0255db201fab9550cd807a1293d4ec722b6cd5
Author: Breno Leitao <leitao@debian.org>
Date:   Tue Aug 21 15:44:48 2018 -0300

    powerpc/iommu: Avoid derefence before pointer check
    
    [ Upstream commit 984ecdd68de0fa1f63ce205d6c19ef5a7bc67b40 ]
    
    The tbl pointer is being derefenced by IOMMU_PAGE_SIZE prior the check
    if it is not NULL.
    
    Just moving the dereference code to after the check, where there will
    be guarantee that 'tbl' will not be NULL.
    
    Signed-off-by: Breno Leitao <leitao@debian.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3044fbd7a634933479b27081b1d03715c70fe6e1
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Tue Sep 18 14:09:43 2018 +0800

    net: hns3: fix return type of ndo_start_xmit function
    
    [ Upstream commit c9c3941186c5637caed131c4f4064411d6882299 ]
    
    The method ndo_start_xmit() is defined as returning an 'netdev_tx_t',
    which is a typedef for an enum type, also the implementation in this
    driver has returns 'netdev_tx_t' value, so just change the function
    return type to netdev_tx_t.
    
    Found by coccinelle.
    
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8d65f82de9f4cb88c7ee8a7fe1c9112283b5e66d
Author: Corey Minyard <cminyard@mvista.com>
Date:   Thu Jun 21 15:32:48 2018 -0500

    ipmi:dmi: Ignore IPMI SMBIOS entries with a zero base address
    
    [ Upstream commit 1574608f5f4204440d6d9f52b971aba967664764 ]
    
    Looking at logs from systems all over the place, it looks like tons
    of broken systems exist that set the base address to zero.  I can
    only guess that is some sort of non-standard idea to mark the
    interface as not being present.  It can't be zero, anyway, so just
    complain and ignore it.
    
    Signed-off-by: Corey Minyard <cminyard@mvista.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 338856a48f39eba8518893fb0b3ea3f69bb19315
Author: Peter Shih <pihsun@chromium.org>
Date:   Mon Sep 10 11:54:21 2018 +0800

    spi: mediatek: Don't modify spi_transfer when transfer.
    
    [ Upstream commit 00bca73bfca4fb0ab089b94cad0fc83d8b49c25f ]
    
    Mediatek SPI driver modifies some fields (tx_buf, rx_buf, len, tx_dma,
    rx_dma) of the spi_transfer* passed in when doing transfer_one and in
    interrupt handler. This is somewhat unexpected, and there are some
    caller (e.g. Cr50 spi driver) that reuse the spi_transfer for multiple
    messages. Add a field to record how many bytes have been transferred,
    and calculate the right len / buffer based on it instead.
    
    Signed-off-by: Pi-Hsun Shih <pihsun@chromium.org>
    
    Change-Id: I23e218cd964f16c0b2b26127d4a5ca6529867673
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 45503ce9086cabc9b3faaaed4563b2da8af1ffe2
Author: Yonghong Song <yhs@fb.com>
Date:   Mon Sep 17 22:08:13 2018 -0700

    samples/bpf: fix a compilation failure
    
    [ Upstream commit 534e0e52bc23de588e81b5a6f75e10c8c4b189fc ]
    
    samples/bpf build failed with the following errors:
    
      $ make samples/bpf/
      ...
      HOSTCC  samples/bpf/sockex3_user.o
      /data/users/yhs/work/net-next/samples/bpf/sockex3_user.c:16:8: error: redefinition of ‘struct bpf_flow_keys’
       struct bpf_flow_keys {
              ^
      In file included from /data/users/yhs/work/net-next/samples/bpf/sockex3_user.c:4:0:
      ./usr/include/linux/bpf.h:2338:9: note: originally defined here
        struct bpf_flow_keys *flow_keys;
               ^
      make[3]: *** [samples/bpf/sockex3_user.o] Error 1
    
    Commit d58e468b1112d ("flow_dissector: implements flow dissector BPF hook")
    introduced struct bpf_flow_keys in include/uapi/linux/bpf.h and hence
    caused the naming conflict with samples/bpf/sockex3_user.c.
    
    The fix is to rename struct bpf_flow_keys in samples/bpf/sockex3_user.c
    to flow_keys to avoid the conflict.
    
    Signed-off-by: Yonghong Song <yhs@fb.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 73e22730e13e8df275423ff519e19508ea80e19d
Author: Anton Vasilyev <vasilyev@ispras.ru>
Date:   Tue Aug 7 13:59:05 2018 +0300

    serial: mxs-auart: Fix potential infinite loop
    
    [ Upstream commit 5963e8a3122471cadfe0eba41c4ceaeaa5c8bb4d ]
    
    On the error path of mxs_auart_request_gpio_irq() is performed
    backward iterating with index i of enum type. Underline enum type
    may be unsigned char. In this case check (--i >= 0) will be always
    true and error handling goes into infinite loop.
    
    The patch changes the check so that it is valid for signed and unsigned
    types.
    
    Found by Linux Driver Verification project (linuxtesting.org).
    
    Signed-off-by: Anton Vasilyev <vasilyev@ispras.ru>
    Acked-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 925ed8333ee86738c2792e9244c85ec9e8839c2f
Author: Marek Szyprowski <m.szyprowski@samsung.com>
Date:   Thu Sep 13 10:21:25 2018 +0200

    serial: samsung: Enable baud clock for UART reset procedure in resume
    
    [ Upstream commit 1ff3652bc7111df26b5807037f624be294cf69d5 ]
    
    Ensure that the baud clock is also enabled for UART register writes in
    driver resume. On Exynos5433 SoC this is needed to avoid external abort
    issue.
    
    Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9ae8ba50399015352dd9f111ac86a6f49953910d
Author: Nava kishore Manne <nava.manne@xilinx.com>
Date:   Mon Sep 3 15:10:51 2018 +0200

    serial: uartps: Fix suspend functionality
    
    [ Upstream commit 4b9d33c6a30688344a3e95179654ea31b07f59b7 ]
    
    The driver's suspend/resume functions were buggy.
    If UART node contains any child node in the DT and
    the child is established a communication path with
    the parent UART. The relevant /dev/ttyPS* node will
    be not available for other operations.
    If the driver is trying to do any operations like
    suspend/resume without checking the tty->dev status
    it leads to the kernel crash/hang.
    
    This patch fix this issue by call the device_may_wake()
    with the generic parameter of type struct device.
    in the uart suspend and resume paths.
    
    It also fixes a race condition in the uart suspend
    path(i.e uart_suspend_port() should be called at the
    end of cdns_uart_suspend API this path updates the same)
    
    Signed-off-by: Nava kishore Manne <navam@xilinx.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a74a77a5cdd88a807d6f335d506c717c45ea8da6
Author: Sinan Kaya <okaya@kernel.org>
Date:   Fri Aug 10 04:32:11 2018 +0000

    PCI/ACPI: Correct error message for ASPM disabling
    
    [ Upstream commit 1ad61b612b95980a4d970c52022aa01dfc0f6068 ]
    
    If _OSC execution fails today for platforms without an _OSC entry, code is
    printing a misleading message saying disabling ASPM as follows:
    
      acpi PNP0A03:00: _OSC failed (AE_NOT_FOUND); disabling ASPM
    
    We need to ensure that platform supports ASPM to begin with.
    
    Reported-by: Michael Kelley <mikelley@microsoft.com>
    Signed-off-by: Sinan Kaya <okaya@kernel.org>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 56ff8052bee16e7c93ac9d568233e9af9a878f9e
Author: Julian Wiedmann <jwi@linux.ibm.com>
Date:   Mon Sep 17 17:36:06 2018 +0200

    s390/qeth: invoke softirqs after napi_schedule()
    
    [ Upstream commit 4d19db777a2f32c9b76f6fd517ed8960576cb43e ]
    
    Calling napi_schedule() from process context does not ensure that the
    NET_RX softirq is run in a timely fashion. So trigger it manually.
    
    This is no big issue with current code. A call to ndo_open() is usually
    followed by a ndo_set_rx_mode() call, and for qeth this contains a
    spin_unlock_bh(). Except for OSN, where qeth_l2_set_rx_mode() bails out
    early.
    Nevertheless it's best to not depend on this behaviour, and just fix
    the issue at its source like all other drivers do. For instance see
    commit 83a0c6e58901 ("i40e: Invoke softirqs after napi_reschedule").
    
    Fixes: a1c3ed4c9ca0 ("qeth: NAPI support for l2 and l3 discipline")
    Signed-off-by: Julian Wiedmann <jwi@linux.ibm.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 191e8c8865237fdebc8145a6778721b8696210b3
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Fri Oct 19 23:08:43 2018 +0300

    ath9k: Fix a locking bug in ath9k_add_interface()
    
    [ Upstream commit 461cf036057477805a8a391e5fd0f5264a5e56a8 ]
    
    We tried to revert commit d9c52fd17cb4 ("ath9k: fix tx99 with monitor
    mode interface") but accidentally missed part of the locking change.
    
    The lock has to be held earlier so that we're holding it when we do
    "sc->tx99_vif = vif;" and also there in the current code there is a
    stray unlock before we have taken the lock.
    
    Fixes: 6df0580be8bc ("ath9k: add back support for using active monitor interfaces for tx99")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ad196348b6f4a9dad8ba499bc57d4ca9d35453c1
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Sat Sep 8 20:08:13 2018 +0200

    ACPI / LPSS: Exclude I2C busses shared with PUNIT from pmc_atom_d3_mask
    
    [ Upstream commit 86b62e5cd8965d3056f9e9ccdec51631c37add81 ]
    
    lpss_iosf_enter_d3_state() checks if all hw-blocks using the DMA
    controllers are in d3 before powering down the DMA controllers.
    
    But on devices, where the I2C bus connected to the PMIC is shared by
    the PUNIT, the controller for that bus will never reach d3 since it has
    an effectively empty _PS3 method. Instead it appears to automatically
    power-down during S0i3 and we never see it as being in d3.
    
    This causes the DMA controllers to never be powered-down on these devices,
    causing them to never reach S0i3. This commit uses the ACPI _SEM method
    to detect if an I2C bus is shared with the PUNIT and if it is, it removes
    it from the mask of devices which lpss_iosf_enter_d3_state() checks for.
    
    This fixes these devices never reaching any S0ix states.
    
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Acked-by: Mika Westerberg <mika.westerberg@linux.intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bbce829fd3bc194a098aa7c64ca283c133221a0d
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:36 2018 -0500

    ARM: dts: rockchip: Fix erroneous SPI bus dtc warnings on rk3036
    
    [ Upstream commit 131c3eb428ccd5f0c784b9edb4f72ec296a045d2 ]
    
    dtc has new checks for SPI buses. The rk3036 dts file has a node named
    spi' which causes false positive warnings. As the node is a pinctrl child
    node, change the node name to be 'spi-pins' to fix the warnings.
    
    arch/arm/boot/dts/rk3036-evb.dtb: Warning (spi_bus_bridge): /pinctrl/spi: incorrect #address-cells for SPI bus
    arch/arm/boot/dts/rk3036-kylin.dtb: Warning (spi_bus_bridge): /pinctrl/spi: incorrect #address-cells for SPI bus
    arch/arm/boot/dts/rk3036-evb.dtb: Warning (spi_bus_bridge): /pinctrl/spi: incorrect #size-cells for SPI bus
    arch/arm/boot/dts/rk3036-kylin.dtb: Warning (spi_bus_bridge): /pinctrl/spi: incorrect #size-cells for SPI bus
    
    Cc: Heiko Stuebner <heiko@sntech.de>
    Cc: linux-rockchip@lists.infradead.org
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 592f63897b86cac8782b6b28fcc92973c28a3ea8
Author: Haishuang Yan <yanhaishuang@cmss.chinamobile.com>
Date:   Fri Sep 14 12:26:47 2018 +0800

    ip_gre: fix parsing gre header in ipgre_err
    
    [ Upstream commit b0350d51f001e6edc13ee4f253b98b50b05dd401 ]
    
    gre_parse_header stops parsing when csum_err is encountered, which means
    tpi->key is undefined and ip_tunnel_lookup will return NULL improperly.
    
    This patch introduce a NULL pointer as csum_err parameter. Even when
    csum_err is encountered, it won't return error and continue parsing gre
    header as expected.
    
    Fixes: 9f57c67c379d ("gre: Remove support for sharing GRE protocol hook.")
    Reported-by: Jiri Benc <jbenc@redhat.com>
    Signed-off-by: Haishuang Yan <yanhaishuang@cmss.chinamobile.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e32819f088faba6f52251f0a8dafb1b52eebb93b
Author: Bernd Edlinger <bernd.edlinger@hotmail.de>
Date:   Sat Jul 7 17:52:47 2018 +0000

    kernfs: Fix range checks in kernfs_get_target_path
    
    [ Upstream commit a75e78f21f9ad4b810868c89dbbabcc3931591ca ]
    
    The terminating NUL byte is only there because the buffer is
    allocated with kzalloc(PAGE_SIZE, GFP_KERNEL), but since the
    range-check is off-by-one, and PAGE_SIZE==PATH_MAX, the
    returned string may not be zero-terminated if it is exactly
    PATH_MAX characters long.  Furthermore also the initial loop
    may theoretically exceed PATH_MAX and cause a fault.
    
    Signed-off-by: Bernd Edlinger <bernd.edlinger@hotmail.de>
    Acked-by: Tejun Heo <tj@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 10ffb20b918b47c5baf49aa1efe6884672591175
Author: Banajit Goswami <bgoswami@codeaurora.org>
Date:   Mon Aug 27 21:15:39 2018 -0700

    component: fix loop condition to call unbind() if bind() fails
    
    [ Upstream commit bdae566d5d9733b6e32b378668b84eadf28a94d4 ]
    
    During component_bind_all(), if bind() fails for any
    particular component associated with a master, unbind()
    should be called for all previous components in that
    master's match array, whose bind() might have completed
    successfully. As per the current logic, if bind() fails
    for the component at position 'n' in the master's match
    array, it would start calling unbind() from component in
    'n'th position itself and work backwards, and will always
    skip calling unbind() for component in 0th position in the
    master's match array.
    Fix this by updating the loop condition, and the logic to
    refer to the components in master's match array, so that
    unbind() is called for all components starting from 'n-1'st
    position in the array, until (and including) component in
    0th position.
    
    Signed-off-by: Banajit Goswami <bgoswami@codeaurora.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4fd86c4098a5a85b461335cdfcb3419e64c7ac50
Author: Tomasz Figa <tomasz.figa@gmail.com>
Date:   Tue Jul 17 18:05:07 2018 +0200

    power: supply: max8998-charger: Fix platform data retrieval
    
    [ Upstream commit cb90a2c6f77fe9b43d1e3f759bb2f13fe7fa1811 ]
    
    Since the max8998 MFD driver supports instantiation by DT, platform data
    retrieval is handled in MFD probe and cell drivers should get use
    the pdata field of max8998_dev struct to obtain them.
    
    Fixes: ee999fb3f17f ("mfd: max8998: Add support for Device Tree")
    Signed-off-by: Tomasz Figa <tomasz.figa@gmail.com>
    Signed-off-by: Paweł Chmiel <pawel.mikolaj.chmiel@gmail.com>
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3a9539e9ba18703b21b9aa398673179e9c5eabe5
Author: Claudiu Beznea <claudiu.beznea@microchip.com>
Date:   Thu Aug 30 14:50:11 2018 +0300

    power: reset: at91-poweroff: do not procede if at91_shdwc is allocated
    
    [ Upstream commit 9f1e44774be578fb92776add95f1fcaf8284d692 ]
    
    There should be only one instance of struct shdwc in the system. This is
    referenced through at91_shdwc. Return in probe if at91_shdwc is already
    allocated.
    
    Signed-off-by: Claudiu Beznea <claudiu.beznea@microchip.com>
    Acked-by: Nicolas Ferre <nicolas.ferre@microchip.com>
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e0ecbca8ff27376cbaa68e5c64374344b85c760c
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Mon Sep 10 11:39:04 2018 +0300

    power: supply: ab8500_fg: silence uninitialized variable warnings
    
    [ Upstream commit 54baff8d4e5dce2cef61953b1dc22079cda1ddb1 ]
    
    If kstrtoul() fails then we print "charge_full" when it's uninitialized.
    The debug printk doesn't add anything so I deleted it and cleaned these
    two functions up a bit.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Sebastian Reichel <sebastian.reichel@collabora.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 46af2022de198ebbf47141b7b33522e28733045d
Author: Rob Herring <robh@kernel.org>
Date:   Thu Sep 13 13:12:41 2018 -0500

    arm64: dts: meson: Fix erroneous SPI bus warnings
    
    [ Upstream commit 68ecb5c1920c5b98b1e717fd2349fba2ee5d4031 ]
    
    dtc has new checks for SPI buses. The meson dts files have a node named
    spi' which causes false positive warnings. As the node is a pinctrl child
    node, change the node name to be 'spi-pins' to fix the warnings.
    
    arch/arm64/boot/dts/amlogic/meson-gxbb-nanopi-k2.dtb: Warning (spi_bus_bridge): /soc/periphs@c8834000/pinctrl@4b0/spi: incorrect #address-cells for SPI bus
    
    Cc: Carlo Caione <carlo@caione.org>
    Cc: Kevin Hilman <khilman@baylibre.com>
    Cc: linux-amlogic@lists.infradead.org
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f927911d4abad751f877a7edc7261276c266db65
Author: Paolo Valente <paolo.valente@linaro.org>
Date:   Fri Sep 14 16:23:09 2018 +0200

    blok, bfq: do not plug I/O if all queues are weight-raised
    
    [ Upstream commit c8765de0adfcaaf4ffb2d951e07444f00ffa9453 ]
    
    To reduce latency for interactive and soft real-time applications, bfq
    privileges the bfq_queues containing the I/O of these
    applications. These privileged queues, referred-to as weight-raised
    queues, get a much higher share of the device throughput
    w.r.t. non-privileged queues. To preserve this higher share, the I/O
    of any non-weight-raised queue must be plugged whenever a sync
    weight-raised queue, while being served, remains temporarily empty. To
    attain this goal, bfq simply plugs any I/O (from any queue), if a sync
    weight-raised queue remains empty while in service.
    
    Unfortunately, this plugging typically lowers throughput with random
    I/O, on devices with internal queueing (because it reduces the filling
    level of the internal queues of the device).
    
    This commit addresses this issue by restricting the cases where
    plugging is performed: if a sync weight-raised queue remains empty
    while in service, then I/O plugging is performed only if some of the
    active bfq_queues are *not* weight-raised (which is actually the only
    circumstance where plugging is needed to preserve the higher share of
    the throughput of weight-raised queues). This restriction proved able
    to boost throughput in really many use cases needing only maximum
    throughput.
    
    Signed-off-by: Paolo Valente <paolo.valente@linaro.org>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e269eb6f1f7b66df81d063ff91a57a0b4abf111e
Author: Ganesh Goudar <ganeshgr@chelsio.com>
Date:   Fri Sep 14 14:36:27 2018 +0530

    cxgb4: Fix endianness issue in t4_fwcache()
    
    [ Upstream commit 0dc235afc59a226d951352b0adf4a89b532a9d13 ]
    
    Do not put host-endian 0 or 1 into big endian feild.
    
    Reported-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Ganesh Goudar <ganeshgr@chelsio.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ce87ef651769f2276bbbd5e62d5f4ef3d4b87b6c
Author: Ludovic Desroches <ludovic.desroches@microchip.com>
Date:   Thu Sep 13 14:42:13 2018 +0200

    pinctrl: at91: don't use the same irqchip with multiple gpiochips
    
    [ Upstream commit 0c3dfa176912b5f87732545598200fb55e9c1978 ]
    
    Sharing the same irqchip with multiple gpiochips is not a good
    practice. For instance, when installing hooks, we change the state
    of the irqchip. The initial state of the irqchip for the second
    gpiochip to register is then disrupted.
    
    Signed-off-by: Ludovic Desroches <ludovic.desroches@microchip.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b8ba110d14bccb47371e8b790414e2fddc47e9a3
Author: Dinh Nguyen <dinguyen@kernel.org>
Date:   Thu Sep 13 23:52:49 2018 -0500

    ARM: dts: socfpga: Fix I2C bus unit-address error
    
    [ Upstream commit cbbc488ed85061a765cf370c3e41f383c1e0add6 ]
    
    dtc has new checks for I2C buses. Fix the warnings in unit-addresses.
    
    arch/arm/boot/dts/socfpga_cyclone5_de0_sockit.dtb: Warning (i2c_bus_reg): /soc/i2c@ffc04000/adxl345@0: I2C bus unit address format error, expected "53"
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit dc87cafee594a0244824fa5668bf1b3e9540f286
Author: Alan Modra <amodra@gmail.com>
Date:   Fri Sep 14 13:10:04 2018 +0930

    powerpc/vdso: Correct call frame information
    
    [ Upstream commit 56d20861c027498b5a1112b4f9f05b56d906fdda ]
    
    Call Frame Information is used by gdb for back-traces and inserting
    breakpoints on function return for the "finish" command.  This failed
    when inside __kernel_clock_gettime.  More concerning than difficulty
    debugging is that CFI is also used by stack frame unwinding code to
    implement exceptions.  If you have an app that needs to handle
    asynchronous exceptions for some reason, and you are unlucky enough to
    get one inside the VDSO time functions, your app will crash.
    
    What's wrong:  There is control flow in __kernel_clock_gettime that
    reaches label 99 without saving lr in r12.  CFI info however is
    interpreted by the unwinder without reference to control flow: It's a
    simple matter of "Execute all the CFI opcodes up to the current
    address".  That means the unwinder thinks r12 contains the return
    address at label 99.  Disabuse it of that notion by resetting CFI for
    the return address at label 99.
    
    Note that the ".cfi_restore lr" could have gone anywhere from the
    "mtlr r12" a few instructions earlier to the instruction at label 99.
    I put the CFI as late as possible, because in general that's best
    practice (and if possible grouped with other CFI in order to reduce
    the number of CFI opcodes executed when unwinding).  Using r12 as the
    return address is perfectly fine after the "mtlr r12" since r12 on
    that code path still contains the return address.
    
    __get_datapage also has a CFI error.  That function temporarily saves
    lr in r0, and reflects that fact with ".cfi_register lr,r0".  A later
    use of r0 means the CFI at that point isn't correct, as r0 no longer
    contains the return address.  Fix that too.
    
    Signed-off-by: Alan Modra <amodra@gmail.com>
    Tested-by: Reza Arbab <arbab@linux.ibm.com>
    Signed-off-by: Paul Mackerras <paulus@ozlabs.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 58b03626a7b19e6f03533cf728a9790241c3362a
Author: Niklas Cassel <niklas.cassel@linaro.org>
Date:   Wed Aug 29 09:57:21 2018 +0200

    soc: qcom: wcnss_ctrl: Avoid string overflow
    
    [ Upstream commit 4c96ed170d658d8826d94edec8ac93ee777981a2 ]
    
    'chinfo.name' is used as a NUL-terminated string, but using strncpy() with
    the length equal to the buffer size may result in lack of the termination:
    
    drivers//soc/qcom/wcnss_ctrl.c: In function 'qcom_wcnss_open_channel':
    drivers//soc/qcom/wcnss_ctrl.c:284:2: warning: 'strncpy' specified bound 32 equals destination size [-Wstringop-truncation]
      strncpy(chinfo.name, name, sizeof(chinfo.name));
      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    This changes it to use the safer strscpy() instead.
    
    Signed-off-by: Niklas Cassel <niklas.cassel@linaro.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 42fc909019365e3c1087accdeef66e0a8e6b132e
Author: Christian Lamparter <chunkeey@gmail.com>
Date:   Wed Jul 25 10:37:47 2018 +0200

    ARM: dts: qcom: ipq4019: fix cpu0's qcom,saw2 reg value
    
    [ Upstream commit bd73a3dd257fb838bd456a18eeee0ef0224b7a40 ]
    
    while compiling an ipq4019 target, dtc will complain:
    regulator@b089000 unit address format error, expected "2089000"
    
    The saw0 regulator reg value seems to be
    copied and pasted from qcom-ipq8064.dtsi.
    
    This patch fixes the reg value to match that of the
    unit address which in turn silences the warning.
    (There is no driver for qcom,saw2 right now.
    So this went unnoticed)
    
    Signed-off-by: Christian Lamparter <chunkeey@gmail.com>
    Signed-off-by: John Crispin <john@phrozen.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 06f540913df5cfc74a1febc30f2e20f0266c4f52
Author: Cong Wang <xiyou.wangcong@gmail.com>
Date:   Tue Sep 11 11:42:06 2018 -0700

    llc: avoid blocking in llc_sap_close()
    
    [ Upstream commit 9708d2b5b7c648e8e0a40d11e8cea12f6277f33c ]
    
    llc_sap_close() is called by llc_sap_put() which
    could be called in BH context in llc_rcv(). We can't
    block in BH.
    
    There is no reason to block it here, kfree_rcu() should
    be sufficient.
    
    Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e6b8633c15e0586c7cce507cfca060ece5401f5d
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Mon Sep 10 11:37:45 2018 +0300

    pinctrl: at91-pio4: fix has_config check in atmel_pctl_dt_subnode_to_map()
    
    [ Upstream commit b97760ae8e3dc8bb91881c13425a0bff55f2bd85 ]
    
    Smatch complains about this condition:
    
            if (has_config && num_pins >= 1)
    
    The "has_config" variable is either uninitialized or true.  The
    "num_pins" variable is unsigned and we verified that it is non-zero on
    the lines before so we know "num_pines >= 1" is true.  Really, we could
    just check "num_configs" directly and remove the "has_config" variable.
    
    Fixes: 776180848b57 ("pinctrl: introduce driver for Atmel PIO4 controller")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Acked-by: Ludovic Desroches <ludovic.desroches@microchip.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9f66cf82a2333f441b03241f503fab1852273dc0
Author: Takashi Iwai <tiwai@suse.de>
Date:   Tue Aug 28 16:39:10 2018 +0200

    ALSA: intel8x0m: Register irq handler after register initializations
    
    [ Upstream commit 7064f376d4a10686f51c879401a569bb4babf9c6 ]
    
    The interrupt handler has to be acquired after the other resource
    initialization when allocated with IRQF_SHARED.  Otherwise it's
    triggered before the resource gets ready, and may lead to unpleasant
    behavior.
    
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c9e2f562da34ae10d15a5ff3319ee4021c04815a
Author: Jerome Brunet <jbrunet@baylibre.com>
Date:   Thu Aug 30 12:53:17 2018 +0200

    arm64: dts: meson: libretech: update board model
    
    [ Upstream commit b7eb0e26cc4a212fde09144cd49d4103170d2b9e ]
    
    There is actually several different libretech board with the CC suffix
    so the model name is not appropriate here. Update to something more
    specific
    
    Reported-by: Da Xue <da@lessconfused.com>
    Signed-off-by: Jerome Brunet <jbrunet@baylibre.com>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cd5bedea5e5cca50e28571a160a15a7816e8cd09
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 27 15:56:21 2018 -0400

    media: dvb: fix compat ioctl translation
    
    [ Upstream commit 1ccbeeb888ac33627d91f1ccf0b84ef3bcadef24 ]
    
    The VIDEO_GET_EVENT and VIDEO_STILLPICTURE was added back in 2005 but
    it never worked because the command number is wrong.
    
    Using the right command number means we have a better chance of them
    actually doing the right thing, though clearly nobody has ever tried
    it successfully.
    
    I noticed these while auditing the remaining users of compat_time_t
    for y2038 bugs. This one is fine in that regard, it just never did
    anything.
    
    Fixes: 6e87abd0b8cb ("[DVB]: Add compat ioctl handling.")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5e19fb9b965dae63bbb7d7d00698e304b6ebaa79
Author: Lao Wei <zrlw@qq.com>
Date:   Mon Jul 9 08:15:53 2018 -0400

    media: fix: media: pci: meye: validate offset to avoid arbitrary access
    
    [ Upstream commit eac7230fdb4672c2cb56f6a01a1744f562c01f80 ]
    
    Motion eye video4linux driver for Sony Vaio PictureBook desn't validate user-controlled parameter
    'vma->vm_pgoff', a malicious process might access all of kernel memory from user space by trying
    pass different arbitrary address.
    Discussion: http://www.openwall.com/lists/oss-security/2018/07/06/1
    
    Signed-off-by: Lao Wei <zrlw@qq.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9b8ba684bee9254e3a31f4675b7efca7589324d0
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Thu Jun 14 09:48:07 2018 -0400

    media: dt-bindings: adv748x: Fix decimal unit addresses
    
    [ Upstream commit 27582f0ea97fe3e4a38beb98ab36cce4b6f029d5 ]
    
    With recent dtc and W=1:
    
        Warning (graph_port): video-receiver@70/port@10: graph node unit address error, expected "a"
        Warning (graph_port): video-receiver@70/port@11: graph node unit address error, expected "b"
    
    Unit addresses are always hexadecimal (without prefix), while the bases
    of reg property values depend on their prefixes.
    
    Fixes: e69595170b1cad85 ("media: adv748x: Add adv7481, adv7482 bindings")
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Reviewed-by: Rob Herring <robh@kernel.org>
    Reviewed-by: Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3801e9dd95c024c1e284d6ce4e143e9f0eb44223
Author: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
Date:   Tue Aug 7 13:19:35 2018 +0100

    nvmem: core: return error code instead of NULL from nvmem_device_get
    
    [ Upstream commit ca6ac25cecf0e740d7cc8e03e0ebbf8acbeca3df ]
    
    nvmem_device_get() should return ERR_PTR() on error or valid pointer
    on success, but one of the code path seems to return NULL, so fix it.
    
    Reported-by: Niklas Cassel <niklas.cassel@linaro.org>
    Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 57441e0615f155fe8b5002c68a79e61c576e2830
Author: Michael Kelley <mikelley@microsoft.com>
Date:   Fri Aug 10 23:06:11 2018 +0000

    Drivers: hv: vmbus: Fix synic per-cpu context initialization
    
    [ Upstream commit f25a7ece08bdb1f2b3c4bbeae942682fc3a99dde ]
    
    If hv_synic_alloc() errors out, the state of the per-cpu context
    for some CPUs is unknown since the zero'ing is done as each
    CPU is iterated over.  In such case, hv_synic_cleanup() may try to
    free memory based on uninitialized values.  Fix this by zero'ing
    the per-cpu context for all CPUs before doing any memory
    allocations that might fail.
    
    Signed-off-by: Michael Kelley <mikelley@microsoft.com>
    Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: K. Y. Srinivasan <kys@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9e50bed60686a27c31199f3f9c371c9670b60e6a
Author: Masami Hiramatsu <mhiramat@kernel.org>
Date:   Tue Sep 11 19:21:09 2018 +0900

    kprobes: Don't call BUG_ON() if there is a kprobe in use on free list
    
    [ Upstream commit cbdd96f5586151e48317d90a403941ec23f12660 ]
    
    Instead of calling BUG_ON(), if we find a kprobe in use on free kprobe
    list, just remove it from the list and keep it on kprobe hash list
    as same as other in-use kprobes.
    
    Signed-off-by: Masami Hiramatsu <mhiramat@kernel.org>
    Cc: Anil S Keshavamurthy <anil.s.keshavamurthy@intel.com>
    Cc: David S . Miller <davem@davemloft.net>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Naveen N . Rao <naveen.n.rao@linux.vnet.ibm.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Link: http://lkml.kernel.org/r/153666126882.21306.10738207224288507996.stgit@devbox
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d36d5fbfe15cdc0c553e924dad53f14a6b3de77f
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    [ Upstream commit 72349b62a571effd6faadd0600b8e657dd87afbf ]
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f84f69da3610b57a5f3720f8ca6943761203dfa9
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:03 2018 +0530

    scsi: pm80xx: Corrected dma_unmap_sg() parameter
    
    [ Upstream commit 76cb25b058034d37244be6aca97a2ad52a5fbcad ]
    
    For the function dma_unmap_sg(), the <nents> parameter should be number of
    elements in the scatter list prior to the mapping, not after the mapping.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 12e8d5b469a7e88b4d6ef3386a83e3aebda84376
Author: Oleksij Rempel <linux@rempel-privat.de>
Date:   Thu Aug 2 12:34:21 2018 +0200

    ARM: imx6: register pm_power_off handler if "fsl,pmic-stby-poweroff" is set
    
    [ Upstream commit 8148d2136002da2e2887caf6a07bbd9c033f14f3 ]
    
    One of the Freescale recommended sequences for power off with external
    PMIC is the following:
    ...
    3.  SoC is programming PMIC for power off when standby is asserted.
    4.  In CCM STOP mode, Standby is asserted, PMIC gates SoC supplies.
    
    See:
    http://www.nxp.com/assets/documents/data/en/reference-manuals/IMX6DQRM.pdf
    page 5083
    
    This patch implements step 4. of this sequence.
    
    Signed-off-by: Oleksij Rempel <o.rempel@pengutronix.de>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a125e3ee2d0a88e7a6f0ab374ef19d26a0a2670e
Author: George Kennedy <george.kennedy@oracle.com>
Date:   Wed Aug 29 11:38:16 2018 -0400

    scsi: sym53c8xx: fix NULL pointer dereference panic in sym_int_sir()
    
    [ Upstream commit 288315e95264b6355e26609e9dec5dc4563d4ab0 ]
    
    sym_int_sir() in sym_hipd.c does not check the command pointer for NULL before
    using it in debug message prints.
    
    Suggested-by: Matthew Wilcox <matthew.wilcox@oracle.com>
    Signed-off-by: George Kennedy <george.kennedy@oracle.com>
    Reviewed-by: Mark Kanda <mark.kanda@oracle.com>
    Acked-by: Matthew Wilcox <matthew.wilcox@oracle.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5577a1c86be96bbc57f3a68ac2e39ba6b9179a05
Author: James Smart <jsmart2021@gmail.com>
Date:   Mon Sep 10 10:30:48 2018 -0700

    scsi: lpfc: Fix errors in log messages.
    
    [ Upstream commit 2879265f514b1f4154288243c91438ddbedb3ed4 ]
    
    Message 6408 is displayed for each entry in an array, but the cpu and queue
    numbers were incorrect for the entry.  Message 6001 includes an extraneous
    character.
    
    Resolve both issues
    
    Signed-off-by: Dick Kennedy <dick.kennedy@broadcom.com>
    Signed-off-by: James Smart <james.smart@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9ab019f1ddc4ad8a23fb2bdcbb5674d06cf5f628
Author: Quinn Tran <quinn.tran@cavium.com>
Date:   Tue Sep 11 10:18:16 2018 -0700

    scsi: qla2xxx: Fix dropped srb resource.
    
    [ Upstream commit 527b8ae3948bb59c13ebaa7d657ced56ea25ab05 ]
    
    When FW rejects a command due to "entry_status" error (malform IOCB), the srb
    resource needs to be returned back for cleanup.  The filter to catch this is
    in the wrong location.
    
    Signed-off-by: Quinn Tran <quinn.tran@cavium.com>
    Signed-off-by: Himanshu Madhani <himanshu.madhani@cavium.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 32fd94c6dbf7e634ab91818546e12ea7600e157d
Author: Quinn Tran <quinn.tran@cavium.com>
Date:   Fri Aug 31 11:24:37 2018 -0700

    scsi: qla2xxx: Defer chip reset until target mode is enabled
    
    [ Upstream commit 93eca6135183f7a71e36acd47655a085ed11bcdc ]
    
    For target mode, any chip reset triggered before target mode is enabled will
    be held off until user is ready to enable.  This prevents the chip from
    starting or running before it is intended.
    
    Signed-off-by: Quinn Tran <quinn.tran@cavium.com>
    Signed-off-by: Himanshu Madhani <himanshu.madhani@cavium.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 18d7d335678813347c566f2e0d79ccc2a90b089d
Author: Quinn Tran <quinn.tran@cavium.com>
Date:   Fri Aug 31 11:24:36 2018 -0700

    scsi: qla2xxx: Fix iIDMA error
    
    [ Upstream commit 8d9bf0a9a268f7ca0b811d6e6a1fc783afa5c746 ]
    
    When switch responds with error for Get Port Speed Command (GPSC), driver
    should not proceed with telling FW about the speed of the remote port.
    
    Signed-off-by: Quinn Tran <quinn.tran@cavium.com>
    Signed-off-by: Himanshu Madhani <himanshu.madhani@cavium.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2afdbe702024508ef0286ff3240660c3b7164d47
Author: Chao Yu <chao@kernel.org>
Date:   Wed Sep 5 14:54:02 2018 +0800

    f2fs: fix memory leak of percpu counter in fill_super()
    
    [ Upstream commit 4a70e255449c9a13eed7a6eeecc85a1ea63cef76 ]
    
    In fill_super -> init_percpu_info, we should destroy percpu counter
    in error path, otherwise memory allcoated for percpu counter will
    leak.
    
    Signed-off-by: Chao Yu <yuchao0@huawei.com>
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b7da2be19178ba02912b1a3c7e46b6ab4f050f92
Author: Eric W. Biederman <ebiederm@xmission.com>
Date:   Thu Jul 19 20:48:30 2018 -0500

    signal: Properly deliver SIGSEGV from x86 uprobes
    
    [ Upstream commit 4a63c1ffd384ebdce40aac9c997dab68379137be ]
    
    For userspace to tell the difference between an random signal
    and an exception, the exception must include siginfo information.
    
    Using SEND_SIG_FORCED for SIGSEGV is thus wrong, and it will result in
    userspace seeing si_code == SI_USER (like a random signal) instead of
    si_code == SI_KERNEL or a more specific si_code as all exceptions
    deliver.
    
    Therefore replace force_sig_info(SIGSEGV, SEND_SIG_FORCE, current)
    with force_sig(SIG_SEGV, current) which gets this right and is shorter
    and easier to type.
    
    Fixes: 791eca10107f ("uretprobes/x86: Hijack return address")
    Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b0ae4104dc4a1bd748838c124c8bf11e707add93
Author: Eric W. Biederman <ebiederm@xmission.com>
Date:   Thu Jul 19 20:33:53 2018 -0500

    signal: Properly deliver SIGILL from uprobes
    
    [ Upstream commit 55a3235fc71bf34303e34a95eeee235b2d2a35dd ]
    
    For userspace to tell the difference between a random signal and an
    exception, the exception must include siginfo information.
    
    Using SEND_SIG_FORCED for SIGILL is thus wrong, and it will result
    in userspace seeing si_code == SI_USER (like a random signal) instead
    of si_code == SI_KERNEL or a more specific si_code as all exceptions
    deliver.
    
    Therefore replace force_sig_info(SIGILL, SEND_SIG_FORCE, current)
    with force_sig(SIG_ILL, current) which gets this right and is
    shorter and easier to type.
    
    Fixes: 014940bad8e4 ("uprobes/x86: Send SIGILL if arch_uprobe_post_xol() fails")
    Fixes: 0b5256c7f173 ("uprobes: Send SIGILL if handle_trampoline() fails")
    Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 09357805c5e563a905a1055507855ef66ee2880b
Author: Eric W. Biederman <ebiederm@xmission.com>
Date:   Thu Jul 19 19:47:27 2018 -0500

    signal: Always ignore SIGKILL and SIGSTOP sent to the global init
    
    [ Upstream commit 86989c41b5ea08776c450cb759592532314a4ed6 ]
    
    If the first process started (aka /sbin/init) receives a SIGKILL it
    will panic the system if it is delivered.  Making the system unusable
    and undebugable.  It isn't much better if the first process started
    receives SIGSTOP.
    
    So always ignore SIGSTOP and SIGKILL sent to init.
    
    This is done in a separate clause in sig_task_ignored as force_sig_info
    can clear SIG_UNKILLABLE and this protection should work even then.
    
    Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ee013471266b6fc278eff264ef2979f903a6c502
Author: Michael J. Ruhl <michael.j.ruhl@intel.com>
Date:   Mon Sep 10 09:39:28 2018 -0700

    IB/hfi1: Missing return value in error path for user sdma
    
    [ Upstream commit 2bf4b33f83dfe521c4c7c407b6b150aeec04d69c ]
    
    If the set_txreq_header_agh() function returns an error, the exit path
    is chosen.
    
    In this path, the code fails to set the return value.  This will cause
    the caller to not realize an error has occurred.
    
    Set the return value correctly in the error path.
    
    Signed-off-by: Michael J. Ruhl <michael.j.ruhl@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ff603107d69b7ef88e1460d4bc6328215c9bef8f
Author: Felix Fietkau <nbd@nbd.name>
Date:   Sat Sep 22 18:49:05 2018 +0200

    ath9k: add back support for using active monitor interfaces for tx99
    
    [ Upstream commit 6df0580be8bc30803c4d8b2ed9c2230a2740c795 ]
    
    Various documented examples on how to set up tx99 with ath9k rely
    on setting up a regular monitor interface for setting the channel.
    My previous patch "ath9k: fix tx99 with monitor mode interface" made
    it possible to set it up this way again. However, it was removing support
    for using an active monitor interface, which is required for controlling
    the bitrate as well, since the bitrate is not passed down with a regular
    monitor interface.
    
    This patch partially reverts the previous one, but keeps support for using
    a regular monitor interface to keep documented steps working in cases
    where the bitrate does not matter
    
    Fixes: d9c52fd17cb48 ("ath9k: fix tx99 with monitor mode interface")
    Signed-off-by: Felix Fietkau <nbd@nbd.name>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c07f8f5046a38b4b0d57ecbca18367a1ac129f3c
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Sun Sep 9 22:38:47 2018 +0200

    rtc: pl030: fix possible race condition
    
    [ Upstream commit c778ec85825dc895936940072aea9fe9037db684 ]
    
    The IRQ is requested before the struct rtc is allocated and registered, but
    this struct is used in the IRQ handler. This may lead to a NULL pointer
    dereference.
    
    Switch to devm_rtc_allocate_device/rtc_register_device to allocate the rtc
    before requesting the IRQ.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9a7a5487408d0d0fb4a269085f36f1129f3b8538
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Sun Sep 9 22:38:46 2018 +0200

    rtc: mt6397: fix possible race condition
    
    [ Upstream commit babab2f86440352d24e76118fdd7d40cab5fd7bf ]
    
    The IRQ is requested before the struct rtc is allocated and registered, but
    this struct is used in the IRQ handler. This may lead to a NULL pointer
    dereference.
    
    Switch to devm_rtc_allocate_device/rtc_register_device to allocate the rtc
    before requesting the IRQ.
    
    Acked-by: Eddie Huang <eddie.huang@mediatek.com>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0d533e3681c79ffa1dcbc4c97535b61fda878d37
Author: Qiuxu Zhuo <qiuxu.zhuo@intel.com>
Date:   Fri Sep 7 16:08:27 2018 -0700

    EDAC, sb_edac: Return early on ADDRV bit and address type test
    
    [ Upstream commit dcc960b225ceb2bd66c45e0845d03e577f7010f9 ]
    
    Users of the mce_register_decode_chain() are called for every logged
    error. EDAC drivers should check:
    
    1) Is this a memory error? [bit 7 in status register]
    2) Is there a valid address? [bit 58 in status register]
    3) Is the address a system address? [bitfield 8:6 in misc register]
    
    The sb_edac driver performed test "1" twice. Waited far too long to
    perform check "2". Didn't do check "3" at all.
    
    Fix it by moving the test for valid address from
    sbridge_mce_output_error() into sbridge_mce_check_error() and add a test
    for the type immediately after. Delete the redundant check for the type
    of the error from sbridge_mce_output_error().
    
    Signed-off-by: Qiuxu Zhuo <qiuxu.zhuo@intel.com>
    Cc: Aristeu Rozanski <aris@redhat.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Qiuxu Zhuo <qiuxu.zhuo@intel.com>
    Cc: linux-edac <linux-edac@vger.kernel.org>
    Link: http://lkml.kernel.org/r/20180907230828.13901-2-tony.luck@intel.com
    [ Re-word commit message. ]
    Signed-off-by: Tony Luck <tony.luck@intel.com>
    Signed-off-by: Borislav Petkov <bp@suse.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 61acfcb2478edff351306f679fc50a50b304d401
Author: Daniel Silsby <dansilsby@gmail.com>
Date:   Wed Aug 29 23:32:56 2018 +0200

    dmaengine: dma-jz4780: Further residue status fix
    
    [ Upstream commit 83ef4fb7556b6a673f755da670cbacab7e2c7f1b ]
    
    Func jz4780_dma_desc_residue() expects the index to the next hw
    descriptor as its last parameter. Caller func jz4780_dma_tx_status(),
    however, applied modulus before passing it. When the current hw
    descriptor was last in the list, the index passed became zero.
    
    The resulting excess of reported residue especially caused problems
    with cyclic DMA transfer clients, i.e. ALSA AIC audio output, which
    rely on this for determining current DMA location within buffer.
    
    Combined with the recent and related residue-reporting fixes, spurious
    ALSA audio underruns on jz4770 hardware are now fixed.
    
    Signed-off-by: Daniel Silsby <dansilsby@gmail.com>
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Tested-by: Mathieu Malaterre <malat@debian.org>
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c7befe4de8b3b8695f4724702b823b9768526458
Author: Paul Cercueil <paul@crapouillou.net>
Date:   Wed Aug 29 23:32:48 2018 +0200

    dmaengine: dma-jz4780: Don't depend on MACH_JZ4780
    
    [ Upstream commit c558ecd21c852c97ff98dc6c61f715ba420ec251 ]
    
    If we make this driver depend on MACH_JZ4780, that means it can be
    enabled only if we're building a kernel specially crafted for a
    JZ4780-based board, while most GNU/Linux distributions will want one
    generic MIPS kernel that works on multiple boards.
    
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c184ddb5a7660b1b975d7a1fb461858c978f09ba
Author: Vicente Bergas <vicencb@gmail.com>
Date:   Sat Sep 8 21:00:46 2018 +0200

    arm64: dts: rockchip: Fix VCC5V0_HOST_EN on rk3399-sapphire
    
    [ Upstream commit bcdb578a5f5b4aea79441606ab7f0a2e076b4474 ]
    
    The pin is GPIO4-D1 not GPIO1-D1, see schematic, page 15 for reference.
    
    Signed-off-by: Vicente Bergas <vicencb@gmail.com>
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 70816f4ce8ce34a196d09fe253c4240481f23994
Author: Uwe Kleine-König <u.kleine-koenig@pengutronix.de>
Date:   Wed Sep 5 11:36:36 2018 +0200

    sched/debug: Use symbolic names for task state constants
    
    [ Upstream commit ff28915fd31ccafc0d38e6f84b66df280ed9e86a ]
    
    include/trace/events/sched.h includes <linux/sched.h> (via
    <linux/sched/numa_balancing.h>) and so knows about the TASK_* constants
    used to interpret .prev_state. So instead of duplicating the magic
    numbers make use of the defined macros to ease understanding the
    mapping from state bits to letters which isn't completely intuitive for
    an outsider.
    
    Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: kernel@pengutronix.de
    Link: http://lkml.kernel.org/r/20180905093636.24068-1-u.kleine-koenig@pengutronix.de
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e8651ccbc7910bd8d9359149a104f825a80c836a
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:14 2018 +0200

    ARM: dts: omap3-gta04: keep vpll2 always on
    
    [ Upstream commit 1ae00833e30c9b4af5cbfda65d75b1de12f74013 ]
    
    This is needed to make the display and venc work properly.
    Compare to omap3-beagle.dts.
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a248b125a6d1aa6a881992b78b6e07c1cd742927
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:12 2018 +0200

    ARM: dts: omap3-gta04: make NAND partitions compatible with recent U-Boot
    
    [ Upstream commit fa99c21ecb3cd4021a60d0e8bf880e78b5bd0729 ]
    
    Vendor defined U-Boot has changed the partition scheme a while ago:
    
    * kernel partition 6MB
    * file system partition uses the remainder up to end of the NAND
    * increased size of the environment partition (to get an OneNAND compatible base address)
    * shrink the U-Boot partition
    
    Let's be compatible (e.g. Debian kernel built from upstream).
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 64590cfd49067ebefdf737ef5df0577aad79001e
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:10 2018 +0200

    ARM: dts: omap3-gta04: fix touchscreen tsc2007
    
    [ Upstream commit 7384a24248eda140a234d356b6c840701ee9f055 ]
    
    we fix penirq polarity, add penirq pinmux and touchscreen
    properties.
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 28e09725cb4cbdeb96e1256190c314bf32f32bae
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:09 2018 +0200

    ARM: dts: omap3-gta04: tvout: enable as display1 alias
    
    [ Upstream commit 8905592b6e50cec905e6c6035bbd36201a3bfac1 ]
    
    The omap dss susbystem takes the display aliases to find
    out which displays exist. To enable tv-out we must define
    an alias.
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ec1b4e3862d7323e518a53b4cc36e6828c041951
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:07 2018 +0200

    ARM: dts: omap3-gta04: fixes for tvout / venc
    
    [ Upstream commit f6591391373dbff2c0200e1055d4ff86191578d2 ]
    
    * fix connector compatibility (composite)
    * add comment for gpio1 23
    * add proper #address-cells
    * we use only one venc_out channel for composite
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ef10593a92e11249e6d26e39dccd1a8bf8e06d88
Author: H. Nikolaus Schaller <hns@goldelico.com>
Date:   Tue Jul 31 09:11:06 2018 +0200

    ARM: dts: omap3-gta04: give spi_lcd node a label so that we can overwrite in other DTS files
    
    [ Upstream commit fa0d7dc355c890725b6178dab0cc11b194203afa ]
    
    needed for device variants based on GTA04 board but with
    different display panel (driver).
    
    Signed-off-by: H. Nikolaus Schaller <hns@goldelico.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9032374066b416e1ade7b97b8a8f3c7c304c1faa
Author: Rob Herring <robh@kernel.org>
Date:   Mon Aug 27 09:50:09 2018 -0500

    of: make PowerMac cache node search conditional on CONFIG_PPC_PMAC
    
    [ Upstream commit f6707fd6241e483f6fea2caae82d876e422bb11a ]
    
    Cache nodes under the cpu node(s) is PowerMac specific according to the
    comment above, so make the code enforce that.
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2958d917fadeea14fb1bc54756a3f29f87fbf6f4
Author: Yong Zhi <yong.zhi@intel.com>
Date:   Tue Aug 7 12:19:16 2018 -0500

    ASoC: Intel: hdac_hdmi: Limit sampling rates at dai creation
    
    [ Upstream commit 3b857472f34faa7d11001afa5e158833812c98d7 ]
    
    Playback of 44.1Khz contents with HDMI plugged returns
    "Invalid pipe config" because HDMI paths in the FW
    topology are configured to operate at 48Khz.
    
    This patch filters out sampling rates not supported
    at hdac_hdmi_create_dais() to let user space SRC
    to do the converting.
    
    Signed-off-by: Yong Zhi <yong.zhi@intel.com>
    Reviewed-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 75791ce0521d8eae7cc090b388b2d1bf09e2bdf4
Author: Ding Xiang <dingxiang@cmss.chinamobile.com>
Date:   Thu Sep 6 12:19:19 2018 +0800

    mips: txx9: fix iounmap related issue
    
    [ Upstream commit c6e1241a82e6e74d1ae5cc34581dab2ffd6022d0 ]
    
    if device_register return error, iounmap should be called, also iounmap
    need to call before put_device.
    
    Signed-off-by: Ding Xiang <dingxiang@cmss.chinamobile.com>
    Reviewed-by: Atsushi Nemoto <anemo@mba.ocn.ne.jp>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20476/
    Cc: ralf@linux-mips.org
    Cc: jhogan@kernel.org
    Cc: linux-mips@linux-mips.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 359aab04c01121f4c32ec9cb234f5d417ace6158
Author: Parav Pandit <parav@mellanox.com>
Date:   Thu Sep 6 10:55:31 2018 +0300

    RDMA/core: Follow correct unregister order between sysfs and cgroup
    
    [ Upstream commit c715a39541bb399eb03d728a996b224d90ce1336 ]
    
    During register_device() init sequence is,
    (a) register with rdma cgroup followed by
    (b) register with sysfs
    
    Therefore, unregister_device() sequence should follow the reverse order.
    
    Signed-off-by: Parav Pandit <parav@mellanox.com>
    Reviewed-by: Daniel Jurgens <danielj@mellanox.com>
    Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c0e762da6b0ddaf9437e955faa28712a6f7df283
Author: Parav Pandit <parav@mellanox.com>
Date:   Tue Aug 28 14:45:31 2018 +0300

    RDMA/core: Rate limit MAD error messages
    
    [ Upstream commit f9d08f1e1939ad4d92e38bd3dee6842512f5bee6 ]
    
    While registering a mad agent, a user space can trigger various errors
    and flood the logs.
    
    Therefore, decrease verbosity and rate limit such error messages.
    While we are at it, use __func__ to print function name.
    
    Signed-off-by: Parav Pandit <parav@mellanox.com>
    Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
    Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e30fb85862cd4f4cde55b9212a73297446d652e4
Author: Muhammad Sammar <muhammads@mellanox.com>
Date:   Tue Aug 28 14:45:30 2018 +0300

    IB/ipoib: Ensure that MTU isn't less than minimum permitted
    
    [ Upstream commit 142a9c287613560edf5a03c8d142c8b6ebc1995b ]
    
    It is illegal to change MTU to a value lower than the minimum MTU
    stated in ethernet spec. In addition to that we need to add 4 bytes
    for encapsulation header (IPOIB_ENCAP_LEN).
    
    Before "ifconfig ib0 mtu 0" command, succeeds while it obviously shouldn't.
    
    Signed-off-by: Muhammad Sammar <muhammads@mellanox.com>
    Reviewed-by: Feras Daoud <ferasda@mellanox.com>
    Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1b8331e7dbe2688b59c921a3bf53ec26b5cb2de6
Author: Erik Stromdahl <erik.stromdahl@gmail.com>
Date:   Tue Sep 4 15:07:07 2018 +0300

    ath10k: wmi: disable softirq's while calling ieee80211_rx
    
    [ Upstream commit 37f62c0d5822f631b786b29a1b1069ab714d1a28 ]
    
    This is done in order not to trig the below warning in
    ieee80211_rx_napi:
    
    WARN_ON_ONCE(softirq_count() == 0);
    
    ieee80211_rx_napi requires that softirq's are disabled during
    execution.
    
    The High latency bus drivers (SDIO and USB) sometimes call the wmi
    ep_rx_complete callback from non softirq context, resulting in a trigger
    of the above warning.
    
    Calling ieee80211_rx_ni with softirq's already disabled (e.g., from
    softirq context) should be safe as the local_bh_disable and
    local_bh_enable functions (called from ieee80211_rx_ni) are fully
    reentrant.
    
    Signed-off-by: Erik Stromdahl <erik.stromdahl@gmail.com>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7b72dc2f100d1fe8e969d645050c8ee64b5dd301
Author: Marek Szyprowski <m.szyprowski@samsung.com>
Date:   Thu Sep 6 17:41:35 2018 +0200

    ARM: dts: exynos: Disable pull control for S5M8767 PMIC
    
    [ Upstream commit ef2ecab9af5feae97c47b7f61cdd96f7f49b2c23 ]
    
    S5M8767 PMIC interrupt line on Exynos5250-based Arndale board has
    external pull-up resistors, so disable any pull control for it in
    in controller node. This fixes support for S5M8767 interrupts and
    enables operation of wakeup from S5M8767 RTC alarm.
    
    Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 00843344c6871cde6b8c85bf88bd2197d6eb1da6
Author: Colin Ian King <colin.king@canonical.com>
Date:   Thu Sep 6 11:41:52 2018 +0100

    ASoC: sgtl5000: avoid division by zero if lo_vag is zero
    
    [ Upstream commit 9ab708aef61f5620113269a9d1bdb1543d1207d0 ]
    
    In the case where lo_vag <= SGTL5000_LINE_OUT_GND_BASE, lo_vag
    is set to zero and later vol_quot is computed by dividing by
    lo_vag causing a division by zero error.  Fix this by avoiding
    a zero division and set vol_quot to zero in this specific case
    so that the lowest setting for i is correctly set.
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f3fc7254b0c4a228dc5b52ad14549d1403d804ee
Author: Stefan Wahren <stefan.wahren@i2se.com>
Date:   Tue Sep 4 19:29:09 2018 +0200

    net: lan78xx: Bail out if lan78xx_get_endpoints fails
    
    [ Upstream commit fa8cd98c06407b5798b927cd7fd14d30f360ed02 ]
    
    We need to bail out if lan78xx_get_endpoints() fails, otherwise the
    result is overwritten.
    
    Fixes: 55d7de9de6c3 ("Microchip's LAN7800 family USB 2/3 to 10/100/1000 Ethernet")
    Signed-off-by: Stefan Wahren <stefan.wahren@i2se.com>
    Reviewed-by: Raghuram Chary Jallipalli <raghuramchary.jallipalli@microchip.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 46506366d8848b172f8c98dc826e50545e85ee1a
Author: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
Date:   Sat Jul 21 21:05:53 2018 +0200

    ARM: dts: meson8b: fix the clock controller register size
    
    [ Upstream commit f31094fe8c16fbd2ca47921acf93b744b045aace ]
    
    The clock controller registers are not 0x460 wide because the reset
    controller starts at CBUS 0x4404. This currently overlaps with the
    clock controller (which is at CBUS 0x4000).
    
    There is no public documentation available on the actual size of the
    clock controller's register area (also called "HHI"). However, in
    Amlogic's GPL kernel sources the last "HHI" register is
    HHI_HDMI_PHY_CNTL2 at CBUS + 0x43a8. 0x400 was chosen because that size
    doesn't seem unlikely.
    
    Fixes: 4a69fcd3a10803 ("ARM: meson: Add DTS for Odroid-C1 and Tronfy MXQ boards")
    Signed-off-by: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
    Reviewed-by: Neil Armstrong <narmstrong@baylibre.com>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f245b2c1c7ebd5c725240c8d91e0664e90cd3a58
Author: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
Date:   Sat Jul 21 21:05:52 2018 +0200

    ARM: dts: meson8: fix the clock controller register size
    
    [ Upstream commit f7f9da89bc4f61e33f7b9f5c75c4efdc1f0455d8 ]
    
    The clock controller registers are not 0x460 wide because the reset
    controller starts at CBUS 0x4404. This currently overlaps with the
    clock controller (which is at CBUS 0x4000).
    
    There is no public documentation available on the actual size of the
    clock controller's register area (also called "HHI"). However, in
    Amlogic's GPL kernel sources the last "HHI" register is
    HHI_HDMI_PHY_CNTL2 at CBUS + 0x43a8. 0x400 was chosen because that size
    doesn't seem unlikely.
    
    Fixes: 2c323c43a3d619 ("ARM: dts: meson8: add and use the real clock controller")
    Signed-off-by: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
    Reviewed-by: Neil Armstrong <narmstrong@baylibre.com>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3c53714415f4c6cab9c91091c8290c10aac1327c
Author: Quentin Schulz <quentin.schulz@bootlin.com>
Date:   Mon Sep 3 10:48:50 2018 +0200

    net: phy: mscc: read 'vsc8531, edge-slowdown' as an u32
    
    [ Upstream commit 36c53cf0f46526b898390659b125155939f67892 ]
    
    In the DT binding, it is specified nowhere that 'vsc8531,edge-slowdown'
    is an u8, even though it's read as an u8 in the driver.
    
    Let's update the driver to take into consideration that the
    'vsc8531,edge-slowdown' property is of the default type u32.
    
    Signed-off-by: Quentin Schulz <quentin.schulz@bootlin.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fa1a884a3279c9693f777f4bf578a0791b8b301d
Author: Quentin Schulz <quentin.schulz@bootlin.com>
Date:   Mon Sep 3 10:48:49 2018 +0200

    net: phy: mscc: read 'vsc8531,vddmac' as an u32
    
    [ Upstream commit a993e0f583c7925adaa7721226ccd7a41e7e63d1 ]
    
    In the DT binding, it is specified nowhere that 'vsc8531,vddmac' is an
    u16, even though it's read as an u16 in the driver.
    
    Let's update the driver to take into consideration that the
    'vsc8531,vddmac' property is of the default type u32.
    
    Signed-off-by: Quentin Schulz <quentin.schulz@bootlin.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 994c5661a7f5b71c74d85216f1579bc79f4c2883
Author: Jiada Wang <jiada_wang@mentor.com>
Date:   Mon Sep 3 07:07:07 2018 +0000

    ASoC: rsnd: ssi: Fix issue in dma data address assignment
    
    [ Upstream commit 0e289012b47a2de1f029a6b61c75998e2f159dd9 ]
    
    Same SSI device may be used in different dai links,
    by only having one dma struct in rsnd_ssi, after the first
    instance's dma config be initilized, the following instances
    can no longer configure dma, this causes issue, when their
    dma data address are different from the first instance.
    
    Signed-off-by: Jiada Wang <jiada_wang@mentor.com>
    Signed-off-by: Timo Wischer <twischer@de.adit-jv.com>
    [Kuninori: tidyup for upstream]
    Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
    Tested-by: Hiroyuki Yokoyama <hiroyuki.yokoyama.vx@renesas.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 830a50a3c429ea266758debf02d9d4d39bdd58b4
Author: Sven Schmitt <Sven.Schmitt@mixed-mode.de>
Date:   Tue Jul 24 09:46:03 2018 +0000

    soc: imx: gpc: fix PDN delay
    
    [ Upstream commit 9f4d61d531e0efc9c3283963ae5ef7e314579191 ]
    
    imx6_pm_domain_power_off() reads iso and iso2sw from GPC_PGC_PUPSCR_OFFS
    which stores the power up delays.
    So use GPC_PGC_PDNSCR_OFFS for the correct delays.
    
    Signed-off-by: Sven Schmitt <sven.schmitt@mixed-mode.de>
    Reviewed-by: Leonard Crestez <leonard.crestez@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bbc864a7b8474bd5241d3b10207ccf819b902d19
Author: Larry Finger <Larry.Finger@lwfinger.net>
Date:   Mon Aug 20 13:48:31 2018 -0500

    rtl8187: Fix warning generated when strncpy() destination length matches the sixe argument
    
    [ Upstream commit 199ba9faca909e77ac533449ecd1248123ce89e7 ]
    
    In gcc8, when the 3rd argument (size) of a call to strncpy() matches the
    length of the first argument, the compiler warns of the possibility of an
    unterminated string. Using strlcpy() forces a null at the end.
    
    Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5e6204f442ce4255f8ca9a95cca663ae371ffc22
Author: Marcel Ziswiler <marcel@ziswiler.com>
Date:   Fri Aug 31 14:03:09 2018 +0200

    ARM: dts: pxa: fix power i2c base address
    
    [ Upstream commit 8a1ecc01a473b75ab97be9b36f623e4551a6e9ae ]
    
    There is one too many zeroes in the Power I2C base address. Fix this.
    
    Signed-off-by: Marcel Ziswiler <marcel@ziswiler.com>
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0a9983a8a9c72d404c6e7ea579790af60b834b53
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 25 18:44:01 2018 +0200

    ARM: dts: pxa: fix the rtc controller
    
    [ Upstream commit 24a610eba32a80ed778ea79680b600c3fe73d7de ]
    
    The RTC controller is fed by an external fixed 32kHz clock. Yet the
    driver wants to acquire this clock, even though it doesn't make any use
    of it, ie. doesn't get the rate to make calculation.
    
    Therefore, use the exported 32.768kHz clock in the PXA clock tree to
    make the driver happy and working.
    
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 92d88fa66fb7240480037963e1443120c1bd4b2f
Author: Sara Sharon <sara.sharon@intel.com>
Date:   Tue May 1 15:12:08 2018 +0300

    iwlwifi: mvm: avoid sending too many BARs
    
    [ Upstream commit 1a19c139be18ed4d6d681049cc48586fae070120 ]
    
    When we receive TX response, we may release a few packets
    due to a hole that was closed in the transmission window.
    
    However, if that frame failed, we will mark all the released
    frames as failed and will send multiple BARs.
    
    This affects statistics badly, and cause unnecessary frames
    transmission.
    
    Instead, mark all the following packets as success, with the
    desired result of sending a bar for the failed frame only.
    
    Signed-off-by: Sara Sharon <sara.sharon@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4c337b4ff09fa549415409d8564af9559f9a28f9
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Thu Apr 19 10:57:08 2018 +0200

    iwlwifi: don't WARN on trying to dump dead firmware
    
    [ Upstream commit 84f260251ed8153e84c64eb2c5278ab18d3ddef6 ]
    
    There's no point in warning here, the user will just get an
    error back to the debugfs file write, and warning just makes
    it seem like there's an internal consistency problem when in
    reality the user just happened to hit this at a bad time.
    Remove the warning.
    
    Fixes: f45f979dc208 ("iwlwifi: mvm: disable dbg data collect when fw isn't alive")
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5c3c4654ec1d5747026f8868474842f2e99869d1
Author: Vijay Immanuel <vijayi@attalasystems.com>
Date:   Wed Jun 13 18:48:07 2018 -0700

    IB/rxe: fixes for rdma read retry
    
    [ Upstream commit 030e46e495af855a13964a0aab9753ea82a96edc ]
    
    When a read request is retried for the remaining partial
    data, the response may restart from read response first
    or read response only. So support those cases.
    
    Do not advance the comp psn beyond the current wqe's last_psn
    as that could skip over an entire read wqe and will cause the
    req_retry() logic to set an incorrect req psn.
    An example sequence is as follows:
    Write        PSN 40 -- this is the current WQE.
    Read request PSN 41
    Write        PSN 42
    Receive ACK  PSN 42 -- this will complete the current WQE
    for PSN 40, and set the comp psn to 42 which is a problem
    because the read request at PSN 41 has been skipped over.
    So when req_retry() tries to retransmit the read request,
    it sets the req psn to 42 which is incorrect.
    
    When retrying a read request, calculate the number of psns
    completed based on the dma resid instead of the wqe first_psn.
    The wqe first_psn could have moved if the read request was
    retried multiple times.
    
    Set the reth length to the dma resid to handle read retries for
    the remaining partial data.
    
    Signed-off-by: Vijay Immanuel <vijayi@attalasystems.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e25f56774621a637d2c8264e916ba4d663376e2a
Author: Patryk Małek <patryk.malek@intel.com>
Date:   Tue Aug 28 10:16:09 2018 -0700

    i40e: Prevent deleting MAC address from VF when set by PF
    
    [ Upstream commit 5907cf6c5bbe78be2ed18b875b316c6028b20634 ]
    
    To prevent VF from deleting MAC address that was assigned by the
    PF we need to check for that scenario when we try to delete a MAC
    address from a VF.
    
    Signed-off-by: Patryk Małek <patryk.malek@intel.com>
    Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 546594c2b2018dbcae975bc239b6042648b284af
Author: Patryk Małek <patryk.malek@intel.com>
Date:   Tue Aug 28 10:16:03 2018 -0700

    i40e: hold the rtnl lock on clearing interrupt scheme
    
    [ Upstream commit 5cba17b14182696d6bb0ec83a1d087933f252241 ]
    
    Hold the rtnl lock when we're clearing interrupt scheme
    in i40e_shutdown and in i40e_remove.
    
    Signed-off-by: Patryk Małek <patryk.malek@intel.com>
    Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 85deb3b185dc6006dc699b3476c9d626ff9b9590
Author: Mitch Williams <mitch.a.williams@intel.com>
Date:   Mon Aug 20 08:12:30 2018 -0700

    i40e: use correct length for strncpy
    
    [ Upstream commit 7eb74ff891b4e94b8bac48f648a21e4b94ddee64 ]
    
    Caught by GCC 8. When we provide a length for strncpy, we should not
    include the terminating null. So we must tell it one less than the size
    of the destination buffer.
    
    Signed-off-by: Mitch Williams <mitch.a.williams@intel.com>
    Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4d723872339dea6f540b1fdc4f08d833b7a77de2
Author: Marek Szyprowski <m.szyprowski@samsung.com>
Date:   Fri Aug 10 10:04:25 2018 +0200

    ARM: dts: exynos: Fix regulators configuration on Peach Pi/Pit Chromebooks
    
    [ Upstream commit f8f3b7fc21b1cb59385b780acd9b9a26d04cb7b2 ]
    
    Regulators, which are marked as 'on-in-suspend' seems to be critical for
    board operation, thus they must not be disabled anytime. This can be
    only assured by marking them as 'always-on', because otherwise some
    actions of their clients might result in turning them off. This patch
    restores suspend/resume operation on Peach-Pit Chromebook board. It
    partially reverts 'always-on' property removal done by the commit
    mentioned in the Fixes tag.
    
    Fixes: 665c441eea3d ("ARM: dts: exynos: Remove unneded always-on for regulators on Peach boards")
    Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Tested-by: Tomasz Figa <tfiga@chromium.org>
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c12934798357efe0c786839100b18253afd1c5d4
Author: Rick Farrington <ricardo.farrington@cavium.com>
Date:   Tue Aug 28 11:32:55 2018 -0700

    liquidio: fix race condition in instruction completion processing
    
    [ Upstream commit b943f17e06493fd2c7fd00743093ad5dcdb90e7f ]
    
    In lio_enable_irq, the pkt_in_done count register was being cleared to
    zero.  However, there could be some completed instructions which were not
    yet processed due to budget and limit constraints.
    So, only write this register with the number of actual completions
    that were processed.
    
    Signed-off-by: Rick Farrington <ricardo.farrington@cavium.com>
    Signed-off-by: Felix Manlunas <felix.manlunas@cavium.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b9f822b34e8fa5123727746c91b94cd83604ffac
Author: Marek Szyprowski <m.szyprowski@samsung.com>
Date:   Fri Aug 3 12:55:32 2018 +0200

    ARM: dts: exynos: Fix sound in Snow-rev5 Chromebook
    
    [ Upstream commit 64858773d78e820003a94e5a7179d368213655d6 ]
    
    This patch adds missing properties to the CODEC and sound nodes, so the
    audio will work also on Snow rev5 Chromebook. This patch is an extension
    to the commit e9eefc3f8ce0 ("ARM: dts: exynos: Add missing clock and
    DAI properties to the max98095 node in Snow Chromebook")
    and commit 6ab569936d60 ("ARM: dts: exynos: Enable HDMI audio on Snow
    Chromebook").  It has been reported that such changes work fine on the
    rev5 board too.
    
    Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com>
    [krzk: Fixed typo in phandle to &max98090]
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 983a2c0e4c9dbe9b7b2439186a5e153b0190ff78
Author: Tuomas Tynkkynen <tuomas.tynkkynen@iki.fi>
Date:   Sun Aug 19 22:20:23 2018 +0300

    MIPS: BCM47XX: Enable USB power on Netgear WNDR3400v3
    
    [ Upstream commit feef7918667b84f9d5653c501542dd8d84ae32af ]
    
    Setting GPIO 21 high seems to be required to enable power to USB ports
    on the WNDR3400v3. As there is already similar code for WNR3500L,
    make the existing USB power GPIO code generic and use that.
    
    Signed-off-by: Tuomas Tynkkynen <tuomas.tynkkynen@iki.fi>
    Acked-by: Hauke Mehrtens <hauke@hauke-m.de>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20259/
    Cc: Rafał Miłecki <zajec5@gmail.com>
    Cc: linux-mips@linux-mips.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9670ba2575378fdf820057626d79167182ae1eb8
Author: Paul Cercueil <paul@crapouillou.net>
Date:   Tue Aug 21 18:42:30 2018 +0200

    pinctrl: ingenic: Probe driver at subsys_initcall
    
    [ Upstream commit 556a36a71ed80e17ade49225b58513ea3c9e4558 ]
    
    Using postcore_initcall() makes the driver try to initialize way too
    early.
    
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8cb302840cd44cb344731c8a505f1244fe6253c9
Author: Charles Keepax <ckeepax@opensource.cirrus.com>
Date:   Mon Aug 27 14:26:47 2018 +0100

    ASoC: dpcm: Properly initialise hw->rate_max
    
    [ Upstream commit e33ffbd9cd39da09831ce62c11025d830bf78d9e ]
    
    If the CPU DAI does not initialise rate_max, say if using
    using KNOT or CONTINUOUS, then the rate_max field will be
    initialised to 0. A value of zero in the rate_max field of
    the hardware runtime will cause the sound card to support no
    sample rates at all. Obviously this is not desired, just a
    different mechanism is being used to apply the constraints. As
    such update the setting of rate_max in dpcm_init_runtime_hw
    to be consistent with the non-DPCM cases and set rate_max to
    UINT_MAX if nothing is defined on the CPU DAI.
    
    Signed-off-by: Charles Keepax <ckeepax@opensource.cirrus.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit caf450580cd30f35010d86f1fbde95c84578eee3
Author: Bob Peterson <rpeterso@redhat.com>
Date:   Thu Aug 16 10:32:13 2018 -0500

    gfs2: Don't set GFS2_RDF_UPTODATE when the lvb is updated
    
    [ Upstream commit 4f36cb36c9d14340bb200d2ad9117b03ce992cfe ]
    
    The GFS2_RDF_UPTODATE flag in the rgrp is used to determine when
    a rgrp buffer is valid. It's cleared when the glock is invalidated,
    signifying that the buffer data is now invalid. But before this
    patch, function update_rgrp_lvb was setting the flag when it
    determined it had a valid lvb. But that's an invalid assumption:
    just because you have a valid lvb doesn't mean you have valid
    buffers. After all, another node may have made the lvb valid,
    and this node just fetched it from the glock via dlm.
    
    Consider this scenario:
    1. The file system is mounted with RGRPLVB option.
    2. In gfs2_inplace_reserve it locks the rgrp glock EX, but thanks
       to GL_SKIP, it skips the gfs2_rgrp_bh_get.
    3. Since loops == 0 and the allocation target (ap->target) is
       bigger than the largest known chunk of blocks in the rgrp
       (rs->rs_rbm.rgd->rd_extfail_pt) it skips that rgrp and bypasses
       the call to gfs2_rgrp_bh_get there as well.
    4. update_rgrp_lvb sees the lvb MAGIC number is valid, so bypasses
       gfs2_rgrp_bh_get, but it still sets sets GFS2_RDF_UPTODATE due
       to this invalid assumption.
    5. The next time update_rgrp_lvb is called, it sees the bit is set
       and just returns 0, assuming both the lvb and rgrp are both
       uptodate. But since this is a smaller allocation, or space has
       been freed by another node, thus adjusting the lvb values,
       it decides to use the rgrp for allocations, with invalid rd_free
       due to the fact it was never updated.
    
    This patch changes update_rgrp_lvb so it doesn't set the UPTODATE
    flag anymore. That way, it has no choice but to fetch the latest
    values.
    
    Signed-off-by: Bob Peterson <rpeterso@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e98d5c0716ada43d70727d89bfedbf203cabac44
Author: Sven Eckelmann <sven.eckelmann@openmesh.com>
Date:   Fri Aug 24 15:04:59 2018 +0300

    ath10k: limit available channels via DT ieee80211-freq-limit
    
    [ Upstream commit 34d5629d2ca89d847b7040762b87964c696c14da ]
    
    Tri-band devices (1x 2.4GHz + 2x 5GHz) often incorporate special filters in
    the RX and TX path. These filtered channel can in theory still be used by
    the hardware but the signal strength is reduced so much that it makes no
    sense.
    
    There is already a DT property to limit the available channels but ath10k
    has to manually call this functionality to limit the currrently set wiphy
    channels further.
    
    Signed-off-by: Sven Eckelmann <sven.eckelmann@openmesh.com>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 77a718e992d2ddb7a7dfe3011306b672d342e14d
Author: Felix Fietkau <nbd@nbd.name>
Date:   Mon Aug 20 11:37:51 2018 +0200

    ath9k: fix tx99 with monitor mode interface
    
    [ Upstream commit d9c52fd17cb483bd8a470398afcb79f86c1b77c8 ]
    
    Tx99 is typically configured via a monitor mode interface, which does
    not get added to the driver as a vif. Since the code currently expects
    a configured virtual interface for tx99, enabling tx99 via debugfs fails.
    Since the vif is not needed anyway, remove all checks for it.
    
    Signed-off-by: Felix Fietkau <nbd@nbd.name>
    [kvalo@codeaurora.org: s/CPTCFG/CONFIG/]
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b335136bb7305c81deea6c6cdb47e678d380502b
Author: Takashi Iwai <tiwai@suse.de>
Date:   Tue Aug 28 12:49:43 2018 +0200

    ALSA: seq: Do error checks at creating system ports
    
    [ Upstream commit b8e131542b47b81236ecf6768c923128e1f5db6e ]
    
    snd_seq_system_client_init() doesn't check the errors returned from
    its port creations.  Let's do it properly and handle the error paths.
    
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3ba8f7915e0a3787ef577a635f1f299a18de27d7
Author: Rajeev Kumar Sirasanagandla <rsirasan@codeaurora.org>
Date:   Tue Jul 10 18:46:13 2018 +0530

    cfg80211: Avoid regulatory restore when COUNTRY_IE_IGNORE is set
    
    [ Upstream commit 7417844b63d4b0dc8ab23f88259bf95de7d09b57 ]
    
    When REGULATORY_COUNTRY_IE_IGNORE is set,  __reg_process_hint_country_ie()
    ignores the country code change request from __cfg80211_connect_result()
    via regulatory_hint_country_ie().
    
    After Disconnect, similar to above, country code should not be reset to
    world when country IE ignore is set. But this is violated and restore of
    regulatory settings is invoked by cfg80211_disconnect_work via
    regulatory_hint_disconnect().
    
    To address this, avoid regulatory restore from regulatory_hint_disconnect()
    when COUNTRY_IE_IGNORE is set.
    
    Note: Currently, restore_regulatory_settings() takes care of clearing
    beacon hints. But in the proposed change, regulatory restore is avoided.
    Therefore, explicitly clear beacon hints when DISABLE_BEACON_HINTS
    is not set.
    
    Signed-off-by: Rajeev Kumar Sirasanagandla <rsirasan@codeaurora.org>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 312bf40b1cb7c5d25c16b10fa3db9eae9580dcb2
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Aug 27 18:35:53 2018 +0300

    extcon: cht-wc: Return from default case to avoid warnings
    
    [ Upstream commit 962341b54b99965ebec5f70c8d39f1c382eea833 ]
    
    When we have first case to fall through it's not enough to put
    single comment there to satisfy compiler. Instead of doing that,
    return fall back value directly from default case.
    
    This to avoid following warnings:
    
    drivers/extcon/extcon-intel-cht-wc.c: In function ‘cht_wc_extcon_get_charger’:
    include/linux/device.h:1420:2: warning: this statement may fall through [-Wimplicit-fallthrough=]
      _dev_warn(dev, dev_fmt(fmt), ##__VA_ARGS__)
      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    drivers/extcon/extcon-intel-cht-wc.c:148:3: note: in expansion of macro ‘dev_warn’
       dev_warn(ext->dev,
       ^~~~~~~~
    drivers/extcon/extcon-intel-cht-wc.c:152:2: note: here
      case CHT_WC_USBSRC_TYPE_SDP:
      ^~~~
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a724f780a62b67e188ba97aa034dea5524ea67eb
Author: Bjorn Andersson <bjorn.andersson@linaro.org>
Date:   Thu Aug 16 17:49:19 2018 -0700

    remoteproc/davinci: Use %zx for formating size_t
    
    [ Upstream commit 1e28dbbeced6152b9ea7c417ff8cef3f7dcf0f19 ]
    
    da8xx_rproc_mem size is of type size_t, so use %zx to format the debug
    print of it to avoid a compile warning.
    
    Acked-by: Suman Anna <s-anna@ti.com>
    Reviewed-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 66130c3f3793b9b0e3db7469153ff1160e9f91ac
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Mon Aug 27 23:23:43 2018 +0200

    rtc: rv8803: fix the rv8803 id in the OF table
    
    [ Upstream commit c856618d20662695fcdb47bf4d560dc457662aec ]
    
    The ID for RV8803 must be rv_8803
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 593177c468f27a7e56d90b37beebf3827825ef84
Author: Jay Foster <jayfoster@ieee.org>
Date:   Mon Aug 20 11:42:01 2018 +0200

    ARM: dts: at91/trivial: Fix USART1 definition for at91sam9g45
    
    [ Upstream commit 10af10db8c76fa5b9bf1f52a895c1cb2c0ac24da ]
    
    Fix a typo. No functional change made by this patch.
    
    Signed-off-by: Jay Foster <jayfoster@ieee.org>
    Signed-off-by: Nicolas Ferre <nicolas.ferre@microchip.com>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c7e0e7e51e8c8a6dcb26cb636d160a99c0f0646a
Author: Aapo Vienamo <avienamo@nvidia.com>
Date:   Fri Aug 10 21:08:35 2018 +0300

    arm64: dts: tegra210-p2180: Correct sdmmc4 vqmmc-supply
    
    [ Upstream commit 6ff7705da8806de45ca1490194f0b4eb07725804 ]
    
    On p2180 sdmmc4 is powered from a fixed 1.8 V regulator.
    
    Signed-off-by: Aapo Vienamo <avienamo@nvidia.com>
    Reviewed-by: Mikko Perttunen <mperttunen@nvidia.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c9f373293e684acfcad234744beac67625b99b1b
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Mon Aug 27 12:21:45 2018 +0300

    ALSA: pcm: signedness bug in snd_pcm_plug_alloc()
    
    [ Upstream commit 6f128fa41f310e1f39ebcea9621d2905549ecf52 ]
    
    The "frames" variable is unsigned so the error handling doesn't work
    properly.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 284183a0f4b84da89e9a514146792d7f006daf9c
Author: Andre Przywara <andre.przywara@arm.com>
Date:   Mon Jul 30 13:31:34 2018 +0100

    arm64: dts: allwinner: a64: NanoPi-A64: Fix DCDC1 voltage
    
    [ Upstream commit 480f58cdbe392d4387a2193b6131a277e0111dd0 ]
    
    According to the NanoPi-A64 schematics, DCDC1 is connected to a voltage
    rail named "VDD_SYS_3.3V". All users seem to expect 3.3V here: the
    Ethernet PHY, the uSD card slot, the camera interface and the GPIO pins
    on the headers.
    Fix up the voltage on the regulator to lift it up to 3.3V.
    
    Signed-off-by: Andre Przywara <andre.przywara@arm.com>
    Acked-by: Maxime Ripard <maxime.ripard@bootlin.com>
    Signed-off-by: Chen-Yu Tsai <wens@csie.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c82749aed1ca79766eb692e234ac061df8221806
Author: Andre Przywara <andre.przywara@arm.com>
Date:   Mon Jul 30 13:31:31 2018 +0100

    arm64: dts: allwinner: a64: Olinuxino: fix DRAM voltage
    
    [ Upstream commit 93366b49a35f3a190052734b3f32c8fe2535b53f ]
    
    The Olinuxino board uses DDR3L chips which are supposed to be driven
    with 1.35V. The reset default of the AXP is properly set to 1.36V.
    
    While technically the chips can also run at 1.5 volts, changing the
    voltage on the fly while booting Linux is asking for trouble. Also
    running at a lower voltage saves power.
    
    So fix the DCDC5 value to match the actual board design.
    
    Signed-off-by: Andre Przywara <andre.przywara@arm.com>
    Tested-by: Martin Lucina <martin@lucina.net>
    Acked-by: Maxime Ripard <maxime.ripard@bootlin.com>
    Signed-off-by: Chen-Yu Tsai <wens@csie.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bd0e3c12a07e59e5f5c54130df0e77bc1a468bbb
Author: Marcus Folkesson <marcus.folkesson@gmail.com>
Date:   Fri Aug 24 22:24:40 2018 +0200

    iio: dac: mcp4922: fix error handling in mcp4922_write_raw
    
    [ Upstream commit 0833627fc3f757a0dca11e2a9c46c96335a900ee ]
    
    Do not try to write negative values and make sure that the write goes well.
    
    Signed-off-by: Marcus Folkesson <marcus.folkesson@gmail.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 502e825baa9c738e5bbd3df6f98968bf4d475f67
Author: Tamizh chelvam <tamizhr@codeaurora.org>
Date:   Mon Aug 6 12:39:01 2018 +0300

    ath10k: fix kernel panic by moving pci flush after napi_disable
    
    [ Upstream commit bd1d395070cca4f42a93e520b0597274789274a4 ]
    
    When continuously running wifi up/down sequence, the napi poll
    can be scheduled after the CE buffers being freed by ath10k_pci_flush
    
    Steps:
      In a certain condition, during wifi down below scenario might occur.
    
    ath10k_stop->ath10k_hif_stop->napi_schedule->ath10k_pci_flush->napi_poll(napi_synchronize).
    
    In the above scenario, CE buffer entries will be freed up and become NULL in
    ath10k_pci_flush. And the napi_poll has been invoked after the flush process
    and it will try to get the skb from the CE buffer entry and perform some action on that.
    Since the CE buffer already cleaned by pci flush this action will create NULL
    pointer dereference and trigger below kernel panic.
    
    Unable to handle kernel NULL pointer dereference at virtual address 0000005c
    PC is at ath10k_pci_htt_rx_cb+0x64/0x3ec [ath10k_pci]
    ath10k_pci_htt_rx_cb [ath10k_pci]
    ath10k_ce_per_engine_service+0x74/0xc4 [ath10k_pci]
    ath10k_ce_per_engine_service [ath10k_pci]
    ath10k_ce_per_engine_service_any+0x74/0x80 [ath10k_pci]
    ath10k_ce_per_engine_service_any [ath10k_pci]
    ath10k_pci_napi_poll+0x48/0xec [ath10k_pci]
    ath10k_pci_napi_poll [ath10k_pci]
    net_rx_action+0xac/0x160
    net_rx_action
    __do_softirq+0xdc/0x208
    __do_softirq
    irq_exit+0x84/0xe0
    irq_exit
    __handle_domain_irq+0x80/0xa0
    __handle_domain_irq
    gic_handle_irq+0x38/0x5c
    gic_handle_irq
    __irq_usr+0x44/0x60
    
    Tested on QCA4019 and firmware version 10.4.3.2.1.1-00010
    
    Signed-off-by: Tamizh chelvam <tamizhr@codeaurora.org>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a045fe21f0f4bc0908f6dc21d61eeb660f7bbd26
Author: Ard Biesheuvel <ardb@kernel.org>
Date:   Wed Aug 1 11:48:33 2018 +0200

    tee: optee: take DT status property into account
    
    [ Upstream commit db878f76b9ff7487da9bb0f686153f81829f1230 ]
    
    DT nodes may have a 'status' property which, if set to anything other
    than 'ok' or 'okay', indicates to the OS that the DT node should be
    treated as if it was not present. So add that missing logic to the
    OP-TEE driver.
    
    Signed-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Jens Wiklander <jens.wiklander@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bf95ccce798daaf0a0dbea2927d51894a45b9d7d
Author: Stefan Agner <stefan@agner.ch>
Date:   Sat Aug 11 11:12:19 2018 +0200

    iio: adc: max9611: explicitly cast gain_selectors
    
    [ Upstream commit b1ec0802503820ccbc894aadfd2a44da20232f5e ]
    
    After finding a reasonable gain, the function converts the configured
    gain to a gain configuration option selector enum max9611_csa_gain.
    Make the conversion clearly visible by using an explicit cast. This
    also avoids a warning seen with clang:
      drivers/iio/adc/max9611.c:292:16: warning: implicit conversion from
          enumeration type 'enum max9611_conf_ids' to different enumeration
          type 'enum max9611_csa_gain' [-Wenum-conversion]
                            *csa_gain = gain_selectors[i];
                                      ~ ^~~~~~~~~~~~~~~~~
    
    Signed-off-by: Stefan Agner <stefan@agner.ch>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 181246754d93f97ca4c36d057a0e9fb7f12346c9
Author: Eugen Hristev <eugen.hristev@microchip.com>
Date:   Thu Nov 14 12:59:26 2019 +0000

    mmc: sdhci-of-at91: fix quirk2 overwrite
    
    commit fed23c5829ecab4ddc712d7b0046e59610ca3ba4 upstream.
    
    The quirks2 are parsed and set (e.g. from DT) before the quirk for broken
    HS200 is set in the driver.
    The driver needs to enable just this flag, not rewrite the whole quirk set.
    
    Fixes: 7871aa60ae00 ("mmc: sdhci-of-at91: add quirk for broken HS200")
    Signed-off-by: Eugen Hristev <eugen.hristev@microchip.com>
    Acked-by: Adrian Hunter <adrian.hunter@intel.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8a175e137b84d389d443c37b6133ae893ed97d85
Author: Roman Gushchin <guro@fb.com>
Date:   Fri Nov 15 17:34:46 2019 -0800

    mm: hugetlb: switch to css_tryget() in hugetlb_cgroup_charge_cgroup()
    
    commit 0362f326d86c645b5e96b7dbc3ee515986ed019d upstream.
    
    An exiting task might belong to an offline cgroup.  In this case an
    attempt to grab a cgroup reference from the task can end up with an
    infinite loop in hugetlb_cgroup_charge_cgroup(), because neither the
    cgroup will become online, neither the task will be migrated to a live
    cgroup.
    
    Fix this by switching over to css_tryget().  As css_tryget_online()
    can't guarantee that the cgroup won't go offline, in most cases the
    check doesn't make sense.  In this particular case users of
    hugetlb_cgroup_charge_cgroup() are not affected by this change.
    
    A similar problem is described by commit 18fa84a2db0e ("cgroup: Use
    css_tryget() instead of css_tryget_online() in task_get_css()").
    
    Link: http://lkml.kernel.org/r/20191106225131.3543616-2-guro@fb.com
    Signed-off-by: Roman Gushchin <guro@fb.com>
    Acked-by: Johannes Weiner <hannes@cmpxchg.org>
    Acked-by: Tejun Heo <tj@kernel.org>
    Reviewed-by: Shakeel Butt <shakeelb@google.com>
    Cc: Michal Hocko <mhocko@kernel.org>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a60145d686467bb82fa5f76d8a9c769686ca0482
Author: Roman Gushchin <guro@fb.com>
Date:   Fri Nov 15 17:34:43 2019 -0800

    mm: memcg: switch to css_tryget() in get_mem_cgroup_from_mm()
    
    commit 00d484f354d85845991b40141d40ba9e5eb60faf upstream.
    
    We've encountered a rcu stall in get_mem_cgroup_from_mm():
    
      rcu: INFO: rcu_sched self-detected stall on CPU
      rcu: 33-....: (21000 ticks this GP) idle=6c6/1/0x4000000000000002 softirq=35441/35441 fqs=5017
      (t=21031 jiffies g=324821 q=95837) NMI backtrace for cpu 33
      <...>
      RIP: 0010:get_mem_cgroup_from_mm+0x2f/0x90
      <...>
       __memcg_kmem_charge+0x55/0x140
       __alloc_pages_nodemask+0x267/0x320
       pipe_write+0x1ad/0x400
       new_sync_write+0x127/0x1c0
       __kernel_write+0x4f/0xf0
       dump_emit+0x91/0xc0
       writenote+0xa0/0xc0
       elf_core_dump+0x11af/0x1430
       do_coredump+0xc65/0xee0
       get_signal+0x132/0x7c0
       do_signal+0x36/0x640
       exit_to_usermode_loop+0x61/0xd0
       do_syscall_64+0xd4/0x100
       entry_SYSCALL_64_after_hwframe+0x44/0xa9
    
    The problem is caused by an exiting task which is associated with an
    offline memcg.  We're iterating over and over in the do {} while
    (!css_tryget_online()) loop, but obviously the memcg won't become online
    and the exiting task won't be migrated to a live memcg.
    
    Let's fix it by switching from css_tryget_online() to css_tryget().
    
    As css_tryget_online() cannot guarantee that the memcg won't go offline,
    the check is usually useless, except some rare cases when for example it
    determines if something should be presented to a user.
    
    A similar problem is described by commit 18fa84a2db0e ("cgroup: Use
    css_tryget() instead of css_tryget_online() in task_get_css()").
    
    Johannes:
    
    : The bug aside, it doesn't matter whether the cgroup is online for the
    : callers.  It used to matter when offlining needed to evacuate all charges
    : from the memcg, and so needed to prevent new ones from showing up, but we
    : don't care now.
    
    Link: http://lkml.kernel.org/r/20191106225131.3543616-1-guro@fb.com
    Signed-off-by: Roman Gushchin <guro@fb.com>
    Acked-by: Johannes Weiner <hannes@cmpxchg.org>
    Acked-by: Tejun Heo <tj@kernel.org>
    Reviewed-by: Shakeel Butt <shakeeb@google.com>
    Cc: Michal Hocko <mhocko@kernel.org>
    Cc: Michal Koutn <mkoutny@suse.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 997b62e3f8921b6779d2458f5c69e731b928e5c3
Author: Eric Auger <eric.auger@redhat.com>
Date:   Fri Nov 8 16:58:03 2019 +0100

    iommu/vt-d: Fix QI_DEV_IOTLB_PFSID and QI_DEV_EIOTLB_PFSID macros
    
    commit 4e7120d79edb31e4ee68e6f8421448e4603be1e9 upstream.
    
    For both PASID-based-Device-TLB Invalidate Descriptor and
    Device-TLB Invalidate Descriptor, the Physical Function Source-ID
    value is split according to this layout:
    
    PFSID[3:0] is set at offset 12 and PFSID[15:4] is put at offset 52.
    Fix the part laid out at offset 52.
    
    Fixes: 0f725561e1684 ("iommu/vt-d: Add definitions for PFSID")
    Signed-off-by: Eric Auger <eric.auger@redhat.com>
    Acked-by: Jacob Pan <jacob.jun.pan@linux.intel.com>
    Cc: stable@vger.kernel.org # v4.19+
    Acked-by: Lu Baolu <baolu.lu@linux.intel.com>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d47135249f4d1e8d29e514986a63bf129c64276c
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Sun Nov 3 13:55:43 2019 -0500

    ecryptfs_lookup_interpose(): lower_dentry->d_parent is not stable either
    
    commit 762c69685ff7ad5ad7fee0656671e20a0c9c864d upstream.
    
    We need to get the underlying dentry of parent; sure, absent the races
    it is the parent of underlying dentry, but there's nothing to prevent
    losing a timeslice to preemtion in the middle of evaluation of
    lower_dentry->d_parent->d_inode, having another process move lower_dentry
    around and have its (ex)parent not pinned anymore and freed on memory
    pressure.  Then we regain CPU and try to fetch ->d_inode from memory
    that is freed by that point.
    
    dentry->d_parent *is* stable here - it's an argument of ->lookup() and
    we are guaranteed that it won't be moved anywhere until we feed it
    to d_add/d_splice_alias.  So we safely go that way to get to its
    underlying dentry.
    
    Cc: stable@vger.kernel.org # since 2009 or so
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit dc39d4f7ecbd4176b4e358c8caf9b8f18c8f8e24
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Sun Nov 3 13:45:04 2019 -0500

    ecryptfs_lookup_interpose(): lower_dentry->d_inode is not stable
    
    commit e72b9dd6a5f17d0fb51f16f8685f3004361e83d0 upstream.
    
    lower_dentry can't go from positive to negative (we have it pinned),
    but it *can* go from negative to positive.  So fetching ->d_inode
    into a local variable, doing a blocking allocation, checking that
    now ->d_inode is non-NULL and feeding the value we'd fetched
    earlier to a function that won't accept NULL is not a good idea.
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 958ec1be8f0dc3dadc6ab37160dd644a0a3ce19a
Author: Hans de Goede <hdegoede@redhat.com>
Date:   Wed Nov 13 19:29:38 2019 +0100

    i2c: acpi: Force bus speed to 400KHz if a Silead touchscreen is present
    
    commit 7574c0db2e68c4d0bae9d415a683bdd8b2a761e9 upstream.
    
    Many cheap devices use Silead touchscreen controllers. Testing has shown
    repeatedly that these touchscreen controllers work fine at 400KHz, but for
    unknown reasons do not work properly at 100KHz. This has been seen on
    both ARM and x86 devices using totally different i2c controllers.
    
    On some devices the ACPI tables list another device at the same I2C-bus
    as only being capable of 100KHz, testing has shown that these other
    devices work fine at 400KHz (as can be expected of any recent I2C hw).
    
    This commit makes i2c_acpi_find_bus_speed() always return 400KHz if a
    Silead touchscreen controller is present, fixing the touchscreen not
    working on devices which ACPI tables' wrongly list another device on the
    same bus as only being capable of 100KHz.
    
    Specifically this fixes the touchscreen on the Jumper EZpad 6 m4 not
    working.
    
    Reported-by: youling 257 <youling257@gmail.com>
    Tested-by: youling 257 <youling257@gmail.com>
    Signed-off-by: Hans de Goede <hdegoede@redhat.com>
    Reviewed-by: Jarkko Nikula <jarkko.nikula@linux.intel.com>
    Acked-by: Mika Westerberg <mika.westerberg@linux.intel.com>
    [wsa: rewording warning a little]
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>
    Cc: stable@kernel.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c46089e301a5d78c4d8fd844eae3c81bb626a60d
Author: James Erwin <james.erwin@intel.com>
Date:   Fri Nov 1 15:20:59 2019 -0400

    IB/hfi1: Ensure full Gen3 speed in a Gen4 system
    
    commit a9c3c4c597704b3a1a2b9bef990e7d8a881f6533 upstream.
    
    If an hfi1 card is inserted in a Gen4 systems, the driver will avoid the
    gen3 speed bump and the card will operate at half speed.
    
    This is because the driver avoids the gen3 speed bump when the parent bus
    speed isn't identical to gen3, 8.0GT/s.  This is not compatible with gen4
    and newer speeds.
    
    Fix by relaxing the test to explicitly look for the lower capability
    speeds which inherently allows for gen4 and all future speeds.
    
    Fixes: 7724105686e7 ("IB/hfi1: add driver files")
    Link: https://lore.kernel.org/r/20191101192059.106248.1699.stgit@awfm-01.aw.intel.com
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Reviewed-by: Kaike Wan <kaike.wan@intel.com>
    Signed-off-by: James Erwin <james.erwin@intel.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ae833ad83ff4c9b2713c5f7184595c1d0183ff23
Author: Chuhong Yuan <hslester96@gmail.com>
Date:   Fri Nov 15 11:32:36 2019 -0800

    Input: synaptics-rmi4 - destroy F54 poller workqueue when removing
    
    commit ba60cf9f78f0d7c8e73c7390608f7f818ee68aa0 upstream.
    
    The driver forgets to destroy workqueue in remove() similarly to what is
    done when probe() fails. Add a call to destroy_workqueue() to fix it.
    
    Since unregistration will wait for the work to finish, we do not need to
    cancel/flush the work instance in remove().
    
    Signed-off-by: Chuhong Yuan <hslester96@gmail.com>
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191114023405.31477-1-hslester96@gmail.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 17cb370744e64257dcc5f6d1ee7a279a39b0460e
Author: Lucas Stach <l.stach@pengutronix.de>
Date:   Tue Nov 12 16:47:08 2019 -0800

    Input: synaptics-rmi4 - clear IRQ enables for F54
    
    commit 549766ac2ac1f6c8bb85906bbcea759541bb19a2 upstream.
    
    The driver for F54 just polls the status and doesn't even have a IRQ
    handler registered. Make sure to disable all F54 IRQs, so we don't crash
    the kernel on a nonexistent handler.
    
    Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
    Link: https://lore.kernel.org/r/20191105114402.6009-1-l.stach@pengutronix.de
    Cc: stable@vger.kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 972748923d25ba923399ecfa711758fbb20af4fe
Author: Andrew Duggan <aduggan@synaptics.com>
Date:   Mon Nov 4 16:07:30 2019 -0800

    Input: synaptics-rmi4 - do not consume more data than we have (F11, F12)
    
    commit 5d40d95e7e64756cc30606c2ba169271704d47cb upstream.
    
    Currently, rmi_f11_attention() and rmi_f12_attention() functions update
    the attn_data data pointer and size based on the size of the expected
    size of the attention data. However, if the actual valid data in the
    attn buffer is less then the expected value then the updated data
    pointer will point to memory beyond the end of the attn buffer. Using
    the calculated valid_bytes instead will prevent this from happening.
    
    Signed-off-by: Andrew Duggan <aduggan@synaptics.com>
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191025002527.3189-3-aduggan@synaptics.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fb427af8abb63f09d50d390e18fca25711969e52
Author: Andrew Duggan <aduggan@synaptics.com>
Date:   Mon Nov 4 16:06:44 2019 -0800

    Input: synaptics-rmi4 - disable the relative position IRQ in the F12 driver
    
    commit f6aabe1ff1d9d7bad0879253011216438bdb2530 upstream.
    
    This patch fixes an issue seen on HID touchpads which report finger
    positions using RMI4 Function 12. The issue manifests itself as
    spurious button presses as described in:
    https://www.spinics.net/lists/linux-input/msg58618.html
    
    Commit 24d28e4f1271 ("Input: synaptics-rmi4 - convert irq distribution
    to irq_domain") switched the RMI4 driver to using an irq_domain to handle
    RMI4 function interrupts. Functions with more then one interrupt now have
    each interrupt mapped to their own IRQ and IRQ handler. The result of
    this change is that the F12 IRQ handler was now getting called twice. Once
    for the absolute data interrupt and once for the relative data interrupt.
    For HID devices, calling rmi_f12_attention() a second time causes the
    attn_data data pointer and size to be set incorrectly. When the touchpad
    button is pressed, F30 will generate an interrupt and attempt to read the
    F30 data from the invalid attn_data data pointer and report incorrect
    button events.
    
    This patch disables the F12 relative interrupt which prevents
    rmi_f12_attention() from being called twice.
    
    Signed-off-by: Andrew Duggan <aduggan@synaptics.com>
    Reported-by: Simon Wood <simon@mungewell.org>
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191025002527.3189-2-aduggan@synaptics.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f74f050cfc30876d1a70021a959d561863b2248f
Author: Lucas Stach <l.stach@pengutronix.de>
Date:   Mon Nov 4 15:58:34 2019 -0800

    Input: synaptics-rmi4 - fix video buffer size
    
    commit 003f01c780020daa9a06dea1db495b553a868c29 upstream.
    
    The video buffer used by the queue is a vb2_v4l2_buffer, not a plain
    vb2_buffer. Using the wrong type causes the allocation of the buffer
    storage to be too small, causing a out of bounds write when
    __init_vb2_v4l2_buffer initializes the buffer.
    
    Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
    Fixes: 3a762dbd5347 ("[media] Input: synaptics-rmi4 - add support for F54 diagnostics")
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191104114454.10500-1-l.stach@pengutronix.de
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5edab14154213a4b6bcc527f60adb6124034a0be
Author: Oliver Neukum <oneukum@suse.com>
Date:   Fri Nov 15 11:35:05 2019 -0800

    Input: ff-memless - kill timer in destroy()
    
    commit fa3a5a1880c91bb92594ad42dfe9eedad7996b86 upstream.
    
    No timer must be left running when the device goes away.
    
    Signed-off-by: Oliver Neukum <oneukum@suse.com>
    Reported-and-tested-by: syzbot+b6c55daa701fc389e286@syzkaller.appspotmail.com
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/1573726121.17351.3.camel@suse.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a7a3b07ecaad0acbf56d0da67ae2bd0394657c0f
Author: Henry Lin <henryl@nvidia.com>
Date:   Wed Nov 13 10:14:19 2019 +0800

    ALSA: usb-audio: not submit urb for stopped endpoint
    
    commit 528699317dd6dc722dccc11b68800cf945109390 upstream.
    
    While output urb's snd_complete_urb() is executing, calling
    prepare_outbound_urb() may cause endpoint stopped before
    prepare_outbound_urb() returns and result in next urb submitted
    to stopped endpoint. usb-audio driver cannot re-use it afterwards as
    the urb is still hold by usb stack.
    
    This change checks EP_FLAG_RUNNING flag after prepare_outbound_urb() again
    to let snd_complete_urb() know the endpoint already stopped and does not
    submit next urb. Below kind of error will be fixed:
    
    [  213.153103] usb 1-2: timeout: still 1 active urbs on EP #1
    [  213.164121] usb 1-2: cannot submit urb 0, error -16: unknown error
    
    Signed-off-by: Henry Lin <henryl@nvidia.com>
    Cc: <stable@vger.kernel.org>
    Link: https://lore.kernel.org/r/20191113021420.13377-1-henryl@nvidia.com
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 524c3eacd7bbc92f255c98e1b0a8b824b0ebb5d0
Author: Takashi Iwai <tiwai@suse.de>
Date:   Sat Nov 9 19:16:58 2019 +0100

    ALSA: usb-audio: Fix missing error check at mixer resolution test
    
    commit 167beb1756791e0806365a3f86a0da10d7a327ee upstream.
    
    A check of the return value from get_cur_mix_raw() is missing at the
    resolution test code in get_min_max_with_quirks(), which may leave the
    variable untouched, leading to a random uninitialized value, as
    detected by syzkaller fuzzer.
    
    Add the missing return error check for fixing that.
    
    Reported-and-tested-by: syzbot+abe1ab7afc62c6bb6377@syzkaller.appspotmail.com
    Cc: <stable@vger.kernel.org>
    Link: https://lore.kernel.org/r/20191109181658.30368-1-tiwai@suse.de
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 82ea5a1742e22638db3e3bb812e2e2b1eaf6b661
Author: Jouni Hogander <jouni.hogander@unikie.com>
Date:   Wed Nov 13 13:45:02 2019 +0200

    slip: Fix memory leak in slip_open error path
    
    [ Upstream commit 3b5a39979dafea9d0cd69c7ae06088f7a84cdafa ]
    
    Driver/net/can/slcan.c is derived from slip.c. Memory leak was detected
    by Syzkaller in slcan. Same issue exists in slip.c and this patch is
    addressing the leak in slip.c.
    
    Here is the slcan memory leak trace reported by Syzkaller:
    
    BUG: memory leak unreferenced object 0xffff888067f65500 (size 4096):
      comm "syz-executor043", pid 454, jiffies 4294759719 (age 11.930s)
      hex dump (first 32 bytes):
        73 6c 63 61 6e 30 00 00 00 00 00 00 00 00 00 00 slcan0..........
        00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
      backtrace:
        [<00000000a06eec0d>] __kmalloc+0x18b/0x2c0
        [<0000000083306e66>] kvmalloc_node+0x3a/0xc0
        [<000000006ac27f87>] alloc_netdev_mqs+0x17a/0x1080
        [<0000000061a996c9>] slcan_open+0x3ae/0x9a0
        [<000000001226f0f9>] tty_ldisc_open.isra.1+0x76/0xc0
        [<0000000019289631>] tty_set_ldisc+0x28c/0x5f0
        [<000000004de5a617>] tty_ioctl+0x48d/0x1590
        [<00000000daef496f>] do_vfs_ioctl+0x1c7/0x1510
        [<0000000059068dbc>] ksys_ioctl+0x99/0xb0
        [<000000009a6eb334>] __x64_sys_ioctl+0x78/0xb0
        [<0000000053d0332e>] do_syscall_64+0x16f/0x580
        [<0000000021b83b99>] entry_SYSCALL_64_after_hwframe+0x44/0xa9
        [<000000008ea75434>] 0xfffffffffffffff
    
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: Oliver Hartkopp <socketcan@hartkopp.net>
    Cc: Lukas Bulwahn <lukas.bulwahn@gmail.com>
    Signed-off-by: Jouni Hogander <jouni.hogander@unikie.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 021ede687dcccba48a2cae8c98795e9eedc857e1
Author: Aleksander Morgado <aleksander@aleksander.es>
Date:   Wed Nov 13 11:11:10 2019 +0100

    net: usb: qmi_wwan: add support for Foxconn T77W968 LTE modules
    
    [ Upstream commit 802753cb0b141cf5170ab97fe7e79f5ca10d06b0 ]
    
    These are the Foxconn-branded variants of the Dell DW5821e modules,
    same USB layout as those.
    
    The QMI interface is exposed in USB configuration #1:
    
    P:  Vendor=0489 ProdID=e0b4 Rev=03.18
    S:  Manufacturer=FII
    S:  Product=T77W968 LTE
    S:  SerialNumber=0123456789ABCDEF
    C:  #Ifs= 6 Cfg#= 1 Atr=a0 MxPwr=500mA
    I:  If#=0x0 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=ff Prot=ff Driver=qmi_wwan
    I:  If#=0x1 Alt= 0 #EPs= 1 Cls=03(HID  ) Sub=00 Prot=00 Driver=usbhid
    I:  If#=0x2 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=00 Prot=00 Driver=option
    I:  If#=0x3 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=00 Prot=00 Driver=option
    I:  If#=0x4 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=00 Prot=00 Driver=option
    I:  If#=0x5 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option
    
    Signed-off-by: Aleksander Morgado <aleksander@aleksander.es>
    Acked-by: Bjørn Mork <bjorn@mork.no>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 63a44739bc53dbd44529b7e9ca641d88f151c7cb
Author: Oliver Neukum <oneukum@suse.com>
Date:   Thu Nov 14 11:16:01 2019 +0100

    ax88172a: fix information leak on short answers
    
    [ Upstream commit a9a51bd727d141a67b589f375fe69d0e54c4fe22 ]
    
    If a malicious device gives a short MAC it can elicit up to
    5 bytes of leaked memory out of the driver. We need to check for
    ETH_ALEN instead.
    
    Reported-by: syzbot+a8d4acdad35e6bbca308@syzkaller.appspotmail.com
    Signed-off-by: Oliver Neukum <oneukum@suse.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit eda6c45adcf79f6a82a150e9a094f254689ef368
Author: Anju T Sudhakar <anju@linux.vnet.ibm.com>
Date:   Thu Dec 7 22:53:27 2017 +0530

    powerpc/perf: Fix kfree memory allocated for nest pmus
    
    commit 110df8bd3e418b3476cae80babe8add48a8ea523 upstream.
    
    imc_common_cpuhp_mem_free() is the common function for all
    IMC (In-memory Collection counters) domains to unregister cpuhotplug
    callback and free memory. Since kfree of memory allocated for
    nest-imc (per_nest_pmu_arr) is in the common code, all
    domains (core/nest/thread) can do the kfree in the failure case.
    
    This could potentially create a call trace as shown below, where
    core(/thread/nest) imc pmu initialization fails and in the failure
    path imc_common_cpuhp_mem_free() free the memory(per_nest_pmu_arr),
    which is allocated by successfully registered nest units.
    
    The call trace is generated in a scenario where core-imc
    initialization is made to fail and a cpuhotplug is performed in a p9
    system. During cpuhotplug ppc_nest_imc_cpu_offline() tries to access
    per_nest_pmu_arr, which is already freed by core-imc.
    
      NIP [c000000000cb6a94] mutex_lock+0x34/0x90
      LR [c000000000cb6a88] mutex_lock+0x28/0x90
      Call Trace:
        mutex_lock+0x28/0x90 (unreliable)
        perf_pmu_migrate_context+0x90/0x3a0
        ppc_nest_imc_cpu_offline+0x190/0x1f0
        cpuhp_invoke_callback+0x160/0x820
        cpuhp_thread_fun+0x1bc/0x270
        smpboot_thread_fn+0x250/0x290
        kthread+0x1a8/0x1b0
        ret_from_kernel_thread+0x5c/0x74
    
    To address this scenario do the kfree(per_nest_pmu_arr) only in case
    of nest-imc initialization failure, and when there is no other nest
    units registered.
    
    Fixes: 73ce9aec65b1 ("powerpc/perf: Fix IMC_MAX_PMU macro")
    Signed-off-by: Anju T Sudhakar <anju@linux.vnet.ibm.com>
    Reviewed-by: Madhavan Srinivasan <maddy@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Andrew Donnellan <ajd@linux.ibm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 80da94a1c9f2a5002b9090a70d6a77d9c47a5a51
Author: Madhavan Srinivasan <maddy@linux.vnet.ibm.com>
Date:   Wed Nov 22 10:45:39 2017 +0530

    powerpc/perf: Fix IMC_MAX_PMU macro
    
    commit 73ce9aec65b17433e18163d07eb5cb6bf114bd6c upstream.
    
    IMC_MAX_PMU is used for static storage (per_nest_pmu_arr) which holds
    nest pmu information. Current value for the macro is 32 based on
    the initial number of nest pmu units supported by the nest microcode.
    But going forward, microcode could support more nest units. Instead
    of static storage, patch to fix the code to dynamically allocate an
    array based on the number of nest imc units found in the device tree.
    
    Fixes:8f95faaac56c1 ('powerpc/powernv: Detect and create IMC device')
    Signed-off-by: Madhavan Srinivasan <maddy@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Andrew Donnellan <ajd@linux.ibm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 97b858bfe955141edcca59a5824e974f52940fd5
Author: Evan Green <evgreen@chromium.org>
Date:   Thu Nov 14 11:22:59 2019 -0800

    Revert "Input: synaptics-rmi4 - avoid processing unknown IRQs"
    
    This reverts commit 7b9f7a928255a232012be55cb95db30e963b83a7.
    
    That change should have had a fixes tag for
    commit 24d28e4f1271 ("Input: synaptics-rmi4 - convert irq distribution to
    irq_domain"). The conversion to irq_domain introduced the issue being
    fixed by this commit.
    
    In older kernels the bitmap IRQ accounting is done differently, and
    it doesn't suffer from the same issue of calling handle_nested_irq(0).
    Keeping this commit on kernels 4.14 and older causes problems with
    touchpads due to the different semantics of the IRQ bitmasks.
    
    Signed-off-by: Evan Green <evgreen@chromium.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cc7d7e27fb20c7458914ecd265521389782888be
Author: Michael Schmitz <schmitzmic@gmail.com>
Date:   Tue Nov 5 15:49:10 2019 +1300

    scsi: core: Handle drivers which set sg_tablesize to zero
    
    commit 9393c8de628cf0968d81a17cc11841e42191e041 upstream.
    
    In scsi_mq_setup_tags(), cmd_size is calculated based on zero size for the
    scatter-gather list in case the low level driver uses SG_NONE in its host
    template.
    
    cmd_size is passed on to the block layer for calculation of the request
    size, and we've seen NULL pointer dereference errors from the block layer
    in drivers where SG_NONE is used and a mq IO scheduler is active,
    apparently as a consequence of this (see commit 68ab2d76e4be ("scsi:
    cxlflash: Set sg_tablesize to 1 instead of SG_NONE"), and a recent patch by
    Finn Thain converting the three m68k NFR5380 drivers to avoid setting
    SG_NONE).
    
    Try to avoid these errors by accounting for at least one sg list entry when
    calculating cmd_size, regardless of whether the low level driver set a zero
    sg_tablesize.
    
    Tested on 030 m68k with the atari_scsi driver - setting sg_tablesize to
    SG_NONE no longer results in a crash when loading this driver.
    
    CC: Finn Thain <fthain@telegraphics.com.au>
    Link: https://lore.kernel.org/r/1572922150-4358-1-git-send-email-schmitzmic@gmail.com
    Signed-off-by: Michael Schmitz <schmitzmic@gmail.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3ad7824c0d454e7bab6729209128b2892582d76d
Author: Jonas Gorski <jonas.gorski@gmail.com>
Date:   Mon Dec 10 12:40:38 2018 +0100

    MIPS: BCM63XX: fix switch core reset on BCM6368
    
    commit 8a38dacf87180738d42b058334c951eba15d2d47 upstream.
    
    The Ethernet Switch core mask was set to 0, causing the switch core to
    be not reset on BCM6368 on boot. Provide the proper mask so the switch
    core gets reset to a known good state.
    
    Fixes: 799faa626c71 ("MIPS: BCM63XX: add core reset helper")
    Signed-off-by: Jonas Gorski <jonas.gorski@gmail.com>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Cc: linux-mips@vger.kernel.org
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Amit Pundir <amit.pundir@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c155547af70fff9a346bbf428fc14d3beec2d6d3
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Mon Nov 11 15:37:18 2019 -0800

    KVM: x86: introduce is_pae_paging
    
    [ Upstream commit bf03d4f9334728bf7c8ffc7de787df48abd6340e ]
    
    Checking for 32-bit PAE is quite common around code that fiddles with
    the PDPTRs.  Add a function to compress all checks into a single
    invocation.
    
    Moving to the common helper also fixes a subtle bug in kvm_set_cr3()
    where it fails to check is_long_mode() and results in KVM incorrectly
    attempting to load PDPTRs for a 64-bit guest.
    
    Reviewed-by: Sean Christopherson <sean.j.christopherson@intel.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
    [sean: backport to 4.x; handle vmx.c split in 5.x, call out the bugfix]
    Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5afdcc2a0ae40bc6195476504f4e1932544cb441
Author: Junaid Shahid <junaids@google.com>
Date:   Mon Nov 11 15:37:17 2019 -0800

    kvm: mmu: Don't read PDPTEs when paging is not enabled
    
    [ Upstream commit d35b34a9a70edae7ef923f100e51b8b5ae9fe899 ]
    
    kvm should not attempt to read guest PDPTEs when CR0.PG = 0 and
    CR4.PAE = 1.
    
    Signed-off-by: Junaid Shahid <junaids@google.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
    Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>
